(window.ansFrontendRelayWebpackJsonpFunction=window.ansFrontendRelayWebpackJsonpFunction||[]).push([["component-QTextEditor"],{"+c4W":function(e,t,n){var i=n("711d"),o=n("4/ic"),r=n("9ggG"),a=n("9Nap");e.exports=function(e){return r(e)?i(a(e)):o(e)}},"4/ic":function(e,t,n){var i=n("ZWtO");e.exports=function(e){return function(t){return i(t,e)}}},"4sDh":function(e,t,n){var i=n("4uTw"),o=n("03A+"),r=n("Z0cm"),a=n("wJg7"),s=n("shjB"),l=n("9Nap");e.exports=function(e,t,n){for(var c=-1,d=(t=i(t,e)).length,u=!1;++c<d;){var h=l(t[c]);if(!(u=null!=e&&n(e,h)))break;e=e[h]}return u||++c!=d?u:!!(d=null==e?0:e.length)&&s(d)&&a(h,d)&&(r(e)||o(e))}},"4uTw":function(e,t,n){var i=n("Z0cm"),o=n("9ggG"),r=n("GNiM"),a=n("dt0z");e.exports=function(e,t){return i(e)?e:o(e,t)?[e]:r(a(e))}},"711d":function(e,t){e.exports=function(e){return function(t){return null==t?undefined:t[e]}}},"7r18":function(e,t,n){"use strict";n.d(t,"b",(function(){return O})),n.d(t,"c",(function(){return I})),n.d(t,"g",(function(){return M})),n.d(t,"i",(function(){return R})),n.d(t,"j",(function(){return N})),n.d(t,"d",(function(){return L})),n.d(t,"m",(function(){return D})),n.d(t,"l",(function(){return A})),n.d(t,"f",(function(){return K})),n.d(t,"h",(function(){return J})),n.d(t,"e",(function(){return Y})),n.d(t,"k",(function(){return G}));var i=n("J4zp"),o=n.n(i),r=n("pVnL"),a=n.n(r),s=n("QILm"),l=n.n(s),c=n("vOnD"),d=n("bC0J"),u=n("jufJ"),h=n("zLpq"),f=n("/bbo"),p=n("gujl"),m=n("OMLc"),g=n("td6z"),v=n("7v5Q"),b=n("RA+f"),y=n("SKAY"),x=n("nwxp"),S=n("q1tI"),E=n.n(S),C=n("6c1+"),_=n("KHUD"),T=n("nBPW"),k=n("HC+x"),w=n("PyJm");n.d(t,"a",(function(){return w.g}));var O=44,I=E.a.createContext({setTitleId:function(e){},setSubtitleId:function(e){}});I.displayName="ModalA11yContext";var M=E.a.createContext(!1);M.displayName="ModalLegacyContext";var R=function(e){var t=e.isDestructive,n=e.isSplitButton,i=l()(e,["isDestructive","isSplitButton"]);return n?E.a.createElement(C.a,Object.assign({},i,{variant:t?"red_error":"blue",size:"regular",className:"puppeteer_test_modal_submit"})):E.a.createElement(f.a,Object.assign({},i,{variant:t?"red_error":"blue",size:"regular",className:"puppeteer_test_modal_submit"}))},N=function(e){var t=a()({},e);return E.a.createElement(h.a,Object.assign({variant:"gray"},t,{size:"regular",className:"puppeteer_test_modal_cancel"}))},L=function(e){var t=a()({},e);return E.a.createElement(h.a,Object.assign({"aria-label":Object(u.plaintextTranslate)("Dismiss")},t,{icon:E.a.createElement(m.b,{name:"Close"})}))},P=function(e){var t=a()({},e);return E.a.createElement(h.a,Object.assign({"aria-label":Object(u.plaintextTranslate)("Back")},t,{icon:E.a.createElement(m.b,{name:"ChevronLeft"})}))},D=function(e){var t=e.children,n=e.id;return E.a.createElement(b.s,{bold:!0,fontSize:"large",id:n},t)},A=function(e){var t=e.children,n=e.id;return E.a.createElement(b.s,{mt:"tiny",color:"gray",id:n},t)},j=function(e){var t=e.tabs,n=e.borderBottom;return t?E.a.createElement(v.b,{borderBottom:n},t.map((function(e,t){return E.a.createElement(v.a,Object.assign({key:"modaltab-".concat(t),darkTextColor:!0,flexGrow:1,fontSize:"button",py:"medium"},e))}))):null};j.displayName="ModalHeaderTabs";var B=function(e){var t=e.btnProps;return E.a.createElement(E.a.Fragment,null,t.buttonComponent||E.a.createElement(b.e,{mr:"small"},E.a.createElement(N,t)))};B.displayName="SecondaryBtn";var F=function(e){var t=e.primaryButtonProps,n=e.secondaryButtonProps,i=e.isDestructive,o=void 0!==i&&i;return t||n?E.a.createElement(b.j,{alignSelf:"stretch",justifyContent:"flex-end",alignItems:"center"},n&&(Array.isArray(n)?n.slice(0).reverse().map((function(e,t){return E.a.createElement(B,{key:t,btnProps:e})})):E.a.createElement(B,{btnProps:n})),t&&E.a.createElement(R,Object.assign({},t,{isDestructive:o}))):null},U=Object(c["default"])(b.g).withConfig({displayName:"ModalLayout___StyledCssComponent",componentId:"sc-17zoy7v-0"})(["> *:not(:last-child){margin-bottom:","px;}"],(function(e){return e._css})),q=function(e){var t=e.primaryButtonProps,n=e.secondaryButtonProps,i=e.isDestructive,o=void 0!==i&&i;return t||n?E.a.createElement(b.e,{textAlign:"center"},E.a.createElement(U,{_css:Object(d.a)("space.tiny")},t&&E.a.createElement(R,Object.assign({isFullWidth:!0},t,{isDestructive:o})),n&&(Array.isArray(n)?n.map((function(e,t){return E.a.createElement(N,Object.assign({isFullWidth:!0,key:t},e))})):E.a.createElement(N,Object.assign({isFullWidth:!0},n))))):null},H=function(e){var t,n=e.navButton,i=void 0===n?"close":n,r=e.navButtonProps,a=e.primaryButtonProps,s=e.secondaryButtonProps,l=e.titleText,c=e.subtitleText,d=e.header,u=e.headerTabs,h=e.navBarHasPb,f=void 0===h||h,p=e.hasPadding,m=void 0===p||p,g=e.contentIsList,v=void 0!==g&&g,C=e.mobileFullWidthPrimaryButton,_=void 0!==C&&C,w=e.mobileFullWidthAllButtons,O=void 0!==w&&w,M=e.headerExtra,R=e.headerBg,N=e.footerExtra,B=e.footerForceFullWidth,U=void 0!==B&&B,H=e.displayFooterExtraInline,Q=void 0!==H&&H,z=e.scrollListenerRef,V=e.children,W=e.isDestructive,K=void 0!==W&&W,J=e.extraBodyProps,Y=void 0===J?{}:J,G=Object(S.useRef)(null);G=z||G;var X=function(e){return Object.keys(e).every((function(t){return e[t]===undefined||null===e[t]||!1===e[t]}))},Z="none"===i?null:{close:E.a.createElement(L,r),back:E.a.createElement(P,r)}[i],$={primaryButtonProps:Object(x.e)()&&(O||_)?undefined:a,secondaryButtonProps:Object(x.e)()&&O?undefined:s,isDestructive:K},ee={primaryButtonProps:$.primaryButtonProps?undefined:a,secondaryButtonProps:$.secondaryButtonProps?undefined:s,isDestructive:K},te=!X($),ne=!X(ee),ie=d||Z||te&&Object(x.e)()||M||u,oe=N||Object(x.e)()&&ne||!Object(x.e)()&&te,re=Object(S.useState)(!0),ae=o()(re,2),se=ae[0],le=ae[1],ce=Object(S.useState)(Object(y.getUniqueId)()),de=o()(ce,1)[0],ue=E.a.useRef(E.a.useContext(I));Object(S.useEffect)((function(){Object(x.b)()&&(l&&ue.current.setTitleId("modal-title:".concat(de)),c&&ue.current.setSubtitleId("modal-description:".concat(de)))}),[ue,l,c,de]);var he=ie||l||c||M,fe=!d&&!!u,pe={pt:fe?undefined:"small",pb:f&&!fe?"small":undefined,pl:"tiny",pr:"small"};return E.a.createElement(T.a.Provider,{value:{renderAtRoot:!0}},E.a.createElement(b.j,{flexDirection:"column",flex:1,overflow:"hidden"},E.a.createElement(b.q,{bg:he&&R&&(se?R:"white"),boxShadow:!se&&he?"medium":undefined,transition:"box-shadow, background-color"},ie&&E.a.createElement(b.j,Object.assign({},pe,{alignItems:"center",borderBottom:fe}),Z,E.a.createElement(b.e,{flexGrow:1},d||u&&E.a.createElement(j,{tabs:u})),E.a.createElement(F,Object(x.e)()&&$)),(l||c||M)&&E.a.createElement(b.e,{px:"medium",pt:null!==(t=ie?Object(x.e)()?"small":null:"large")&&void 0!==t?t:undefined,pb:"small"},l&&E.a.createElement(D,{id:"modal-title:".concat(de)},l),c&&E.a.createElement(A,{id:"modal-description:".concat(de)},c),M),!fe&&u&&E.a.createElement(j,{borderBottom:!0,tabs:u}),he&&E.a.createElement(b.a,{bottom:0,fullX:!0,borderBottom:!0,opacity:!se||v?1:0,zIndex:1,transition:"opacity"})),E.a.createElement(b.j,{flexDirection:"column",flex:1,maxWidth:"100%",overflowY:"auto"},E.a.createElement(k.a,Object.assign({flex:1,innerRef:G,minHeight:0,onAtTopChange:function(e){le(e)},wrapperProps:{px:m&&"medium",pt:m&&(Object(x.e)()?"medium":"small"),pb:m&&(Object(x.e)()?"large":"medium")}},Y),V),oe&&E.a.createElement(b.r,{bg:"white",bottom:0,borderTop:!0},Object(x.e)()&&(ne||U)?E.a.createElement(b.e,{px:"large",py:"small"},E.a.createElement(q,ee),N):E.a.createElement(b.j,{flexDirection:Q?"row":"column",alignItems:"center",px:Object(x.e)()?"small":"medium",py:"small"},N,E.a.createElement(F,!Object(x.e)()&&$)))),Object(x.e)()&&E.a.createElement(b.e,{pb:"env(safe-area-inset-bottom)"})))},Q=function(e){var t=e.titleText,n=e.navButton,i=e.primaryButtonProps,o=e.navButtonOnClick;return E.a.createElement(b.i,{display:"flex",top:0,fullX:!0,bg:"red",color:"white",height:O,alignItems:"center"},n&&E.a.createElement(b.j,{onClick:o,as:"a",href:"#",px:"small",alignItems:"center",height:"100%"},E.a.cloneElement(n,{color:"white"})),E.a.createElement(b.s,{medium:!0,px:"small",fontSize:16,opacity:.85,width:"100%",truncateLines:1},t),i&&E.a.createElement(b.f,{display:"inline-flex",alignItems:"center",p:[null],px:"medium",ml:"auto",onClick:i.onClick,disabled:i.disabled,height:"100%",color:"white",whiteSpace:"nowrap",className:"puppeteer_test_modal_primary_button"},i.text))},z=function(e){var t=e.titleText,n=e.navButton,i=e.primaryButtonProps,o=e.navButtonOnClick;return E.a.createElement(b.i,{top:0,fullX:!0,height:O},E.a.createElement(b.j,{height:"100%",alignItems:"stretch",borderBottom:!0},E.a.createElement(b.e,{size:O},o&&n&&E.a.createElement(b.f,{onClick:o,display:"inline-flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%"},E.a.cloneElement(n,{color:"red"}))),E.a.createElement(b.s,{medium:!0,truncateLines:1,lineHeight:O+"px",color:"gray_light",flex:1,textAlign:"center",fontSize:17,maxWidth:"calc(100vw - 88px)"},t),i&&E.a.createElement(b.f,{display:"inline-flex",alignItems:"center",px:"medium",p:[null],ml:"auto",m:[null],height:"100%",disabled:i.disabled,color:"red",whiteSpace:"nowrap",onClick:i.onClick},E.a.createElement(b.e,null,i.text))))};z.displayName="LegacyNativeAppModalHeader";var V=function(e){var t=e.titleText,n=e.primaryButtonProps,i=e.navButton,r=void 0===i?"close":i,a=e.navButtonProps,s=e.scrollListenerRef,l=e.children,c=e.hasPadding,d=void 0===c||c,u=e.footerExtra,h="none"===r?undefined:{close:E.a.createElement(m.b,{name:"Close"}),back:E.a.createElement(m.b,{name:"ChevronLeft"})}[r],f=E.a.useState(undefined),p=o()(f,2),g=p[0],v=p[1];return E.a.createElement(b.j,{pt:Object(x.e)()?O:0,bg:"white",flexDirection:"column",height:"100%"},Object(x.f)()&&E.a.createElement(Q,{navButton:h,navButtonOnClick:(null===a||void 0===a?void 0:a.onClick)||function(){},titleText:t,primaryButtonProps:n}),Object(x.g)()&&E.a.createElement(z,{navButton:h,navButtonOnClick:(null===a||void 0===a?void 0:a.onClick)||function(){},titleText:t,primaryButtonProps:n}),E.a.createElement(b.j,{flex:"auto",flexDirection:"column",px:d?"large":undefined,py:d?"medium":undefined,overflowY:"auto",innerRef:s,pb:g},l,u?E.a.createElement(_.a,{fullX:!0,bottom:0,zIndex:1,onHeightMeasure:function(e){v(e)}},u):null))},W=function(e){var t=e.children,n=e.titleText,i=e.hasPadding,o=void 0===i||i,r=e.secondaryButtonProps,a=e.primaryButtonProps,s=e.navButton,l=void 0===s?"close":s,c=e.navButtonProps,d=void 0===c?{}:c,u=e.scrollListenerRef,p=e.footerExtra;return E.a.createElement(b.j,{flexDirection:"column",flex:1,overflow:"hidden"},(n||"none"!==l)&&E.a.createElement(b.q,{bg:"gray_ultralight",borderBottom:!0,p:"medium",borderTopLeftRadius:"4px",borderTopRightRadius:"4px"},n&&E.a.createElement(b.s,{bold:!0,fontSize:19},n),"none"!==l&&E.a.createElement(b.a,{right:"tiny",top:"tiny"},E.a.createElement(h.a,Object.assign({icon:E.a.createElement(m.b,{name:"SmallClose"})},d)))),E.a.createElement(b.e,{p:o?"medium":undefined,flex:1,overflowY:"auto",innerRef:u},t),E.a.createElement(b.j,{p:10,bg:"gray_ultralight",borderTop:!0,borderBottomLeftRadius:"4px",borderBottomRightRadius:"4px"},p,E.a.createElement(b.j,{ml:"auto",alignItems:"center"},r&&E.a.createElement(b.e,{mr:"small",className:"puppeteer_test_modal_cancel"},E.a.createElement(h.a,r)),a&&E.a.createElement(b.e,{className:"puppeteer_test_modal_primary_button"},E.a.createElement(f.a,a)))))},K=function(e){var t=e.children,n=e.titleText,i=e.primaryButtonProps,o=l()(e,["children","titleText","primaryButtonProps"]);return E.a.createElement(M.Consumer,null,(function(e){return e?Object(x.e)()?E.a.createElement(V,Object.assign({titleText:n,primaryButtonProps:i},o),t):E.a.createElement(W,Object.assign({titleText:n,primaryButtonProps:i},o),t):E.a.createElement(H,Object.assign({titleText:n,primaryButtonProps:i},o),t)}))},J=function(){return E.a.createElement(b.a,{display:"flex",full:!0,alignItems:"center",justifyContent:"center",bg:"white_transparent"},E.a.createElement(g.c,null))},Y=function(e,t){return E.a.createElement(b.e,{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",position:"relative"},E.a.createElement(p.a,{type:"error",size:"small",bg:"white",body:Object(u.plaintextTranslate)("Something went wrong. Check your internet connection."),iconName:"NoConnection",buttonComponent:E.a.createElement(f.a,{variant:"blue",size:"small",icon:E.a.createElement(m.b,{name:"Refresh"}),text:Object(u.plaintextTranslate)("Retry"),onClick:t})}),E.a.createElement(b.e,{position:"absolute",top:8,left:8},E.a.createElement(h.a,{icon:E.a.createElement(m.b,{name:"Close"}),onClick:function(){return e()},variant:"gray"})))},G=function(e,t){return E.a.createElement(b.e,{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",position:"relative"},E.a.createElement(p.a,{type:"error",size:"small",bg:"white",body:Object(u.plaintextTranslate)("Something went wrong. Wait a moment and try again."),iconName:"Error",buttonComponent:E.a.createElement(f.a,{variant:"blue",size:"small",icon:E.a.createElement(m.b,{name:"Refresh"}),text:Object(u.plaintextTranslate)("Retry"),onClick:t})}),E.a.createElement(b.e,{position:"absolute",top:8,left:8},E.a.createElement(h.a,{icon:E.a.createElement(m.b,{name:"Close"}),onClick:function(){return e()},variant:"gray"})))}},"7v5Q":function(e,t,n){"use strict";n.d(t,"a",(function(){return N})),n.d(t,"b",(function(){return P})),n.d(t,"c",(function(){return D}));var i=n("J4zp"),o=n.n(i),r=n("QILm"),a=n.n(r),s=n("jufJ"),l=n("RIqP"),c=n.n(l),d=n("RA+f"),u=n("q1tI"),h=n.n(u),f=n("tw6F"),p=function(e){var t=e.children,n=e.overflowMenuRenderer,i=e.maxVisibleItems,o=h.a.Children.toArray(t);return o.length<=i?h.a.createElement(h.a.Fragment,null,t):h.a.createElement(h.a.Fragment,null,o.slice(0,i),n(o.slice(i)))},m=n("1fRr");function g(e){return e!==undefined&&null!==e&&!1!==e}var v=function(e){var t=e.children,n=e.overflowMenuRenderer,i=e.containerWidth,r=e.responsive,a=void 0===r||r,s=e.wait,l=void 0===s?100:s,v=t.filter(g),b=Object(u.useState)([]),y=o()(b,2),x=y[0],S=y[1],E=Object(u.useState)(0),C=o()(E,2),_=C[0],T=C[1],k=function(e){var i=x.reduce((function(e,t){return e+t}),0);if(i<e)return v;for(var o=e-_,r=v.length-1,a=i-x[r];a>o;)a-=x[r-=1];return h.a.createElement(p,{maxVisibleItems:r,overflowMenuRenderer:n},t)},w=x.length&&_,O=a?h.a.createElement(m.a,{wait:l},(function(e){var t=e.width;return h.a.createElement(d.e,{overflowX:"hidden",whiteSpace:"nowrap"},k(t))})):k(null!==i&&void 0!==i?i:Infinity);return h.a.createElement(h.a.Fragment,null,w?O:h.a.createElement(d.e,{visibility:"hidden",whiteSpace:"nowrap"},function(){var e=function(e){S((function(t){return[].concat(c()(t),[e])}))};return v.map((function(t,n){return h.a.createElement(f.a,{key:n,onMeasure:e},t)}))}(),h.a.createElement(f.a,{onMeasure:function(e){return T(e)}},n([]))))};v.displayName="AutoOverflowListWrapper";var b=v,y=n("f5aN"),x=n("OMLc"),S=n("4oNN"),E=n("0Vtd"),C=n("nwxp"),_=n("GLuq"),T=n("NldC"),k=n("mF64"),w=n("PGlZ"),O=n("vOnD"),I=n("xGwX"),M=n("GxN1"),R=n("VwdU"),N=function(e){var t=e.text,n=e.iconName,i=e.id,o=e["aria-controls"],r=e.active,a=void 0!==r&&r,s=e.badge,l=void 0!==s&&s,c=e.badgeCount,u=void 0===c?0:c,f=e.onClick,p=void 0===f?function(){}:f,m=e.url,g=e.flexGrow,v=void 0!==g&&g,b=e.fontSize,y=void 0===b?"small":b,S=e.px,C=void 0===S?"small":S,_=e.py,T=void 0===_?"medium":_,k=e.darkTextColor,w=void 0!==k&&k,O=e.className,N=void 0===O?"":O,L=Object(E.n)(),P=L||"red";return h.a.createElement(R.a,{condition:Boolean(m),wrapper:function(e){return h.a.createElement(d.p,{id:i,"aria-controls":o,role:"tab",href:m,underlineHover:!1,flexGrow:v,textAlign:v?"center":"left"},e)},elseWrapper:function(e){return h.a.createElement(d.f,{id:i,role:"tab","aria-controls":o,onClick:p,underlineHover:!1,flexGrow:v,textAlign:v?"center":"left"},e)}},h.a.createElement(d.s,{className:N,flex:1,textAlign:"center",py:T,px:C,position:"relative",color:L||w?"gray_dark":"gray_light",hover:!a&&{cursor:"pointer",bg:"darken",color:!L&&!w&&"gray"}},h.a.createElement(d.q,{display:v?"inline-block":"flex"},h.a.createElement(d.s,{medium:!0,fontSize:y,color:!a||L||w?"inherit":"red"},t),n&&h.a.createElement(d.j,{alignItems:"center"},h.a.createElement(x.b,{ml:"tiny",color:"gray_light",size:12,verticalAlign:"middle",name:n})),(u||l)&&h.a.createElement(d.a,{bottom:"100%",left:"100%",size:0},h.a.createElement(d.a,{centerY:!0,left:0},u?h.a.createElement(I.b,{count:u,frameColor:"auto"}):h.a.createElement(M.b,null)))),h.a.createElement(d.a,{bottom:0,left:3,right:3,height:3,borderTopLeftRadius:3,borderTopRightRadius:3,bg:a?P:"transparent"})))},L=function(e){var t=e.tabs,n=(void 0===t?[]:t).map((function(e){var t=e.props;return{label:t.text,onSelected:t.onClick,isOn:t.active,isCheckable:t.active,badge:t.badge}}));return h.a.createElement(d.m,null,h.a.createElement(S.a,{alignment:"bottom",menuItems:n},(function(e){return h.a.createElement(N,{text:Object(s.plaintextTranslate)("More"),onClick:e,iconName:"ChevronDown",className:"puppeteer_test_more_tab"})})))},P=function(e){var t=e.children,n=e.sticky,i=void 0!==n&&n,r=e.stickyMargin,s=void 0===r?0:r,l=e.stickyBoxShadow,c=void 0!==l&&l,u=e.bg,f=void 0===u?"white":u,p=e.showOverflowMenu,m=void 0!==p&&p,g=e.pl,v=e.borderBottom,x=a()(e,["children","sticky","stickyMargin","stickyBoxShadow","bg","showOverflowMenu","pl","borderBottom"]),S=Object(w.c)({threshold:0,rootMargin:"-".concat(s,"px")}),E=o()(S,2),_=E[0],k=!E[1],I=h.a.useContext(O.ThemeContext).zIndices.header-1,M=i&&k;return h.a.createElement(h.a.Fragment,null,h.a.createElement(d.e,{innerRef:_}),h.a.createElement(d.e,Object.assign({borderBottom:v,pl:g},x,{position:M?"sticky":undefined,top:M?s-1:undefined,zIndex:M?I:undefined,bg:M?"raised":f,boxShadow:M&&c?"small":undefined}),h.a.createElement(R.a,{condition:m,wrapper:function(e){return h.a.createElement(b,{overflowMenuRenderer:function(e){return h.a.createElement(L,{key:"overflow",tabs:e.filter(T.c)})}},e)},elseWrapper:function(e){return h.a.createElement(y.c,{noWrap:!0,fullWidth:!0,hideScrollBar:Object(C.e)()},e)}},t)))};function D(e){var t=e.children,n=e.initialTabName,i=e.syncUrlWithTab,r=void 0!==i&&i,a=e.urlBase,s=Object(u.useState)(n),l=o()(s,2),c=l[0],d=l[1];return t({activeTabName:c,switchTab:function(e){var t=e.tabName,n=e.tabUrlSuffix,i=void 0===n?t:n;if(r)if(a){var o=Object(_.f)(a);o.path=i,Object(k.k)(String(o))}else Object(k.k)(i);d(t)}})}},"9Nap":function(e,t,n){var i=n("/9aa");e.exports=function(e){if("string"==typeof e||i(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}},"9dNZ":function(e,t,n){"use strict";n.d(t,"c",(function(){return G})),n.d(t,"b",(function(){return Z}));var i={};n.r(i),n.d(i,"default",(function(){return x}));var o={};n.r(o),n.d(o,"default",(function(){return F}));var r=n("o0o1"),a=n.n(r),s=n("lwsE"),l=n.n(s),c=n("W8MJ"),d=n.n(c),u=n("7W2i"),h=n.n(u),f=n("a1gu"),p=n.n(f),m=n("Nsbk"),g=n.n(m),v=n("yXPU"),b=n.n(v),y=function(){var e=[{kind:"LocalArgument",name:"query",type:"String!",defaultValue:null},{kind:"LocalArgument",name:"contextOid",type:"BigInt",defaultValue:null},{kind:"LocalArgument",name:"contextType",type:"ContentTypes",defaultValue:null}],t=[{kind:"Variable",name:"contextOid",variableName:"contextOid"},{kind:"Variable",name:"contextType",variableName:"contextType"},{kind:"Literal",name:"limit",value:10},{kind:"Variable",name:"query",variableName:"query"},{kind:"Literal",name:"querySource",value:"selector_misc"},{kind:"Literal",name:"queryType",value:"ts_lookup_bar_general"}],n={kind:"ScalarField",alias:null,name:"id",args:null,storageKey:null},i={kind:"ScalarField",alias:null,name:"__typename",args:null,storageKey:null},o={kind:"ScalarField",alias:null,name:"uid",args:null,storageKey:null},r={kind:"ScalarField",alias:null,name:"profileUrl",args:null,storageKey:null},a={kind:"ScalarField",alias:null,name:"url",args:null,storageKey:null},s={kind:"ScalarField",alias:null,name:"tribeId",args:null,storageKey:null},l={kind:"ScalarField",alias:null,name:"tid",args:null,storageKey:null},c=[i,n,{kind:"ScalarField",alias:null,name:"reverseOrder",args:null,storageKey:null},{kind:"ScalarField",alias:null,name:"givenName",args:null,storageKey:null},{kind:"ScalarField",alias:null,name:"familyName",args:null,storageKey:null},{kind:"ScalarField",alias:null,name:"scriptCode",args:null,storageKey:null}],d=[{kind:"Literal",name:"size",value:100}],u={kind:"ScalarField",alias:null,name:"name",args:null,storageKey:null};return{kind:"Request",fragment:{kind:"Fragment",name:"QTextLinkSelectorQuery",type:"QueryRoot",metadata:null,argumentDefinitions:e,selections:[{kind:"LinkedField",alias:null,name:"searchQuery",storageKey:null,args:t,concreteType:null,plural:!0,selections:[n,i,{kind:"FragmentSpread",name:"QTextLinkSelectorResult_searchQuery",args:null},{kind:"InlineFragment",type:"UserSearchResult",selections:[{kind:"LinkedField",alias:null,name:"user",storageKey:null,args:null,concreteType:"User",plural:!1,selections:[n,i,o,r,{kind:"FragmentSpread",name:"UserName_user",args:null}]}]},{kind:"InlineFragment",type:"TribeSearchResult",selections:[{kind:"LinkedField",alias:null,name:"tribe",storageKey:null,args:null,concreteType:"Tribe",plural:!1,selections:[n,i,a,s,{kind:"FragmentSpread",name:"TribeName_tribe",args:null}]}]},{kind:"InlineFragment",type:"TopicSearchResult",selections:[{kind:"LinkedField",alias:null,name:"topic",storageKey:null,args:null,concreteType:"Topic",plural:!1,selections:[n,i,a,l,{kind:"FragmentSpread",name:"TopicName_topic",args:null}]}]}]}]},operation:{kind:"Operation",name:"QTextLinkSelectorQuery",argumentDefinitions:e,selections:[{kind:"LinkedField",alias:null,name:"searchQuery",storageKey:null,args:t,concreteType:null,plural:!0,selections:[n,i,{kind:"InlineFragment",type:"UserSearchResult",selections:[{kind:"LinkedField",alias:null,name:"user",storageKey:null,args:null,concreteType:"User",plural:!1,selections:[n,i,o,{kind:"ScalarField",alias:null,name:"isAnon",args:null,storageKey:null},{kind:"ScalarField",alias:null,name:"profileImageUrl",args:null,storageKey:null},{kind:"ScalarField",alias:null,name:"isVerified",args:null,storageKey:null},{kind:"ScalarField",alias:null,name:"businessStatus",args:null,storageKey:null},r,{kind:"ScalarField",alias:null,name:"useTranslatedName",args:null,storageKey:null},{kind:"LinkedField",alias:null,name:"names",storageKey:null,args:null,concreteType:"UserName",plural:!0,selections:c},{kind:"LinkedField",alias:null,name:"adminNames",storageKey:null,args:null,concreteType:"UserName",plural:!0,selections:c},{kind:"Condition",passingValue:!0,isCustom:!0,customValue:{name:"ConsumerBundleSubscriptions",value:"true"},condition:"onFeature",selections:[{kind:"ScalarField",alias:null,name:"consumerBundleActive",args:null,storageKey:null}]},{kind:"Condition",passingValue:!0,isCustom:!0,customValue:{name:"annotate_with_ids",value:"true"},condition:"onGate",selections:[{kind:"ScalarField",alias:null,name:"debugInfo",args:null,storageKey:null}]}]}]},{kind:"InlineFragment",type:"TribeSearchResult",selections:[{kind:"LinkedField",alias:null,name:"tribe",storageKey:null,args:null,concreteType:"Tribe",plural:!1,selections:[n,i,s,a,{kind:"ScalarField",alias:null,name:"isSensitive",args:null,storageKey:null},{kind:"ScalarField",alias:null,name:"isFollowing",args:null,storageKey:null},{kind:"ScalarField",alias:null,name:"iconUrl",args:d,storageKey:"iconUrl(size:100)"},{kind:"ScalarField",alias:"iconRetinaUrl",name:"iconUrl",args:[{kind:"Literal",name:"size",value:200}],storageKey:"iconUrl(size:200)"},u,{kind:"ScalarField",alias:null,name:"nameString",args:null,storageKey:null}]}]},{kind:"InlineFragment",type:"TopicSearchResult",selections:[{kind:"LinkedField",alias:null,name:"topic",storageKey:null,args:null,concreteType:"Topic",plural:!1,selections:[n,i,l,a,{kind:"ScalarField",alias:null,name:"photoUrl",args:d,storageKey:"photoUrl(size:100)"},u]}]}]}]},params:{operationKind:"query",name:"QTextLinkSelectorQuery",id:"9bf13a21ebac5cdd1c99588495ea08a6ef6f1c01461589ef589303edabd80181",text:null,metadata:{}}}}();y.hash="5a82d997c4a5aa5b1fa4fbee9b759f9a";var x=y,S=n("jufJ"),E=n("cztr"),C=n("RA+f"),_=n("cecZ"),T=n("PuWf"),k=n("R+um"),w=n("VyO/"),O=n("nwxp"),I=n("mVMq"),M=n("sEfC"),R=n.n(M),N=n("vN+2"),L=n.n(N),P=n("q1tI"),D=n.n(P),A=n("vOnD"),j=function(){var e={kind:"ScalarField",alias:null,name:"id",args:null,storageKey:null},t={kind:"ScalarField",alias:null,name:"__typename",args:null,storageKey:null};return{kind:"Fragment",name:"QTextLinkSelectorResult_searchQuery",type:"SearchResult",metadata:null,argumentDefinitions:[],selections:[e,t,{kind:"InlineFragment",type:"UserSearchResult",selections:[{kind:"LinkedField",alias:null,name:"user",storageKey:null,args:null,concreteType:"User",plural:!1,selections:[e,t,{kind:"FragmentSpread",name:"UserPhoto_user",args:null},{kind:"FragmentSpread",name:"UserName_user",args:null}]}]},{kind:"InlineFragment",type:"TribeSearchResult",selections:[{kind:"LinkedField",alias:null,name:"tribe",storageKey:null,args:null,concreteType:"Tribe",plural:!1,selections:[e,t,{kind:"FragmentSpread",name:"TribeIcon_tribe",args:null},{kind:"FragmentSpread",name:"TribeName_tribe",args:null}]}]},{kind:"InlineFragment",type:"TopicSearchResult",selections:[{kind:"LinkedField",alias:null,name:"topic",storageKey:null,args:null,concreteType:"Topic",plural:!1,selections:[e,t,{kind:"FragmentSpread",name:"TopicPhoto_topic",args:null},{kind:"FragmentSpread",name:"TopicName_topic",args:null}]}]}]}}();j.hash="69f10dcdf277c153c1fa76ce60b7ec04";var B,F=j,U=n("MI6j"),q=n("wl2v"),H=n("n2ec"),Q=n("r+vq");function z(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=g()(e);if(t){var o=g()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return p()(this,n)}}var V=function(e){h()(n,e);var t=z(n);function n(){return l()(this,n),t.apply(this,arguments)}return d()(n,[{key:"render",value:function(){var e=this.props.searchQuery,t=e.user,n=e.topic,i=e.tribe,o={size:"small",borderBottom:!0,alignIcon:"flex-start"};return t?D.a.createElement(U.c,Object.assign({icon:D.a.createElement(Q.a,{linked:!1,user:t,includeHovercard:!1}),mainText:D.a.createElement(k.b,{user:t}),subText:Object(S.plaintextTranslate)("(user)")},o)):n?D.a.createElement(U.c,Object.assign({icon:D.a.createElement(q.a,{link:!1,topic:n}),mainText:D.a.createElement(_.a,{topic:n}),subText:Object(S.plaintextTranslate)("(topic)")},o)):i?D.a.createElement(U.c,Object.assign({icon:D.a.createElement(H.a,{linked:!1,tribe:i,includeHovercard:!1}),mainText:D.a.createElement(T.a,{tribe:i}),subText:Object(S.plaintextTranslate)("(space)")},o)):null}}]),n}(D.a.Component);V.fragments={searchQuery:void 0!==B?B:B=o},V.displayName="QTextLinkSelectorResult";var W,K=Object(w.b)(V);function J(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=g()(e);if(t){var o=g()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return p()(this,n)}}var Y=void 0!==W?W:W=i;function G(e,t){return X.apply(this,arguments)}function X(){return(X=b()(a.a.mark((function e(t,n){var i,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(w.e)({query:Y,variables:{query:null!==t&&void 0!==t?t:"",contextType:null===n||void 0===n?void 0:n.type,contextOid:null===n||void 0===n?void 0:n.oid},fetchPolicy:"store-or-network"});case 2:if(i=e.sent,o=i.data){e.next=6;break}return e.abrupt("return",[]);case 6:return e.abrupt("return",o.searchQuery.map((function(e){var t;return t=e.user?Object(S.plaintextTranslate)(D.a.createElement(k.b,{user:e.user})):e.tribe?Object(S.plaintextTranslate)(D.a.createElement(T.a,{tribe:e.tribe})):e.topic?Object(S.plaintextTranslate)(D.a.createElement(_.a,{topic:e.topic})):Object(S.plaintextUserGeneratedContent)(""),{item:D.a.createElement(K,{searchQuery:e}),title:Object(S.plaintextUserGeneratedContent)(t),data:e}})));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Z=function(e){var t={text:""};if(!e)return t;var n=e.tribe,i=e.topic,o=e.user;return o?{text:Object(S.plaintextTranslate)(D.a.createElement(k.b,{user:o})),target:{type:"user",uid:o.uid,url:o.profileUrl||""}}:n?{text:Object(S.plaintextTranslate)(D.a.createElement(T.a,{tribe:n})),target:{type:"tribe",tribe_id:n.tribeId,url:n.url}}:i?{text:Object(S.plaintextTranslate)(D.a.createElement(_.a,{topic:i})),target:{type:"topic",tid:i.tid,url:i.url}}:t},$=function(e){h()(n,e);var t=J(n);function n(e){var i;return l()(this,n),(i=t.call(this,e)).INPUT_WIDTH=250,i.MENU_HEIGHT=150,i._onSubmitCallback=L.a,i.handleInputChange=function(e){i.setState({input:e})},i.state={active:!1,toolbar:undefined,x:0,y:0,isRtl:!1,docNode:undefined,doc:undefined,input:""},i}return d()(n,[{key:"setEditorToolbar",value:function(e){this.setState({toolbar:e})}},{key:"setDocNode",value:function(e,t){this.setState({docNode:e,doc:t})}},{key:"isActive",value:function(){return this.state.active}},{key:"show",value:function(e){var t=this,n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0,i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0,o=arguments.length>3&&arguments[3]!==undefined&&arguments[3];if(Object(O.e)())this.props.openModal({modalProps:{name:"QTextLinkSelectorModal",extraProps:{contentContext:this.props.contentContext}},containerProps:{easyDismissEnabled:!0},postDismissCallback:function(e){e&&t._onSubmitCallback(e),t.props.onClose&&t.props.onClose()}});else{var r=o?n-this.INPUT_WIDTH:n,a=i-1;this.setState({active:!0,x:r,y:a,isRtl:o})}this.props.onOpen&&this.props.onOpen()}},{key:"hide",value:function(){this.setState({active:!1,key:""}),!Object(O.e)()&&this.props.onClose&&this.props.onClose()}},{key:"cancel",value:function(){this.setState({active:!1})}},{key:"onSubmit",value:function(e){this._onSubmitCallback=R()(e,100,{leading:!0,trailing:!1})}},{key:"onCancel",value:function(e){}},{key:"getExternalURL",value:function(e,t,n){this.state.toolbar&&this.state.toolbar.setupLinkInput(e)}},{key:"getLinkPreview",value:function(e,t,n){Object(I.a)("/qtext/get_link_preview_POST",{json:JSON.stringify({args:[],kwargs:{url:e}})}).then((function(e){return t(e.value)}))["catch"](n)}},{key:"shouldAttachResultsToTop",value:function(){return this.props.renderMenuAtRoot?this.state.y+this.state.docNode.getBoundingClientRect().top+this.MENU_HEIGHT+8>window.innerHeight:this.state.y+this.MENU_HEIGHT+8>this.state.docNode.clientHeight}},{key:"render",value:function(){var e=this,t=this.props,n=t.renderMenuAtRoot,i=t.contentContext;return D.a.createElement(D.a.Fragment,null,this.state.active?D.a.createElement(C.s,{position:"absolute",top:this.state.y,display:"flex",width:this.INPUT_WIDTH,zIndex:"popover",style:{left:this.state.x},color:"blue_dark"},D.a.createElement(C.s,{lineHeight:"inherit"},Object(S.plaintextTranslate)("@")),D.a.createElement(E.a,{async:!0,blurOnEnter:!0,blurOnEscape:!0,selectOnTab:!0,blurOnTab:!0,showMenuOnEmptyLoading:!0,hideUnfilteredMenu:!0,autoSelectFirstResult:!0,options:G(this.state.input,i),inputPlaceholder:Object(S.plaintextTranslate)("Search"),limit:9,onChange:function(t){if(t){var n=Z(t.data);e._onSubmitCallback(n)}},onInputChange:this.handleInputChange,attachResultsToTop:this.shouldAttachResultsToTop(),emptyInputCallback:function(){e.setState({active:!1}),e.state.docNode.qtextContainer.focus()},autoFocus:!0,inputWrapperProps:{compact:!0,variant:"small",styledComponentCss:"\n                  padding: 0;\n                  line-height: inherit;\n                  min-height: 0;\n                  font-size: inherit;\n                  border: none !important;\n                  box-shadow: none !important;\n                  background-color: transparent !important;\n                "},inputProps:{styledComponentCss:"\n                  font-size: inherit;\n                  line-height: inherit;\n                  color: inherit;\n                  min-height: 0 !important;\n                  background-color: ".concat(this.props.theme.colors.bg.white," !important\n                ")},listProps:{bg:"raised"},menuContainerProps:{borderRadius:"small",boxShadow:"medium",minWidth:this.INPUT_WIDTH,maxHeight:this.MENU_HEIGHT},forceMenuContainerProps:!0,filterEmptyOptions:!0,renderMenuAtRoot:n})):null)}}]),n}(D.a.Component);$.queries={selector:Y},$.displayName="QTextLinkSelector";t.a=Object(A.withTheme)($)},"9ggG":function(e,t,n){var i=n("Z0cm"),o=n("/9aa"),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;e.exports=function(e,t){if(i(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!o(e))||(a.test(e)||!r.test(e)||null!=t&&e in Object(t))}},CMye:function(e,t,n){var i=n("GoyQ");e.exports=function(e){return e===e&&!i(e)}},GDhZ:function(e,t,n){var i=n("wF/u"),o=n("mwIZ"),r=n("hgQt"),a=n("9ggG"),s=n("CMye"),l=n("IOzZ"),c=n("9Nap");e.exports=function(e,t){return a(e)&&s(t)?l(c(e),t):function(n){var a=o(n,e);return a===undefined&&a===t?r(n,e):i(t,a,3)}}},GNiM:function(e,t,n){var i=n("I01J"),o=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,r=/\\(\\)?/g,a=i((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(o,(function(e,n,i,o){t.push(i?o.replace(r,"$1"):n||e)})),t}));e.exports=a},"HC+x":function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var i=n("J4zp"),o=n.n(i),r=n("QILm"),a=n.n(r),s=n("vOnD"),l=n("RA+f"),c=n("nwxp"),d=n("q1tI"),u=n.n(d),h=n("4Xda"),f=n("zaBG"),p=Object(s["default"])(l.e).withConfig({displayName:"ScrollBox___StyledBox",componentId:"sc-1t8bc7j-0"})(["-webkit-overflow-scrolling:touch;",""],(function(e){return e._css})),m=Object(s["default"])(l.a).withConfig({displayName:"ScrollBox___StyledAbsolute",componentId:"sc-1t8bc7j-1"})(["background-image:linear-gradient( to bottom,rgba(0,0,0,0.05),rgba(0,0,0,0) );pointer-events:none;"]),g=Object(s["default"])(l.a).withConfig({displayName:"ScrollBox___StyledAbsolute2",componentId:"sc-1t8bc7j-2"})(["background-image:linear-gradient( to top,rgba(0,0,0,0.05),rgba(0,0,0,0) );pointer-events:none;"]),v=function(e){var t=e.children,n=e.innerRef,i=e.onAtTopChange,r=e.lockBodyNative,s=void 0===r||r,v=e.showScrollbarOnHover,b=e.wrapperProps,y=e.useShadows,x=e.shadowOffset,S=void 0===x?0:x,E=a()(e,["children","innerRef","onAtTopChange","lockBodyNative","showScrollbarOnHover","wrapperProps","useShadows","shadowOffset"]),C=u.a.useRef(!1),_=u.a.useRef(window.innerHeight),T=u.a.useRef(document.body.style.overflow||""),k=u.a.useState(!1),w=o()(k,2),O=w[0],I=w[1],M=u.a.useState(!1),R=o()(M,2),N=R[0],L=R[1],P=u.a.useRef(Object(f.e)()),D=u.a.useContext(h.a).isDarkModeOn,A=P.current>0,j=D?"rgba(255, 255, 255, .1)":"rgba(0, 0, 0, .1)",B=u.a.useRef((function(){if(n.current){var e=n.current,t=e.scrollTop,o=e.scrollHeight,r=e.clientHeight,a=Object(c.c)()&&C.current&&s?1:0;Object(c.c)()&&s&&(t===o-r?n.current.scrollTo(0,o-r-a):0===t&&n.current.scrollTo(0,a)),t<=a+S&&(null===i||void 0===i||i(!0)),t>a+S&&(null===i||void 0===i||i(!1))}})),F=u.a.useRef((function(){Object(c.c)()&&s&&setTimeout((function(){var e=Math.abs(_.current-300-window.innerHeight)<=50;C.current=e,B.current()}),200)})),U=u.a.useRef((function(){if(window.requestAnimationFrame(B.current),y){var e=n.current,t=e.scrollTop,i=e.scrollHeight,o=e.clientHeight,r=Object(c.c)()&&C.current&&s?1:0;I(t>r+S),L(t+o+r+S<i)}}));return Object(d.useEffect)((function(){Object(c.c)()&&s&&window.addEventListener("resize",F.current)}),[s]),Object(d.useEffect)((function(){null!==n&&void 0!==n&&n.current&&n.current.addEventListener("scroll",U.current)}),[U,n]),Object(d.useEffect)((function(){var e=T.current;return Object(c.g)()&&s&&(document.body.style.overflow="hidden"),B.current(),function(){Object(c.g)()&&s&&(document.body.style.overflow=e)}}),[s,B,T]),u.a.createElement(l.q,Object.assign({display:"flex",flexDirection:"column"},E),u.a.createElement(p,{overflowY:"auto",flex:1,innerRef:n,display:"flex",flexDirection:"column",_css:A&&Object(c.b)()?"\n              &::-webkit-scrollbar-track {\n                background-color: transparent;\n              }\n              &::-webkit-scrollbar-thumb {\n\n                border-radius: 9999em;\n                box-shadow: inset 0 0 ".concat(10,"px ").concat(10,"px ").concat(v?"transparent":j,";\n                border: solid 2px transparent;\n              }\n              &::-webkit-scrollbar {\n                width: ").concat(10,"px;\n              }\n\n              scrollbar-color: ").concat(v?"transparent":j," transparent;\n              scrollbar-width: ").concat(10,"px;\n\n              &:hover {\n                &::-webkit-scrollbar-thumb {\n                  box-shadow: inset 0 0 ").concat(10,"px ").concat(10,"px ").concat(j,";\n                }\n                scrollbar-color: ").concat(j," transparent;\n              }\n          "):""},u.a.createElement(l.e,b,t),u.a.createElement(m,{top:0,fullX:!0,height:6,opacity:O?1:0,transition:"opacity",transitionDuration:"100ms"}),u.a.createElement(g,{bottom:0,fullX:!0,height:6,opacity:N?1:0,transition:"opacity",transitionDuration:"100ms"})))}},I01J:function(e,t,n){var i=n("44Ds");e.exports=function(e){var t=i(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}},IOzZ:function(e,t){e.exports=function(e,t){return function(n){return null!=n&&(n[e]===t&&(t!==undefined||e in Object(n)))}}},Juji:function(e,t){e.exports=function(e,t){return null!=e&&t in Object(e)}},KHUD:function(e,t,n){"use strict";var i=n("QILm"),o=n.n(i),r=n("lwsE"),a=n.n(r),s=n("W8MJ"),l=n.n(s),c=n("PJYZ"),d=n.n(c),u=n("7W2i"),h=n.n(u),f=n("a1gu"),p=n.n(f),m=n("Nsbk"),g=n.n(m),v=n("vOnD"),b=n("RA+f"),y=n("nwxp"),x=n("q1tI"),S=n.n(x);function E(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=g()(e);if(t){var o=g()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return p()(this,n)}}var C=Object(v["default"])(b.i).withConfig({displayName:"FixedBottomBox___StyledFixed",componentId:"stb0yv-0"})([""," transform:translateY(-","px);"],(function(e){return e._css}),(function(e){return e._css2})),_=function(e){h()(n,e);var t=E(n);function n(e){var i;return a()(this,n),(i=t.call(this,e)).isUpdating=void 0,i.ref=void 0,i.isUpdating=!1,i.state={bottomOffset:0},i.ref=S.a.createRef(),i.handleViewportChange=i.handleViewportChange.bind(d()(i)),i}return l()(n,[{key:"componentDidMount",value:function(){var e,t;(window.visualViewport&&Object(y.f)()&&y.o&&(window.visualViewport.addEventListener("scroll",this.handleViewportChange),window.visualViewport.addEventListener("resize",this.handleViewportChange),window.visualViewport.dispatchEvent(new Event("resize"))),this.ref.current)&&(null===(e=(t=this.props).onHeightMeasure)||void 0===e||e.call(t,this.ref.current.clientHeight))}},{key:"handleViewportChange",value:function(e){var t=this;this.isUpdating||(this.isUpdating=!0,requestAnimationFrame((function(){t.isUpdating=!1;var n=e.target;n&&t.setState({bottomOffset:window.innerHeight-n.height})})))}},{key:"componentWillUnmount",value:function(){window.visualViewport&&(window.visualViewport.removeEventListener("scroll",this.handleViewportChange),window.visualViewport.removeEventListener("resize",this.handleViewportChange))}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.css,i=e.animateTransition,r=void 0!==i&&i,a=o()(e,["children","css","animateTransition"]);return S.a.createElement(C,Object.assign({},a,{transition:r?"transform":undefined,transitionTimingFunction:y.o&&r?"cubic-bezier(.17,.59,.4,.77)":undefined,transitionDuration:y.o&&r?"260ms":undefined,innerRef:this.ref,_css:n||"",_css2:this.state.bottomOffset}),t)}}]),n}(S.a.Component);_.displayName="FixedBottomBox",t.a=_},NvBY:function(e,t,n){"use strict";n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d}));var i=n("SKAY"),o=n("mVMq"),r=n("5jM5"),a=function(e){return"quora.com"!=Object(i.getSetting)("subdomainSuffix")?e:s(e)},s=function(e){return Object(r.e)({subdomainName:"upload",path:e})},l=function(e,t,n,r){for(var s=new window.FormData,l=Object.keys(e),c=0;c<l.length;c++)s.append(l[c],e[l[c]]);for(var d=0;d<t.length;d++)s.append("file",t[d]);s.append("nid",Object(i.getSetting)("nid"));var u=function(){var e=[];return e.length?e.join("&"):""}();u&&s.append("post_url_suffix",u),Object(o.b)(a("/_/imgupload/upload_POST"),s).then((function(e){var t=e||{};t.success?n(t):r(t)}))["catch"](r)},c=function(e,t,n,i){var r=new window.FormData;r.append("job_id",e),r.append("blob",t),Object(o.b)(a("/_/ad/upload_audience_POST"),r).then((function(e){var t=e||{};t.success?n(t):i(t)}))["catch"](i)},d=function(e,t,n){var r=new window.FormData;r.append("blob",e),r.append("nid",Object(i.getSetting)("nid")),Object(o.b)(a("/_/contactupload/upload_contacts_POST"),r).then((function(e){var i=e||{};i.success?t(i):n(i)}))["catch"](n)}},O7RO:function(e,t,n){var i=n("CMye"),o=n("7GkX");e.exports=function(e){for(var t=o(e),n=t.length;n--;){var r=t[n],a=e[r];t[n]=[r,a,i(a)]}return t}},ZCpW:function(e,t,n){var i=n("lm/5"),o=n("O7RO"),r=n("IOzZ");e.exports=function(e){var t=o(e);return 1==t.length&&t[0][2]?r(t[0][0],t[0][1]):function(n){return n===e||i(n,e,t)}}},ZWtO:function(e,t,n){var i=n("4uTw"),o=n("9Nap");e.exports=function(e,t){for(var n=0,r=(t=i(t,e)).length;null!=e&&n<r;)e=e[o(t[n++])];return n&&n==r?e:undefined}},"a+Nv":function(e,t,n){"use strict";n.r(t),n.d(t,"createDoc",(function(){return Xe})),n.d(t,"default",(function(){return Ze}));var i=n("RIqP"),o=n.n(i),r=n("lwsE"),a=n.n(r),s=n("W8MJ"),l=n.n(s),c=n("PJYZ"),d=n.n(c),u=n("7W2i"),h=n.n(u),f=n("a1gu"),p=n.n(f),m=n("Nsbk"),g=n.n(m),v=n("rg3m"),b=Object(v.a)({loader:function(){return n.e("common-NativeApp").then(n.bind(null,"rS24"))},defer:!1}),y=n("3jYl"),x=n("Iu3b"),S=n("LNH1"),E=n("RA+f"),C=n("+pxc"),_=n("SKAY"),T=n("8lmh"),k=n("nqCt"),w=n("yju1"),O=n("nwxp"),I=n("mVMq"),M=n("sEfC"),R=n.n(M),N=n("Y+p1"),L=n.n(N),P=n("q1tI"),D=n.n(P),A=n("i8i4"),j=n.n(A),B=n("odos"),F=n("51I4"),U=n("AFGi"),q=n("QiXO"),H=n("+tOH"),Q=n("k4Da"),z=n.n(Q);function V(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=g()(e);if(t){var o=g()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return p()(this,n)}}var W=function(e){h()(n,e);var t=V(n);function n(e){var i;return a()(this,n),(i=t.call(this,e)).state={hyperlinkEmbeds:[]},i}return l()(n,[{key:"insertHyperlinkEmbedPreview",value:function(e){this.setState((function(t){return{hyperlinkEmbeds:[].concat(o()(t.hyperlinkEmbeds),[e])}}))}},{key:"removeHyperlinkEmbedPreview",value:function(e){this.setState((function(t){return{hyperlinkEmbeds:z()(t.hyperlinkEmbeds,(function(t){return t.placeholder!==e.placeholder}))}}))}},{key:"render",value:function(){var e=this;return D.a.createElement(D.a.Fragment,null,this.state.hyperlinkEmbeds.map((function(t){return j.a.createPortal(D.a.createElement(H.a,{span:{text:"",modifiers:{embed:t.data}},omitBottomMargin:!0,readOnly:!0,showMenuButton:!0,showInlineQuoraEmbed:e.props.showInlineQuoraEmbed,convertToTextLink:t.convertToTextLink,removeEmbed:t.removeEmbed}),t.placeholder)})))}}]),n}(D.a.Component);W.displayName="QTextHyperlinkEmbedManager";var K=n("lSNA"),J=n.n(K),Y=n("o0o1"),G=n.n(Y),X=n("yXPU"),Z=n.n(X),$=n("jufJ"),ee=n("hWFa"),te=n("NvBY"),ne=n("vN+2"),ie=n.n(ne),oe=n("LJFN");function re(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=g()(e);if(t){var o=g()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return p()(this,n)}}var ae=function(e){var t=e.count,n=void 0===t?0:t;return D.a.createElement($.Translate,null,D.a.createElement($.PluralTranslate,{value:n},{ONE:"There was an error uploading this file.",OTHER:"There was an error uploading these files."}))};ae.displayName="UploadErrorMessage";var se=function(e){h()(n,e);var t=re(n);function n(e){var i;return a()(this,n),(i=t.call(this,e)).fileInputRef=void 0,i._objectUrlToFileMap={},i._errorObjectUrltoFileMap={},i._onPendingImageUploadSuccess=function(e,t){var n,o;if(null!==e&&void 0!==e&&e.success&&(null===e||void 0===e?void 0:e.qimg_urls.length)>0){var r={};Object.keys(i._objectUrlToFileMap).forEach((function(t,n){r[t]=e.qimg_urls[n]})),i._objectUrlToFileMap={},t(r)}null===(n=(o=i.props).onImageUploadStatusChange)||void 0===n||n.call(o,oe.b.ready)},i._onPendingImageUploadError=function(e,t){var n,o;null===(n=(o=i.props).onImageUploadStatusChange)||void 0===n||n.call(o,oe.b.ready),i._onError(e),i._errorObjectUrltoFileMap=Object.assign({},i._errorObjectUrltoFileMap,i._objectUrlToFileMap),i._objectUrlToFileMap={},t(Object.keys(i._errorObjectUrltoFileMap))},i.uploadImagesFromUrls=function(){var e=Z()(G.a.mark((function t(e){var n,o,r;return G.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(e.map(function(){var e=Z()(G.a.mark((function t(e){return G.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(oe.c)(e));case 1:case"end":return t.stop()}}),t)})));return function(t){return e.apply(this,arguments)}}()));case 2:r=t.sent,e.forEach((function(e,t){i._objectUrlToFileMap[e]=r[t]})),null===(n=(o=i.props).onImageUploadStatusChange)||void 0===n||n.call(o,oe.b.uploading),i.props.onAddImages&&i.props.onAddImages(e,!0);case 6:case"end":return t.stop()}}),t)})));return function(t){return e.apply(this,arguments)}}(),i.state={visible:!1,count:0,error:!1},i.fileInputRef=D.a.createRef(),i.onInputChange=i.onInputChange.bind(d()(i)),i.onDrop=i.onDrop.bind(d()(i)),i._onUpload=i._onUpload.bind(d()(i)),i._onError=i._onError.bind(d()(i)),i.props.doc.on("paste",(function(e){return i._onPaste(e)})),i}return l()(n,[{key:"showUploading",value:function(e){this.setState({visible:!0,error:!1,count:e})}},{key:"showDropZone",value:function(){this.setState({visible:!0,error:!1,count:0})}},{key:"hideDropZone",value:function(){this.setState({visible:!1,count:0})}},{key:"_onUpload",value:function(e){this.props.onAddImages&&this.props.onAddImages(e.qimg_urls,!1),this.hideDropZone()}},{key:"_onError",value:function(e){null!==e&&void 0!==e&&e.message?alert(e.message):alert(Object($.plaintextTranslate)(D.a.createElement(ae,{count:this.state.count}))),this.hideDropZone()}},{key:"_onPaste",value:function(e){var t=e.clipboardData,n=[];if(t&&t.items){for(var i=0;i<t.items.length;++i){var o=t.items[i].type;(o.match(/image/i)||o.match(/file/i))&&n.push(t.items[i].getAsFile())}this.startUpload(n)}}},{key:"startUpload",value:function(e){var t=this;if(0!==e.length)if(this.props.useEagerImageUploading){var n,i,o=Array.from(e).map((function(e){var n=URL.createObjectURL(e);return t._objectUrlToFileMap[n]=e,n}));this.props.onAddImages&&this.props.onAddImages(o,!0),null===(n=(i=this.props).onImageUploadStatusChange)||void 0===n||n.call(i,oe.b.uploading),this.hideDropZone()}else this.showUploading(e.length),Object(te.c)({kind:"qtext"},e,this._onUpload,this._onError);else this.hideDropZone()}},{key:"onInputChange",value:function(){var e=this.fileInputRef.current;this.startUpload(e.files),e.value=null}},{key:"onDrop",value:function(e){if(e.preventDefault(),e.stopPropagation(),e.dataTransfer&&e.dataTransfer.files){for(var t=[],n=0;n<e.dataTransfer.files.length;++n){var i=e.dataTransfer.files[n].type;(i.match(/image/i)||i.match(/file/i))&&t.push(e.dataTransfer.files[n])}this.startUpload(t)}else this.hideDropZone()}},{key:"triggerUpload",value:function(){this.fileInputRef.current.click()}},{key:"uploadImageUrl",value:function(e,t,n){var i=this;Object(I.a)("/qtext/upload_image_url_POST",{json:JSON.stringify({args:[],kwargs:{url:e}})}).then((function(e){var o=e||{};o.value&&Object(ee.d)(o.value)?null===t||void 0===t||t(o.value):(null===n||void 0===n||n(),i._onError(o))}))["catch"]((function(e){null===n||void 0===n||n(),i._onError(e)}))}},{key:"uploadPendingImages",value:function(e,t,n,i){var o=this;if(i){var r=e[0];this.uploadImageUrl(r,(function(e){t(J()({},r,e))}),(function(){n([r])}))}else if(e.length>0){var a=e.map((function(e){return o._objectUrlToFileMap[e]}));Object(te.c)({kind:"qtext"},a,(function(e){return o._onPendingImageUploadSuccess(e,t)}),(function(e){return o._onPendingImageUploadError(e,n)}))}}},{key:"retryUpload",value:function(e,t){this._objectUrlToFileMap=Object.assign({},this._errorObjectUrltoFileMap),this._errorObjectUrltoFileMap={};var n=Object.keys(this._objectUrlToFileMap);this.uploadPendingImages(n,e,t,!1)}},{key:"render",value:function(){var e=this,t=this.state,n=t.visible,i=void 0!==n&&n,o=t.count,r=void 0===o?0:o,a=t.error,s=void 0===a?null:a,l={bg:i?"white_transparent_light":null,borderColor:i?"blue":"transparent",borderWidth:this.props.isCompactEditor?"2px":"4px",borderStyle:"dashed",display:i?"flex":"none"};return D.a.createElement(D.a.Fragment,null,D.a.createElement("input",{type:"file",accept:".jpg, .png, .jpeg, .gif, .bmp|images/*",multiple:!0,ref:this.fileInputRef,style:{display:"none"},onChange:this.onInputChange}),D.a.createElement(E.a,Object.assign({full:!0,className:"drop_zone",alignItems:"center",justifyContent:"center"},l,{onDrop:this.onDrop,onDragOver:function(e){return e.preventDefault()},onDragLeave:function(){return e.hideDropZone()},onClick:function(){e.hideDropZone()},zIndex:"inline_overlay"}),i?D.a.createElement(E.s,{color:"blue",medium:!0,fontSize:this.props.isCompactEditor?14:22},s?D.a.createElement(ae,{count:r}):D.a.createElement($.Translate,null,D.a.createElement($.PluralTranslate,{value:r},{ZERO:"Drop images here",ONE:D.a.createElement(D.a.Fragment,null,"Uploading ",D.a.createElement($.FormattedNumber,{value:r})," image..."),OTHER:D.a.createElement(D.a.Fragment,null,"Uploading ",D.a.createElement($.FormattedNumber,{value:r})," images...")}))):null))}}]),n}(P.Component);se.defaultProps={onAddImages:ie.a};var le=n("9dNZ"),ce=n("3wQG"),de=n("vOnD"),ue=n("cbxS"),he=n("/bbo"),fe=n("OMLc"),pe=n("Ftba");function me(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=g()(e);if(t){var o=g()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return p()(this,n)}}var ge=function(e){return"\n    user-select: none !important;\n    -webkit-user-select: none !important;\n    -ms-user-select: none !important;\n    line-height: ".concat(Object(pe.c)(e)," !important;\n  ")},ve=Object(de["default"])(E.a).withConfig({displayName:"QTextUploadRetryManager___StyledAbsolute",componentId:"sc-16mzks9-0"})(["",""],(function(e){return e._css})),be=Object(de["default"])(E.a).withConfig({displayName:"QTextUploadRetryManager___StyledAbsolute2",componentId:"sc-16mzks9-1"})(["",""],(function(e){return e._css2})),ye=function(e){h()(n,e);var t=me(n);function n(){var e;a()(this,n);for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).state={imgSections:[]},e}return l()(n,[{key:"insertButtonAndBanner",value:function(e){this.setState((function(t){return{imgSections:[].concat(o()(t.imgSections),[e])}}))}},{key:"removeButtonAndBanner",value:function(e){this.setState((function(t){return{imgSections:z()(t.imgSections,(function(t){return t.button!==e.button&&t.banner!==e.banner}))}}))}},{key:"renderButton",value:function(){return D.a.createElement(ve,{center:!0,contentEditable:!1,_css:ge(this.props.theme)},D.a.createElement(he.a,{variant:"blue",text:Object($.plaintextTranslate)("Retry"),icon:D.a.createElement(fe.b,{name:"Sync"})}))}},{key:"renderBanner",value:function(){return D.a.createElement(be,{fullX:!0,bottom:"0%",contentEditable:!1,_css2:ge(this.props.theme)},D.a.createElement(ue.a,{p:"tiny",buttonVariant:"error",variant:"warning_inverted",icon:D.a.createElement(fe.b,{name:"Error"}),title:Object($.plaintextTranslate)("Image failed to upload.")}))}},{key:"render",value:function(){var e=this;return D.a.createElement(D.a.Fragment,null,this.state.imgSections.map((function(t){return D.a.createElement(D.a.Fragment,null,j.a.createPortal(e.renderButton(),t.button),j.a.createPortal(e.renderBanner(),t.banner))})))}}]),n}(D.a.Component);ye.displayName="QTextUploadRetryManager";var xe=Object(de.withTheme)(ye),Se=n("bmMU"),Ee=n.n(Se),Ce=n("QILm"),_e=n.n(Ce),Te=n("yY6q");function ke(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=g()(e);if(t){var o=g()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return p()(this,n)}}var we=function(e){h()(n,e);var t=ke(n);function n(e){var i;return a()(this,n),(i=t.call(this,e)).currentActiveToolbar=void 0,i.editorKey="",i.handleShareImages=function(e){null!==e&&void 0!==e&&e.shareImages&&i.props.onImageSelected(e.shareImages)},i.handleQtextNativeToolbarAction=function(e){i.handleToolbarAction(e)},i.currentActiveToolbar=-1,i}return l()(n,[{key:"shouldComponentUpdate",value:function(e,t){return!Ee()(this.currentActiveToolbar,e.activeToolbar)||!Ee()(this.props.buttonStates,e.buttonStates)||!Ee()(this.state,t)||!Ee()(this.props.stickyButtonInfo,e.stickyButtonInfo)||this.props.shouldShow!==e.shouldShow}},{key:"handleToolbarAction",value:function(e){var t=e.eventName,n=e.args,i=this.props,o=i.onButtonClick,r=i.onLinkInput,a=i.onImageUpload,s=i.onImageSelected;switch(t){case"click":o(n);break;case"linkInput":r(n);break;case"imageUpload":a(n);break;case"imageSelected":s(n)}}},{key:"getButtonParams",value:function(e,t){if(2!==t){var n=[],i=[],o=this.props,r=o.onRulesButtonClick,a=o.stickyButtonInfo,s=["post","monetization"];return e.forEach((function(e){if("rules"===e.name)r&&i.push(Object.assign({},e,{text:Object($.plaintextTranslate)("Rules")}));else if(s.includes(e.name)){if(a&&"native"===a.platform&&e.name===a.name){a.onClick,a.platform;var t=_e()(a,["onClick","platform"]);i.push(Object.assign({},e,t))}}else"dismiss"===e.name?i.push(e):n.push(e)})),Object.assign({buttons:n},i.length>0?{stickyButtons:i,stickyButtonsAlign:0===t?"end":"start"}:{})}return{buttons:e}}},{key:"sendToolbarUpdateMessage",value:function(){var e=this.props,t=e.buttonStates,n=e.activeToolbar;e.isLightWeightContentStyle?Object(w.a)("updateToolbar",Object.assign({},this.getButtonParams(t[n],n),{animation:this.currentActiveToolbar<n?"up":this.currentActiveToolbar>n?"down":null,lightweight:!0})):Object(w.a)("updateToolbar",{buttons:t[n],animation:this.currentActiveToolbar<n?"up":this.currentActiveToolbar>n?"down":null}),this.currentActiveToolbar!==n&&(this.currentActiveToolbar=n)}},{key:"showToolbar",value:function(){Object(_.registerMessageHandler)("qtextNativeToolbarAction",this.handleQtextNativeToolbarAction),Object(_.registerMessageHandler)("nativeShareImages",this.handleShareImages),this.sendToolbarUpdateMessage()}},{key:"hideToolbar",value:function(){Object(w.a)("hideEditorToolbar"),Object(_.removeMessageHandler)("qtextNativeToolbarAction",this.handleQtextNativeToolbarAction),Object(_.removeMessageHandler)("nativeShareImages",this.handleShareImages)}},{key:"componentDidMount",value:function(){this.showToolbar()}},{key:"componentWillUnmount",value:function(){this.hideToolbar()}},{key:"componentDidUpdate",value:function(e){e.shouldShow&&!this.props.shouldShow?this.hideToolbar():!e.shouldShow&&this.props.shouldShow?this.showToolbar():this.props.shouldShow&&this.sendToolbarUpdateMessage()}},{key:"render",value:function(){return D.a.createElement(D.a.Fragment,null)}}]),n}(D.a.Component);we.displayName="InnerNativeQTextEditorToolbar";var Oe=function(e){return D.a.createElement(Te.ModalContainerContext.Consumer,null,(function(t){return D.a.createElement(we,Object.assign({},e,{shouldShow:!1!==(null===t||void 0===t?void 0:t.isTopModal)}))}))};Oe.displayName="NativeQTextEditorToolbar";var Ie=Oe,Me=n("zLpq"),Re=n("f5aN"),Ne=n("MzdU"),Le=n("85N6"),Pe=n("VwdU"),De=n("llss"),Ae=n("QLaP"),je=n.n(Ae);function Be(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=g()(e);if(t){var o=g()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return p()(this,n)}}var Fe=function(e,t){return t?2===e:0===e},Ue=function(){return{bold:D.a.createElement(fe.b,{name:"EditorBold","aria-label":Object(y.plaintextTranslate)("Toggle bold")}),italic:D.a.createElement(fe.b,{name:"EditorItalicize","aria-label":Object(y.plaintextTranslate)("Toggle italicize")}),ordered_list:D.a.createElement(fe.b,{name:"EditorOrderedList","aria-label":Object(y.plaintextTranslate)("Add ordered list")}),unordered_list:D.a.createElement(fe.b,{name:"EditorUnorderedList","aria-label":Object(y.plaintextTranslate)("Add unordered list")}),indent:D.a.createElement(fe.b,{name:"EditorIndent","aria-label":Object(y.plaintextTranslate)("Add indent")}),deindent:D.a.createElement(fe.b,{name:"EditorDeindent","aria-label":Object(y.plaintextTranslate)("Remove indent")}),image:D.a.createElement(fe.b,{name:"EditorPhotos","aria-label":Object(y.plaintextTranslate)("Add image")}),link:D.a.createElement(fe.b,{name:"EditorLink","aria-label":Object(y.plaintextTranslate)("Add link")}),overflow_show:D.a.createElement(fe.b,{name:"Overflow","aria-label":Object(y.plaintextTranslate)("Show formatting options")}),mention:D.a.createElement(fe.b,{name:"EditorMention","aria-label":Object(y.plaintextTranslate)("Add mention")}),quote:D.a.createElement(fe.b,{name:"EditorQuote","aria-label":Object(y.plaintextTranslate)("Format quote")}),code:D.a.createElement(fe.b,{name:"EditorCode","aria-label":Object(y.plaintextTranslate)("Format code")}),math:D.a.createElement(fe.b,{name:"EditorMath","aria-label":Object(y.plaintextTranslate)("Format math")}),undo:D.a.createElement(fe.b,{name:"EditorUndo","aria-label":Object(y.plaintextTranslate)("Undo")}),redo:D.a.createElement(fe.b,{name:"EditorRedo","aria-label":Object(y.plaintextTranslate)("Redo")}),overflow_hide:D.a.createElement(fe.b,{name:"Close","aria-label":Object(y.plaintextTranslate)("Hide overflow menu")}),text_formatting:D.a.createElement(fe.b,{name:"EditorTextFormatting","aria-label":Object(y.plaintextTranslate)("Text formatting")}),h1:D.a.createElement(fe.b,{name:"H1Font","aria-label":Object(y.plaintextTranslate)("Toggle heading font")}),space:D.a.createElement(D.a.Fragment,null)}};Ue.displayName="getToolbarButtonIconMap";var qe=function(e){var t=e.name,n=e.icon,i=e.pressed,o=void 0!==i&&i,r=e.disabled,a=void 0!==r&&r,s=e.onClick,l=o?"blue":"gray",c=o?"gray":"transparent",d=a?.5:1;return D.a.createElement(E.f,{onClick:function(e){(e.preventDefault(),a)||s&&s(t,!o)},onKeyDown:function(e){(!a&&e.keyCode===De.a.ENTER||e.keyCode===De.a.SPACE)&&(e.preventDefault(),s&&s(t,!o))},display:"inline-flex",alignItems:"center",justifyContent:"center",size:30,mr:"small",borderRadius:"small",borderAll:Object(O.b)(),borderColor:c,opacity:d,transition:"border-color",cursor:"pointer",hover:{borderColor:"blue"}},D.a.cloneElement(n,{color:l,isFilled:o}))};qe.displayName="ToolbarButton";var He=Object(de["default"])(E.g).withConfig({displayName:"ReactQTextEditorToolbar___StyledCssComponent",componentId:"sc-1egumr2-0"})(["input::placeholder{direction:",";text-align:",";}"],(function(e){return e._css}),(function(e){return e._css2})),Qe=function(e){h()(n,e);var t=Be(n);function n(e){var i;return a()(this,n),(i=t.call(this,e)).linkRef=void 0,i.citationRef=void 0,i.closeLink=function(){(0,i.props.onLinkInput)({})},i.linkRef=D.a.createRef(),i.citationRef=D.a.createRef(),i.state={linkInput:""},i}return l()(n,[{key:"saveLink",value:function(){var e,t=this.props.onLinkInput,n=this.state.linkInput,i=null===(e=this.citationRef.current)||void 0===e?void 0:e.checked;this.citationRef.current&&(this.setState({linkInput:""}),this.citationRef.current.checked=!1),t({url:n,isCitation:i})}},{key:"componentDidUpdate",value:function(e){var t=this;this.props.isLightWeightContentStyle?2===this.props.activeToolbar&&2!==e.activeToolbar&&setTimeout((function(){t.linkRef.current.focus()}),200):0===this.props.activeToolbar&&0!==e.activeToolbar&&this.linkRef.current.focus()}},{key:"renderLinkInput",value:function(){var e=this;return D.a.createElement(y.BidiDirectionContext.Consumer,{key:"toolbar-link-input-wrapper"},(function(t){return D.a.createElement(He,{style:{width:"100%"},_css:t===y.BidiDirection.RTL?"rtl":"ltr",_css2:t===y.BidiDirection.RTL?"right":"left"},D.a.createElement(E.o,{width:"100%",value:e.state.linkInput,key:"toolbar-link-input",type:"url",innerRef:e.linkRef,placeholder:Object(y.plaintextTranslate)("Enter URL"),flex:"auto",px:"tiny",mr:"small",color:"gray_dark",fontSize:15,fontFamily:"sans",style:{outline:"none",border:"none"},onChange:function(t){e.setState({linkInput:t.target.value})},onKeyUp:function(t){"Escape"===t.key&&e.closeLink(),"Enter"===t.key&&e.saveLink()}}))}))}},{key:"renderCitationCheckbox",value:function(){return D.a.createElement(E.n,{key:"toolbar-citation-checkbox",pr:"small",alignItems:"center"},D.a.createElement("input",{id:"is_citation",ref:this.citationRef,type:"checkbox"}),D.a.createElement(E.s,{as:"label",ml:"tiny",htmlFor:"is_citation",color:"gray_light",fontSize:"tiny"},D.a.createElement(y.Translate,null,"Footnote")))}},{key:"renderLinkSaveButton",value:function(){var e=this;return D.a.createElement(he.a,{key:"save-link",onClick:function(){e.saveLink()},size:"small",variant:this.state.linkInput.length>0?"blue_light":"gray",text:this.state.linkInput.length>0?D.a.createElement(y.Translate,null,"Add"):D.a.createElement(y.Translate,null,"Cancel")})}},{key:"renderRulesButton",value:function(){var e=this.props,t=e.isLightWeightContentStyle,n=e.onRulesButtonClick;return t&&n?D.a.createElement(Me.a,{key:"rules",onClick:function(e){e.preventDefault(),n()},mr:"small",icon:D.a.createElement(fe.b,{name:"Info"}),text:Object(y.plaintextTranslate)("Rules"),size:Object(O.e)()?"small":"regular"}):null}},{key:"renderStickyButton",value:function(){var e=this.props,t=e.isLightWeightContentStyle,n=e.stickyButtonInfo;if(!t||!n)return null;var i=n.platform,o=n.name,r=n.onClick,a=_e()(n,["platform","name","onClick"]);return"web"!==i?(Object(T.logJsError)("react-qtext-toolbar-sticky-button","Invalid information was provided for non-native toolbar ".concat(n.name)),null):D.a.createElement(Me.a,Object.assign({key:o,size:"small",mr:"small",onClick:r},a))}},{key:"renderHideOverflowButton",value:function(e){return D.a.createElement(E.n,{key:"toolbar-button-overflow_hidden",alignItems:"center",justifyContent:"center",size:"30px",ml:Object(O.b)()?"":"tiny",mr:"small",transition:"border-color",cursor:"pointer"},D.a.createElement(E.f,{onClick:function(t){t.preventDefault(),e()}},D.a.createElement(Ne.a,{bg:"blue",borderRadius:"circle",size:24,iconName:"ChevronDown"})))}},{key:"onButtonClick",value:function(e){var t=this.props.onButtonClick;t(e)}},{key:"renderButton",value:function(e){var t=this,n=e.name,i=e.pressed,o=void 0!==i&&i,r=e.disabled,a=void 0!==r&&r,s=this.props.stickyButtonInfo,l=Ue();switch(n){case"link_input_icon":return D.a.createElement(fe.b,{key:"toolbar_link_input_icon",color:"blue",name:"EditorLink"});case"link_input":return this.renderLinkInput();case"cite":return this.renderCitationCheckbox();case"link_save":return this.renderLinkSaveButton();case"rules":return this.renderRulesButton();case"monetization":return s&&"monetization"===s.name?this.renderStickyButton():null;case"post":return null;case"dismiss":return this.renderHideOverflowButton((function(){return t.onButtonClick(n)}));default:return je()(l[n],"Given icon '".concat(n,"' does not exist. Available options: ").concat(Object.keys(l).join(", "))),D.a.createElement(qe,{key:"toolbar-button-".concat(n),name:n,icon:l[n],onClick:function(){return t.onButtonClick(n)},pressed:o,disabled:a})}}},{key:"renderLightWeightContentTextFormattingOptions",value:function(){var e=this,t=this.props,n=t.buttonStates,i=t.isLightWeightContentStyle,o=n[1].find((function(e){return"dismiss"===e.name})),r=n[1].filter((function(e){return"dismiss"!==e.name}));return D.a.createElement(E.j,{key:"editor-toolbar-1",alignItems:"center",px:i?"":"tiny",height:"".concat(44,"px")},o&&this.renderButton(o),D.a.createElement(Re.c,null,r.map((function(t){return e.renderButton(t)}))))}},{key:"renderBar",value:function(e){var t=this,n=this.props,i=n.buttonStates,o=n.isLightWeightContentStyle,r=n.overflowMenu,a=function(e){var t=e.findIndex((function(e){return"space"===e.name}));return-1===t?{leftButtons:e,rightButtons:[]}:{leftButtons:e.slice(0,t),rightButtons:e.slice(t+1)}}(i[e]),s=a.leftButtons,l=a.rightButtons,c=undefined;return Fe(e,o)?Object(O.b)()&&(c=o?"medium":"small"):c="n_small",D.a.createElement(E.j,{key:"editor-toolbar-".concat(e),alignItems:"center",justifyContent:"space-between",px:o?"":"tiny",height:"".concat(44,"px")},D.a.createElement(E.n,{flex:1},s.map((function(e){return t.renderButton(e)})),r),D.a.createElement(E.n,{mr:c,borderRight:o&&Fe(e,o)&&Object(O.b)(),pr:o&&Fe(e,o)&&Object(O.b)()?"medium":undefined},l.map((function(e){return t.renderButton(e)}))))}},{key:"render",value:function(){var e,t=this,n=this.props,i=n.activeToolbar,o=n.isBottomOfEditor,r=n.isLightWeightContentStyle,a="-".concat(44*i,"px"),s=!Object(O.b)()&&r;return D.a.createElement(Pe.a,{condition:r&&Fe(i,r),wrapper:function(e){return D.a.createElement(Le.a,{onClickAway:t.closeLink},e)}},D.a.createElement(E.q,{mt:null!==(e=o&&!r?14:null)&&void 0!==e?e:undefined,borderBottom:!o&&!s,borderWidth:"regular",overflow:"hidden",height:"".concat(44,"px")},D.a.createElement(E.a,{fullX:!0,ml:Object(O.b)()?"small":"n_tiny",top:a,transition:"top",transitionDuration:"0.25s"},[0,1,2].map((function(e){return r&&1===e?t.renderLightWeightContentTextFormattingOptions():t.renderBar(e)})))),!o&&s&&D.a.createElement(E.a,{fullX:!0,width:"100%",borderBottom:!0,borderWidth:"regular"}))}}]),n}(D.a.Component);function ze(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=g()(e);if(t){var o=g()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return p()(this,n)}}Qe.defaultProps={isBottomOfEditor:!1},Qe.displayName="ReactQTextEditorToolbar";var Ve=function(e){return[0,1,2].map((function(t){return e.getToolbarState(t)}))},We=function(e){h()(n,e);var t=ze(n);function n(e){var i;return a()(this,n),(i=t.call(this,e)).saveLinkCallback=void 0,i._isMounted=!1,i.refreshButtonStates=function(){var e=i.props.doc;e&&i._isMounted&&i.setState({buttonStates:Ve(e)})},i.resetActiveToolbar=function(){var e=i.props,t=e.doc,n=e.isLightWeightContentStyle;t&&i._isMounted&&i.setState({activeToolbar:n?0:1})},i.onImageSelected=function(e){i.props.imageUploaderRef.current&&i.props.imageUploaderRef.current.uploadImagesFromUrls(e)},i.state={activeToolbar:e.isLightWeightContentStyle?0:1,buttonStates:i.props.doc?Ve(i.props.doc):[]},i}return l()(n,[{key:"componentDidMount",value:function(){var e,t,n;this._isMounted=!0,null===(e=this.props.doc)||void 0===e||e.on("updateToolbar",R()(this.refreshButtonStates,100,{leading:!1,trailing:!0})),null===(t=this.props.doc)||void 0===t||t.on("resetToolbar",R()(this.resetActiveToolbar,100,{leading:!1,trailing:!0})),null===(n=this.props.doc)||void 0===n||n.on("meaningfulChange",R()(this.refreshButtonStates,300,{leading:!1,trailing:!0}))}},{key:"shouldComponentUpdate",value:function(e,t){return!Ee()(this.props,e)||!Ee()(this.state,t)}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"onButtonClick",value:function(e){var t=this.props,n=t.doc,i=t.imageUploaderRef,o=t.isLightWeightContentStyle,r=t.onRulesButtonClick,a=t.stickyButtonInfo;if(o)switch(e){case"text_formatting":this.setState({activeToolbar:1});break;case"dismiss":this.setState({activeToolbar:0});break;case"rules":r&&r();break;case"post":a&&"post"===a.name&&a.onClick();break;case"monetization":a&&"monetization"===a.name&&a.onClick();break;case"photo":case"image":return void(i.current&&i.current.triggerUpload())}else switch(e){case"overflow_show":this.setState({activeToolbar:2});break;case"overflow_hide":this.setState({activeToolbar:1});break;case"image":return void(i.current&&i.current.triggerUpload())}var s=[e,null,{source:"toolbar",button:e}];null===n||void 0===n||n.handleCommand.apply(n,s),this.refreshButtonStates(),"link"!==e&&(null===n||void 0===n||n.focus())}},{key:"setupLinkInput",value:function(e){this.saveLinkCallback=e,this.props.isLightWeightContentStyle?this.setState({activeToolbar:2}):this.setState({activeToolbar:0})}},{key:"onLinkInput",value:function(e){var t=e.url,n=e.isCitation;t&&this.saveLinkCallback&&this.saveLinkCallback({url:t,isCitation:n}),this.saveLinkCallback=undefined,this.setState({activeToolbar:1})}},{key:"render",value:function(){var e=this,t=this.props,n=t.doc,i=t.onImageUpload,o=t.isBottomOfEditor,r=t.isLightWeightContentStyle,a=t.onRulesButtonClick,s=t.stickyButtonInfo,l=t.overflowMenu,c=this.state,d=c.activeToolbar,u=c.buttonStates,h=Object(O.g)()?Ie:Qe;return n&&D.a.createElement(h,{activeToolbar:d,onButtonClick:function(t){return e.onButtonClick(t)},onLinkInput:function(t){var n=t.url,i=void 0===n?"":n,o=t.isCitation,r=void 0!==o&&o;return e.onLinkInput({url:i,isCitation:r})},onImageUpload:function(e){return i(e)},onImageSelected:this.onImageSelected,buttonStates:u,isBottomOfEditor:o,isLightWeightContentStyle:r,onRulesButtonClick:a,stickyButtonInfo:s,overflowMenu:l})}}]),n}(D.a.Component);function Ke(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=g()(e);if(t){var o=g()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return p()(this,n)}}We.defaultProps={isBottomOfEditor:!1,isLightWeightContentStyle:!1},We.displayName="QTextEditorToolbar";var Je=function(){return null},Ye=function(e,t){var n=Object(k.a)("DefaultContentBidiDirectionIsRTL",!1)?"RTL":"LTR",i={enableSmartQuotes:Object(k.a)("SmartQuotesEnabled",!0),defaultDirection:n,tabbedEditorToolbar:Object(O.g)(),imageRemoveButtonEnabled:!1,qtext_hyperlink_embed:!1,hyperlinkEmbedCanConvertToTextLink:!0,lightWeightContentToolbar:!1,markdownExtensionsEnabled:!0,eagerImageUploading:!1,h1ButtonEnabled:!1,shiftReturnHard:!1,placeholder:e,deleteVideoButton:Object(y.plaintextTranslate)("Delete"),deleteVideoMessage:Object(y.plaintextTranslate)("Video will be deleted"),deleteVideoTitle:Object(y.plaintextTranslate)("Are you sure you want to delete your video?"),doneUploadingTitle:Object(y.plaintextTranslate)("Uploaded"),pauseUploadingButton:Object(y.plaintextTranslate)("Pause"),pauseUploadingTitle:Object(y.plaintextTranslate)("Uploading"),resumeUploadingButton:Object(y.plaintextTranslate)("Resume Uploading"),resumeUploadingTitle:Object(y.plaintextTranslate)("Upload Paused"),retryUploadingButton:Object(y.plaintextTranslate)("Retry"),uploadErrorTitle:Object(y.plaintextTranslate)(S.a),videoNotPresent:Object(y.plaintextTranslate)("Your video is on a different device"),videoEnabled:!1,videoEditorSupported:!1,deleteVideoSvg:"",playVideoSvg:"",uploadErrorSvg:"",uploadingSvg:"",videoIndicatorSvg:"",videoNotPresentSvg:""};return Object.assign(i,t)},Ge=function(){return{sendMessage:w.a,logJsError:T.logJsError,makeRpc:I.a,getFormkey:_.getFormkey,sendLog:function(){}}},Xe=function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:Object(U.h)(),t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"",n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};return new B.Doc(e,Object(C.a)(),Ye(t,n),Ge())},Ze=function(e){h()(n,e);var t=Ke(n);function n(e){var i,r,s;a()(this,n),(s=t.call(this,e)).docRef=void 0,s.toolbarRef=void 0,s.uploaderRef=void 0,s.linkSelectorRef=void 0,s.hyperlinkEmbedManagerRef=void 0,s.uploadRetryManagerRef=void 0,s._isMounted=!1,s._initialContent=void 0,s._isToolbarReady=!1,s.debouncedSaveStateToApp=void 0,s.photoPermissionMessageHandler=void 0,s.handleQtextNativeRestoreState=function(e){null!==e&&void 0!==e&&e.state&&s.restoreState(null===e||void 0===e?void 0:e.state)},s.handleQtextNativeFocus=function(){s.props.focusOnLoad&&s.focusEditor()},s.docRef=D.a.createRef(),s.toolbarRef=D.a.createRef(),s.uploaderRef=D.a.createRef(),s.linkSelectorRef=D.a.createRef(),s.hyperlinkEmbedManagerRef=D.a.createRef(),s.uploadRetryManagerRef=D.a.createRef(),s.handleMeaningfulChange=s.handleMeaningfulChange.bind(d()(s)),s.handleKeyDown=s.handleKeyDown.bind(d()(s)),s.handleKeyDownEvent=s.handleKeyDownEvent.bind(d()(s)),s.handlePaste=s.handlePaste.bind(d()(s)),s.handleFocus=s.handleFocus.bind(d()(s)),s.handleBlur=s.handleBlur.bind(d()(s)),s.state={doc:Xe(e.content,e.placeholder,e.settingOverrides),visible:!0},s._initialContent=null===(i=s.state.doc)||void 0===i?void 0:i.toJSON(),delete s._initialContent.caret;var l,c=[].concat(o()(Object(k.c)("DisabledEditorCommands",[])),o()(null!==(r=e.commandsToDisable)&&void 0!==r?r:[]));c.length>0&&(null===(l=s.state.doc)||void 0===l||l.disableCommands(c));return s.debouncedSaveStateToApp=R()((function(){Object(w.a)("saveState",{key:s.props.editorKey,value:s.save()})}),750,{maxWait:1e4,trailing:!0}),s}return l()(n,[{key:"clear",value:function(){this.state.doc&&this.state.doc.clear()}},{key:"handleKeyDown",value:function(e){this.props.onKeyDown&&this._isMounted&&this.props.onKeyDown(e)}},{key:"handleKeyDownEvent",value:function(e){this.props.onKeyDownEvent&&this._isMounted&&this.props.onKeyDownEvent(e)}},{key:"handlePaste",value:function(e){this.props.onPaste&&this._isMounted&&this.props.onPaste(e)}},{key:"handleFocus",value:function(){this.props.onFocus&&this._isMounted&&this.props.onFocus()}},{key:"handleBlur",value:function(){this.props.onBlur&&this._isMounted&&this.props.onBlur()}},{key:"focusEditor",value:function(){var e,t;Object(O.a)()&&Object(w.a)("showKeyboard"),null===(e=this.state.doc)||void 0===e||null===(t=e.node)||void 0===t||t.focus()}},{key:"setupEditor",value:function(){var e=this.docRef.current,t=this.linkSelectorRef.current,n=this.toolbarRef.current,i=this.state.doc;i&&(i.setLinkSelector(t),i.setImageUploader(this.uploaderRef.current),i.setHyperlinkEmbedManager(this.hyperlinkEmbedManagerRef.current),i.setUploadRetryManager(this.uploadRetryManagerRef.current),i.setSendMessageFn(w.a),i.on("meaningfulChange",this.handleMeaningfulChange),i.on("keydown",this.handleKeyDown),i.on("keydownEvent",this.handleKeyDownEvent),i.on("focus",this.handleFocus),i.on("blur",this.handleBlur),i.on("paste_event",this.handlePaste)),n&&(t.setEditorToolbar(n),this._isToolbarReady=!0),i&&i.node&&(t.setDocNode(i.node,i),e.appendChild(i.node),this.props.focusOnLoad&&(this.focusEditor(),this.moveCaretToEnd(i.node))),this.state.doc||this.setState({doc:i}),Object(O.g)()&&this.props.editorKey&&(Object(_.registerMessageHandler)("qtextNativeRestoreState",this.handleQtextNativeRestoreState),Object(w.a)("restoreState",{key:this.props.editorKey})),Object(_.registerMessageHandler)("qtextNativeFocus",this.handleQtextNativeFocus),this._isMounted=!0}},{key:"UNSAFE_componentWillMount",value:function(){Object(O.g)()&&this.props.sendSetupEditorToNative&&Object(w.a)("setupEditor",{})}},{key:"componentDidMount",value:function(){this.setupEditor(),this.props.onEditorSetup&&this.state.doc&&this.props.onEditorSetup(this.state.doc),Object(O.c)()&&Object(F.b)()&&Object(w.a)("setPageAction",{visible:!1})}},{key:"componentDidUpdate",value:function(e,t){var n=this.props.settingOverrides.lightWeightContentToolbar;Object(O.b)()&&n&&!this._isToolbarReady&&(document.getElementById("modal_footer_portal_container")&&(this.linkSelectorRef.current.setEditorToolbar(this.toolbarRef.current),this._isToolbarReady=!0));e.shouldFocusDoc!==this.props.shouldFocusDoc&&this.props.shouldFocusDoc&&this.state.doc&&this.focusEditor(),t.visible!==this.state.visible&&this.state.visible&&this.state.doc&&this.focusEditor()}},{key:"componentWillUnmount",value:function(){this.state.doc&&(this.state.doc.destroy(),this.setState({doc:null})),Object(_.removeMessageHandler)("qtextNativeRestoreState",this.handleQtextNativeRestoreState),Object(_.removeMessageHandler)("qtextNativeFocus",this.handleQtextNativeFocus),Object(O.g)()&&this.photoPermissionMessageHandler!==undefined&&Object(_.removeMessageHandler)("imageButtonTapped",this.photoPermissionMessageHandler),this._isMounted=!1}},{key:"handleMeaningfulChange",value:function(){this.props.onMeaningfulChange&&this._isMounted&&this.state.doc&&this.props.onMeaningfulChange(this.state.doc),Object(O.g)()&&this.props.editorKey&&this.debouncedSaveStateToApp()}},{key:"save",value:function(){var e=!(arguments.length>0&&arguments[0]!==undefined)||arguments[0],t=this.state.doc?this.state.doc.toJSON():{};return e&&delete t.caret,t}},{key:"clearState",value:function(){Object(O.g)()&&this.props.editorKey&&Object(w.a)("saveState",{key:this.props.editorKey,value:{}})}},{key:"handleAddImages",value:function(e){var t=arguments.length>1&&arguments[1]!==undefined&&arguments[1];this.state.doc&&this.state.doc.insertImages(e,{source:"upload"},t)}},{key:"restoreState",value:function(e){var t;null===(t=this.state.doc)||void 0===t||t.fromJSON(e);var n=this.toolbarRef.current;n&&n.refreshButtonStates()}},{key:"isDirty",value:function(){if(this.state.doc){var e=this.state.doc.toJSON();return delete e.caret,!L()(e,this._initialContent)}return!1}},{key:"moveCaretToEnd",value:function(e){if(document.createRange&&window.getSelection){var t=document.createRange();t.selectNodeContents(e);var n=window.getSelection();n&&(n.removeAllRanges(),n.addRange(t),n.rangeCount&&n.collapseToEnd())}}},{key:"renderBottomToolbar",value:function(){var e,t,n,i,o,r=this,a=this.props.settingOverrides.lightWeightContentToolbar,s=D.a.createElement(We,{doc:this.state.doc,ref:this.toolbarRef,imageUploaderRef:this.uploaderRef,onImageUpload:function(e){r.handleAddImages(e,!1)},isBottomOfEditor:!0,isLightWeightContentStyle:a,onRulesButtonClick:this.props.onRulesButtonClick,stickyButtonInfo:this.props.stickyButtonInfo,overflowMenu:this.props.toolbarOverflowMenu}),l={zIndex:"footer",bottom:(null===(e=this.props.toolbarStyleOverrides)||void 0===e?void 0:e.bottom)||0,bg:(null===(t=this.props.toolbarStyleOverrides)||void 0===t?void 0:t.bg)||"white",left:(null===(n=this.props.toolbarStyleOverrides)||void 0===n?void 0:n.left)||0,right:(null===(i=this.props.toolbarStyleOverrides)||void 0===i?void 0:i.right)||0};if(Object(O.b)()){var c=document.getElementById("modal_footer_portal_container");if(a)return c?j.a.createPortal(D.a.createElement(E.q,Object.assign({},l,{ml:"-20px"}),s),c):null;o=E.r}else o=E.i;return D.a.createElement(o,l,s)}},{key:"renderPhotoPermissionModal",value:function(){var e=this;return D.a.createElement(b,null,(function(t){return e.photoPermissionMessageHandler||(e.photoPermissionMessageHandler=function(e){var n;return t(null!==(n=null===e||void 0===e?void 0:e.photoAuthorizationStatus)&&void 0!==n?n:0)},Object(_.registerMessageHandler)("imageButtonTapped",e.photoPermissionMessageHandler)),null}))}},{key:"render",value:function(){var e,t=this,n=Object(O.b)()&&this.props.toolbarOnWeb||Object(O.e)()&&this.props.toolbarOnMobile,i=this.props.isToolbarBottom,o=this.props.editorPaddingReset,r=this.props.settingOverrides.lightWeightContentToolbar,a={};Object(O.f)()&&r&&(a.pt="medium");var s="editor_inner";o&&(s+=" editor_padding_reset");var l=null===(e=this.state.doc)||void 0===e?void 0:e.toJSON(),c=Object(q.e)(l,ce.a);return D.a.createElement(y.BidiDirectionContext.Consumer,null,(function(e){var l,d,u=e===y.BidiDirection.RTL?"u-layout-direction--rtl":"u-layout-direction--ltr";return D.a.createElement(E.e,Object.assign({className:"editor_wrapper ".concat(u),whiteSpace:"pre-wrap",style:{outline:"none",MozTabSize:4,OTabSize:4,tabSize:4},onMouseMove:function(){t.state.doc&&window.setTimeout(t.state.doc.updateCaret.bind(t.state.doc),0)}},Object(O.b)()&&t.props.isInline?{maxHeight:"70vh",overflowY:"auto"}:{}),n&&!i?D.a.createElement(E.r,{top:0,bg:(null===(l=t.props.toolbarStyleOverrides)||void 0===l?void 0:l.bg)||"white",zIndex:"qtext_overlay"},D.a.createElement(D.a.Fragment,null,D.a.createElement(We,{doc:t.state.doc,ref:t.toolbarRef,imageUploaderRef:t.uploaderRef,onImageUpload:function(e){t.handleAddImages(e,!1),t.focusEditor()},isLightWeightContentStyle:r,onRulesButtonClick:t.props.onRulesButtonClick,stickyButtonInfo:t.props.stickyButtonInfo}))):null,D.a.createElement(E.e,Object.assign({className:s},a),D.a.createElement(E.q,{onDragEnter:function(e){var n,i,o=(null===e||void 0===e||null===(n=e.dataTransfer)||void 0===n?void 0:n.items)&&Array.from(e.dataTransfer.items).some((function(e){return e.type.includes("image")})),r=null===e||void 0===e||null===(i=e.dataTransfer)||void 0===i?void 0:i.types.includes("Files"),a=Object(C.a)().isSafari?r:o;t.uploaderRef.current&&a&&t.uploaderRef.current.showDropZone()}},D.a.createElement(E.e,{innerRef:t.docRef,p:o?undefined:"medium"}),D.a.createElement(se,{ref:t.uploaderRef,onAddImages:function(e,n){t.handleAddImages(e,n),t.focusEditor()},doc:null!==(d=t.state.doc)&&void 0!==d?d:undefined,onImageUploadStatusChange:t.props.onImageUploadStatusChange,useEagerImageUploading:t.props.settingOverrides.eagerImageUploading,isCompactEditor:t.props.isCompactEditor}),D.a.createElement(x.a,null,(function(e){var n=e.openStandaloneModal;return D.a.createElement(le.a,{ref:t.linkSelectorRef,openModal:n,renderMenuAtRoot:t.props.isInline,contentContext:t.props.contentContext,onOpen:function(){t.state.doc&&t.state.doc&&Object(O.b)()&&t.state.doc.node.setAttribute("data-placeholder",""),t.setState({visible:!1})},onClose:function(){t.state.doc&&t.state.doc&&Object(O.b)()&&t.state.doc.node.setAttribute("data-placeholder",t.props.placeholder),t.setState({visible:!0})}})}))),D.a.createElement(Je,null),D.a.createElement(W,{ref:t.hyperlinkEmbedManagerRef,showInlineQuoraEmbed:c}),D.a.createElement(xe,{ref:t.uploadRetryManagerRef})),t.props.footerSection,n&&i?t.renderBottomToolbar():null,Object(O.g)()&&t.renderPhotoPermissionModal())}))}}]),n}(P.Component);Ze.defaultProps={content:undefined,editorKey:"",placeholder:"",toolbarOnWeb:!0,toolbarOnMobile:!0,focusOnLoad:!0,isToolbarBottom:!1,isInline:!1,editorPaddingReset:!1,commandsToDisable:[],settingOverrides:{},isCompactEditor:!1}},hgQt:function(e,t,n){var i=n("Juji"),o=n("4sDh");e.exports=function(e,t){return null!=e&&o(e,t,i)}},k4Da:function(e,t,n){var i=n("LXxW"),o=n("n3Sm"),r=n("ut/Y"),a=n("Z0cm");e.exports=function(e,t){return(a(e)?i:o)(e,r(t,3))}},"lm/5":function(e,t,n){var i=n("fmRc"),o=n("wF/u");e.exports=function(e,t,n,r){var a=n.length,s=a,l=!r;if(null==e)return!s;for(e=Object(e);a--;){var c=n[a];if(l&&c[2]?c[1]!==e[c[0]]:!(c[0]in e))return!1}for(;++a<s;){var d=(c=n[a])[0],u=e[d],h=c[1];if(l&&c[2]){if(u===undefined&&!(d in e))return!1}else{var f=new i;if(r)var p=r(u,h,d,e,t,f);if(!(p===undefined?o(h,u,3,r,f):p))return!1}}return!0}},mwIZ:function(e,t,n){var i=n("ZWtO");e.exports=function(e,t,n){var o=null==e?undefined:i(e,t);return o===undefined?n:o}},n3Sm:function(e,t,n){var i=n("SKAX");e.exports=function(e,t){var n=[];return i(e,(function(e,i,o){t(e,i,o)&&n.push(e)})),n}},nBPW:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n("q1tI"),o=n.n(i).a.createContext({renderAtRoot:undefined});o.displayName="PopperDisplayContext"},odos:function(e,t){var n,i;n=this,i=function(){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=31)}([function(e,t){var n={isIOS:!1,isMobile:!1,isIPad:!1,isMSEdge:!1,isMSIE:!1,isGecko:!1,isWebkit:!1,isFirefox:!1,webkitVersion:0,isIOSApp:!1,isAndroid:!1,isAndroidApp:!1,isNativeApp:!1,isUIWebView:!1,isIOSMobileWeb:!1,buildNumber:0,osVersion:0,debug:!1},i={deleteVideoButton:"Delete",deleteVideoMessage:"Video will be deleted",deleteVideoSvg:"",deleteVideoTitle:"Are you sure you want to delete your video?",doneUploadingTitle:"Uploaded",pauseUploadingButton:"Pause",pauseUploadingTitle:"Uploading",playVideoSvg:"",resumeUploadingButton:"Resume Uploading",resumeUploadingTitle:"Upload Paused",retryUploadingButton:"Retry",uploadErrorSvg:"",uploadErrorTitle:"Something went wrong",uploadingSvg:"",videoIndicatorSvg:"",videoNotPresent:"Your video is on a different device",videoNotPresentSvg:"Paste From Clipboard",videoEnabled:!1,videoEditorSupported:!1,tabbedEditorToolbar:!1,minHeight:null,enableSmartQuotes:!1,defaultDirection:"LTR",qtext_hyperlink_embed:!1,hyperlinkEmbedCanConvertToTextLink:!1,imageRemoveButtonEnabled:!1,lightWeightContentToolbar:!1,markdownExtensionsEnabled:!1,isDarkModeOn:!1,eagerImageUploading:!1,h1ButtonEnabled:!1,shiftReturnHard:!1,placeholder:""},o=function(){},r={sendMessage:o,sendLog:o,logJsError:o,makeRpc:function(){return new Promise(o,o)},getFormkey:o};window.hasOwnProperty("scrollTo")||(window.scrollTo=function(){}),t.config={clientInfo:Object.assign({},n),options:Object.assign({},i),platform:Object.assign({},r),setClientInfo:function(e){this.clientInfo=Object.assign({},n,e)},setOptions:function(e){this.options=Object.assign({},i,e)},setPlatformFunctions:function(e){this.platform=Object.assign({},r,e)},setSendMessageFn:function(e){e&&"function"===typeof e&&(this.platform.sendMessage=e)},setLogJsErrorFn:function(e){e&&"function"===typeof e&&(this.platform.logJsError=e)},setRpcFn:function(e){e&&"function"===typeof e&&(this.platform.makeRpc=e)},setGetFormkeyFn:function(e){e&&"function"===typeof e&&(this.platform.getFormkey=e)},_docId:1,_lastActiveDocId:null,_cache:{},getDocId:function(){var e=this._docId;return this._docId+=1,e},cacheConfig:function(e){this._lastActiveDocId=e._id,this._cache[e._id]={clientInfo:Object.assign({},this.clientInfo),options:Object.assign({},this.options),platform:Object.assign({},this.platform)}},restoreConfig:function(e){var t=this._cache[e._id];this._lastActiveDocId!==e._id&&t&&(this.setClientInfo(t.clientInfo),this.setOptions(t.options),this.setPlatformFunctions(t.platform))}}},function(e,t,n){var i=n(22).isValidEmail,o=["keydown","keyup","keypress"],r=n(32),a=/^https?\:\/\//,s=n(10),l={},c={assert:function(e){if(!e){var t=Array.prototype.slice.call(arguments,1);throw new Error(t)}},create:function(e){return document.createElement(e)},objectIntersection:function(e,t){for(var n=Object.keys(e),i={},o=0;o<n.length;o++){var r=n[o];s.jsonEqual(e[r],t[r])&&(i[r]=e[r])}return i},removeNullValues:function(e){for(var t,n=Object.keys(e),i=0;i<n.length;i++)if(null===e[t=n[i]])delete e[t];else if("[object Object]"===Object.prototype.toString.call(e[t]))c.removeNullValues(e[t]);else if("[object Array]"===Object.prototype.toString.call(e[t]))for(var o=0;o<e[t].length;o++)c.removeNullValues(e[t][o]);return e},getData:function(e,t){return e.getAttribute("data-"+t)},setData:function(e,t,n){e.setAttribute("data-"+t,n)},removeData:function(e,t){e.removeAttribute("data-"+t)},isTextNode:function(e){return e&&3==e.nodeType},safeRemoveChild:function(e,t){e&&e.parentNode&&e.parentNode==t&&t.removeChild(e)},on:function(e,t,n){(e=e instanceof Array?e:[e]).forEach((function(e){t&&t.addEventListener(e,(function(t){var i;return-1!=o.indexOf(e)&&(t.which=t.charCode!==undefined?t.charCode:t.keyCode),!1===(i=n(t,e))&&(t.preventDefault(),t.stopPropagation()),i}))}))},ensureProtocol:function(e){return i(e)||a.test(e)||(e="http://"+e),e},isValidUrl:function(e){var t=c.linkify(e);return 1===t.length&&t[0].href},splitLines:function(e){return e.split(/\n|\r\n?/)},splitByRegex:function(e,t){for(var n,i=[];e;)(n=e.match(t))?(n.index&&i.push({text:e.slice(0,n.index)}),i.push({text:n[0],match:n}),e=e.slice(n.index+n[0].length)):(i.push({text:e}),e="");return i},linkify:function(e){var t=[];return r.linkify(e,{callback:function(e,n){0!==e.length&&t.push({text:e,href:n})}}),t},firstScrollingParent:s.firstScrollingParent,closestRelativeAncestor:s.closestRelativeAncestor,getContainerOffset:function(e,t){var n=c.getOffset(e),i=t||c.firstScrollingParent(e);if(i!==document.body){var o=c.getOffset(i);n.left+=i.scrollLeft-o.left,n.top+=i.scrollTop-o.top}return n},getOffset:function(e){var t=e?e.getBoundingClientRect():{top:0,left:0};return{top:t.top+document.body.scrollTop,left:t.left+document.body.scrollLeft}},getSize:function(e){var t=e.getBoundingClientRect();return{height:t.height,width:t.width}},setPixelVal:function(e,t,n){e&&t&&!isNaN(n)&&(e.style[t]=n+"px")},isAstralSymbol:function(e){return/[\uD800-\uDBFF][\uDC00-\uDFFF]/.test(e)},createPlainIframe:function(e){var t=document.createElement("iframe"),n=["<html>","<head>","<style>html, body {margin: 0; padding 0;}</style>","</head>","<body>",e.outerHTML,"</body>","</html>"];return t.srcdoc=n.join(""),t},h:function(e,t){for(var n,i=new Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];n=null===e?document.createDocumentFragment():document.createElement(e),Object.keys(t||{}).forEach((function(e){n.setAttribute(e,t[e])}));for(var r=0;r<i.length;r++){var a=i[r];a&&(Array.isArray(a)&&(a=c.h.apply(null,[null,null].concat(a))),"string"==typeof a&&(a=document.createTextNode(a)),n.appendChild(a))}return n},loadCss:function(e,t){if(!l.hasOwnProperty(e)){var n=document.createElement("style");n.type="text/css",n.setAttribute("data-id",e),n.innerText=t,l[e]=n,(document.querySelector("head")||document.querySelector("body")).appendChild(n)}},removeSectionFromDoc:function(e,t){e.saveState();var i=t.previousSibling();return i||(i=new(0,n(3).PlainSection),e.insertBefore(i,t)),e.removeChild(t),e.moveCaret(i.last()),e.updateCaret(),e.caret.updateAndroidCaretPosition(),e.isOnlyWhiteSpace()&&(e.clear(),e.focus()),!0}};t.Util=c},function(e,t,n){var i=n(7).Class,o=n(8).Span,r=n(11).canForceModifier,a=t.Command=i.extend({__init__:function(e){this.doc=e},exec:function(e){throw new Error("Sub-classes should implement this method.")},shouldExec:function(e){return!0},run:function(e){return!this.shouldExec(e)||this.exec.apply(this,arguments)}});t.spanModifierToggle=function(e){return a.extend({exec:function(){return this.doc.saveState(),this.doc.toggleModifier(e)},shouldExec:function(){var t;if(this.doc.caret.isCollapsed()){var n=new o(this.doc.caret.end.span.getText(),this.doc.formattingState._modifiers);n.parent=this.doc.caret.end.span.parent,t=[n]}else t=this.doc.caret.getCoveringSpans();return t.some((function(t){return t.hasModifier(e)||r(t,e)}))}})},t.sectionTypeToggle=function(e){return a.extend({exec:function(){return this.doc.saveState(),this.doc.toggleSectionType(e)}})}},function(e,t,n){var i=n(6).Section,o=n(26),r=i.extend({init:function(e,t,n,i){this._super("plain",e,t,n,i)},htmlIndentPrefix:"",htmlIndentSuffix:"",htmlPrefix:"<p>",htmlSuffix:"</p>",determineDirection:function(){var e=this.firstChild();return e&&!e.isEmpty()?o.resolveBlockDir(e.getText(),this._super()):this._super()}});t.PlainSection=r},function(e,t,n){var i=n(7).Class.extend({__init__:function(e,t){this.span=e,this.offset=t},toJSON:function(){var e=this.span.parent;return{spanIdx:e.children.indexOf(this.span),sectionIdx:e.parent.children.indexOf(e),offset:this.offset}},clone:function(){return new i(this.span,this.offset)},atSpanStart:function(){return 0===this.offset},atSpanEnd:function(){return this.offset==this.span.getLength()},atSectionStart:function(){var e=this.span.parent;return this.atSpanStart()&&this.span==e.firstChild()},atSectionEnd:function(){var e=this.span.parent;return this.atSpanEnd()&&this.span==e.lastChild()},atDocStart:function(){var e=this.span.parent,t=e.parent;return this.atSectionStart()&&e==t.firstChild()},atDocEnd:function(){var e=this.span.parent,t=e.parent;return this.atSectionEnd()&&e==t.lastChild()},equals:function(e){return e.span===this.span&&e.offset===this.offset},charBefore:function(){return this.atSectionStart()?null:this.prevPositionInSection().charAfter()},hasCharBefore:function(){var e=this.charBefore();return!!e&&0!==e.trim().length},charAfter:function(){if(this.atSectionEnd())return null;var e=this.span,t=this.offset;return this.atSpanEnd()&&(e=e.nextSibling(),t=0),e.getText()[t]},hasCharAfter:function(){var e=this.charAfter();return!!e&&0!==e.trim().length},previousWordBoundary:function(e){e=e||/\W/;var t=this.span,n=this.offset-1,o=t.getText();if(this.atDocStart())return this;if(this.atSectionStart())return t.previous().last();for(;t;){for(;n>0;){if(o[n-1].match(e))return new i(t,n);n--}(t=t.previousSibling())&&(n=(o=t.getText()).length)}return this.span.parent.first()},nextWordBoundary:function(e){e=e||/\W/;var t=this.span,n=this.offset+1,o=t.getText();if(this.atDocEnd())return this;if(this.atSectionEnd())return t.next().first();for(;t;){for(;n<o.length;){if(o[n].match(e))return new i(t,n);n++}(t=t.nextSibling())&&(o=t.getText(),n=0)}return this.span.parent.last()},relativePositionInSection:function(e){if(0===e)return this;var t=this.span,n=this.offset,o=t.getLength(),r=t.previousSibling(),a=t.nextSibling(),s=e+n;return 0<=s&&s<=o?new i(t,s):s<0&&r?r.last().relativePositionInSection(e+n):s>o&&a?a.first().relativePositionInSection(e-(o-n)):null},prevPositionInSection:function(e){return e=e||1,this.relativePositionInSection(-1*e)},nextPositionInSection:function(e){return this.relativePositionInSection(e||1)},alternatePosition:function(){if(this.atSpanStart()){var e=this.span.previousSibling();if(e)return e.last()}else if(this.atSpanEnd()){var t=this.span.nextSibling();if(t)return t.first()}return this}});t.Position=i},function(e,t){t.CONTENT_TYPES={TEXT:"text/plain",HTML:"text/html",PUBLIC_HTML:"public.html",TEXT_URI:"text/uri-list"},t.FRACTIONS={"\u2150":[1,7],"\u2151":[1,9],"\u2152":[1,10],"\u2153":[1,3],"\u2154":[2,3],"\u2155":[1,5],"\u2156":[2,5],"\u2157":[3,5],"\u2158":[4,5],"\u2159":[1,6],"\u215a":[5,6],"\u215b":[1,8],"\u215c":[3,8],"\u215d":[5,8],"\u215e":[7,8]},t.ELLIPSIS="\u2026",t.OPEN_SINGLE_QUOTE="\u2018",t.CLOSE_SINGLE_QUOTE="\u2019",t.OPEN_DOUBLE_QUOTE="\u201c",t.CLOSE_DOUBLE_QUOTE="\u201d",t.SINGLE_PRIME="\u2032",t.DOUBLE_PRIME="\u2033",t.EN_DASH="\u2013",t.EM_DASH="\u2014",t.LEFT_ARROW="\u2190",t.RIGHT_ARROW="\u2192",t.WORD_START_REGEX=/\s|[({[]/,t.ENTER_KEY=13},function(e,t,n){var i=n(23).Container,o=n(5).CONTENT_TYPES,r=n(11),a=n(8).Span,s=n(4).Position,l=n(28).tweetsEnabled,c=n(24).hyperlinkEmbedsEnabled,d=n(1).Util,u=n(18),h=function(){var e={};e.plain=n(3).PlainSection,e.code=n(12).CodeSection,e.image=n(14).ImageSection,n(0).config.options.lightWeightContentToolbar&&(e.heading=n(25).H1Section);var t=n(17);e["horizontal-rule"]=t.HorizontalRuleSection;var i=n(13);e["ordered-list"]=i.OrderedListSection,e["unordered-list"]=i.UnorderedListSection;var o=n(15);return e.embed=o.EmbedSection,e["yt-embed"]=o.YouTubeEmbedSection,e.oembedly=o.OEmbedlySection,l()&&(e.tweet=o.TweetSection),c()&&(e.hyperlink_embed=o.HyperlinkEmbedSection),e},f=i.create("section",{init:function(e,t,n,i,o){var r=this;(t=t&&0!==t.length?t:[new a]).slice().forEach((function(e){r.appendChild(e)})),d.setData(this.node,"type",e),o!==undefined?this.setRTL(o):this.resetRTL(),this.setIndent(n||0),this.setQuoted(i)},getType:function(){return d.getData(this.node,"type")},getLength:function(){var e=0;return this.children.forEach((function(t){e+=t.getLength()})),e},getIndent:function(){return parseInt(d.getData(this.node,"indent"))},setIndent:function(e){return e=Math.min(this.maxIndent(),Math.max(0,e)),d.setData(this.node,"indent",e),0!==this.maxIndent()},getDirection:function(){var e=d.getData(this.node,"dir");return e||(e=this.determineDirection(),d.setData(this.node,"dir",e),d.setData(this.node,"dir-confirmed",this.getLength()>0)),e},isRTL:function(){return"RTL"==this.getDirection()},isDirectionConfirmed:function(){return"true"===d.getData(this.node,"dir-confirmed")},setRTL:function(e){if(null!=e){var t=e?"RTL":"LTR";d.setData(this.node,"dir",t),d.setData(this.node,"dir-confirmed",!0)}},resetRTL:function(){var e=this.determineDirection();e&&"NEUTRAL"!==e&&d.setData(this.node,"dir",e),d.setData(this.node,"dir-confirmed",!this.isEmpty())},setQuoted:function(e){e?d.setData(this.node,"quoted","true"):d.removeData(this.node,"quoted")},isQuoted:function(){return!!d.getData(this.node,"quoted")},isEditable:function(){return!this.children.some((function(e){return!e.isEditable()}))},hasSectionRemoveButton:function(){return!this.isEditable()&&this.children.some((function(e){return e._content.className.includes("section_content_container")}))},allowsMultipleSoftReturns:function(){return!1},allowedModifiers:function(){return r.editableSet()},toContent:function(e,t){var n=[];return n.push(this.getContentPrefix(e,t)),n.push(this.getChildrenContents(e)),n.push(this.getContentSuffix(e,t)),n=n.join("")},getChildrenContents:function(e){return this.children.map((function(t){return t.toContent(e)})).join("")},determineDirection:function(){return u.getGlobalDir()},toJSON:function(e){var t={type:this.getType(),indent:this.getIndent(),quoted:this.isQuoted(),is_rtl:this.isRTL(),spans:[]};return this.children.forEach((function(n){t.spans.push(n.toJSON(e))})),t},first:function(){return this.firstChild().first()},last:function(){return this.lastChild().last()},getText:function(){var e="";return this.children.forEach((function(t){e+=t.getText()})),e},deleteText:function(e,t){if(e.span==t.span)e.span.deleteText(e.offset,t.offset);else{for(e.span.deleteText(e.offset,e.span.getLength());e.span.nextSibling()!=t.span;)this.removeChild(e.span.nextSibling());t.span&&t.span.deleteText(0,t.offset)}t.span.isEmpty()&&this.children.length>1&&this.removeChild(t.span),e.span.isEmpty()&&this.children.length>1&&this.removeChild(e.span),1==this.children.length&&this.firstChild()==e.span&&e.span.isEmpty()&&e.span.removeAllModifiers()},replaceText:function(e,t,n){if(""===n)return this.deleteText(e,t);var i=e.span.getText(),o=i.substr(0,e.offset)+n;e.span==t.span?o+=i.substr(t.offset):this.deleteText(e.span.nextSibling().first(),t),e.span.setText(o)},isEmpty:function(){return 1==this.children.length&&this.children[0].isEmpty()},isOnlyWhiteSpace:function(){return this.children.every((function(e){return e.isOnlyWhiteSpace()}))},isOneLineOnly:function(){return!1},_createSplitSection:function(e){return this.isOneLineOnly()?new(0,h().plain)(e,this.getIndent(),this.isQuoted(),this.isRTL()):new this.constructor(e,this.getIndent(),this.isQuoted(),this.isRTL())},split:function(e){var t,n,i,o,r=e.span,s=e.offset;return 0===s?(r==this.firstChild()&&this.insertBefore(new a,r),o=r):s===r.getLength()?r==this.lastChild()?(o=new a,this.appendChild(o)):o=r.nextSibling():o=r.split(s,!0),t=this.children.indexOf(o)+1,(i=this.children.slice(t)).unshift(o),n=this._createSplitSection(i),this.parent.insertBefore(n,this.nextSibling()),o.first()},merge:function(e){var t,n,i;if(e.isEditable())if(e.isEmpty())e.parent&&e.parent.removeChild(e),t=this.last();else if(this.isEditable()){for(this.isEmpty()?(this.removeChild(this.firstChild()),this.setIndent(e.getIndent()),this.setQuoted(e.isQuoted()),this.setRTL(e.isRTL()),t=e.first()):t=this.last();e.children.length;)this.appendChild(e.firstChild());for(n=this.firstChild();n;)if((i=n.nextSibling())&&n.hasSameModifiers(i)){var o=n.getLength();n=n.merge(i),i==t.span&&(t=new s(n,o+t.offset))}else n=i;e.parent&&e.parent.removeChild(e)}else this.parent&&this.parent.removeChild(this),t=e.first();else this.isEmpty()&&this.parent&&this.parent.removeChild(this),t=e.first();return t},changeType:function(e){var t=new e(this.children,this.getIndent(),this.isQuoted(),this.isRTL());return t.shouldRemoveChildrenModifiers()&&t.removeAllChildrenModifiers(),this.parent&&(this.parent.insertBefore(t,this),this.parent.removeChild(this)),t},getContentPrefix:function(e,t){return e==o.TEXT?this._getTextPrefix(t):e==o.HTML?this._getHTMLPrefix(t):void 0},getContentSuffix:function(e,t){return e==o.TEXT?this._getTextSuffix(t):e==o.HTML?this._getHTMLSuffix(t):void 0},shouldRemoveChildrenModifiers:function(){return!1},removeAllChildrenModifiers:function(){this.children.forEach((function(e){e.removeAllModifiers()}))},_getTextPrefix:function(){var e,t="";for(e=0;e<4*this.getIndent();e++)t+=" ";return this.isQuoted()&&(t+=">"),t},_getTextSuffix:function(){return"\n"},_getHTMLPrefix:function(e){var t,n="",i=e.indexOf(this),o=this.getIndent(),r=-1;for(i>0?((t=e[i-1])instanceof this.constructor&&(r=t.getIndent()),this.isQuoted()&&!t.isQuoted()&&(n+="<blockquote>")):this.isQuoted()&&(n+="<blockquote>");o>r;)n+=this.htmlIndentPrefix,o--;return n+this.htmlPrefix},_getHTMLSuffix:function(e){var t,n=this.htmlSuffix,i=e.indexOf(this),o=this.getIndent(),r=-1;for(i<e.length-1&&(t=e[i+1])instanceof this.constructor&&(r=t.getIndent());o>r;)o--,n+=this.htmlIndentSuffix;return!this.isQuoted()||t&&t.isQuoted()||(n+="</blockquote>"),n},maxIndent:function(){return 0}});f.fromJSON=function(e){var t=[],n=h()[e.type];return e.spans.forEach((function(e){t.push(new a(e.text,e.modifiers))})),n&&"function"===typeof n?new n(t,e.indent,e.quoted,e.is_rtl):(console.warn("Invalid section type: ".concat(e.type)),null)},t.Section=f},function(e,t){var n=/xyz/.test((function(){xyz}))?/\b_super\b/:/.*/,i=function(){},o={};function r(e,t,n){for(var i in t)t.hasOwnProperty(i)&&(e[i]=n?a(i,t,n):t[i])}function a(e,t,i){var o=t[e],r=i[e];return"function"===typeof o&&"function"===typeof r&&o!==r&&n.test(o)?function(){var t=this._super;this._super=i[e];try{return o.apply(this,arguments)}finally{this._super=t}}:o}function s(e){return function(e,t){var n,a=i.prototype=e.prototype,l=new i;function c(){if(n||(e.call(o),r(l,t,a),n=!0,t=null),this!==o){var i=this.__init__;i&&i.apply(this,arguments)}}return c.prototype=l,c.extend=s,l.constructor=c,c}(this,e)}t.Class=s.call((function(){}),{})},function(e,t,n){var i=n(23).Container,o=n(4).Position,r=n(5).CONTENT_TYPES,a=n(11),s=n(0).config,l=n(10),c=l.extend,d=n(1).Util,u=i.create("span",{init:function(e,t){t=t||{},this.modifiers={},this._content=this.createContentNode(),this.node.appendChild(this._content),this._image=null,this.setText(e);var n=this;l.iterItems(t,(function(e,t){n.setModifier(e,t,!0)}))},createContentNode:function(){var e=d.create("div");return e.className="content",e.qtextSpanContent=!0,e},merge:function(e){if(this.isEditable()&&e.isEditable()&&this.hasSameModifiers(e))return this.setText(this.getText()+e.getText()),e.parent.removeChild(e),this},hasSameModifiers:function(e){var t=this.modifiers,n=e.modifiers,i=Object.getOwnPropertyNames(t),o=Object.getOwnPropertyNames(n);return i.length==o.length&&i.every((function(e){if("link"==e&&n.link){var i=t.link.url;i&&"/"!=i.substr(-1)&&(i+="/");var o=n.link.url;return o&&"/"!=o.substr(-1)&&(o+="/"),i==o}return t[e]==n[e]}))},toJSON:function(e,t,n){var i=c({},this.modifiers);return e||(delete i.iframe,delete i.react_placeholder),{modifiers:i,text:this.getText().slice(t,n)}},previous:function(){return this.previousSibling()||this.parent.previousSibling()&&this.parent.previousSibling().lastChild()},next:function(){return this.nextSibling()||this.parent.nextSibling()&&this.parent.nextSibling().firstChild()},first:function(){return new o(this,0)},last:function(){return new o(this,this.getLength())},updateModifiers:function(e,t){var n,i,o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],this.setModifier(n,e[n],t);this._updateClass()},setModifier:function(e,t,n){if(a.canSetModifier(this,e))this._setModifier(e,t);else if(n&&a.canForceModifier(this,e)){var i=this.modifiers;this.modifiers={},this._setModifier(e,t);var o=this;Object.keys(i).forEach((function(e){o.setModifier(e,i[e])}))}},_setModifier:function(e,t){if(this.modifiers[e]=t||!0,"image"==e){if(this._image||(this._image=d.create("img")),this.modifiers.uploading&&this.modifiers.external_source)return void(this._image.src=t);if(this.setText(""),this._removePlaceholder(),s.clientInfo.isFirefox&&this._image.setAttribute("contenteditable","false"),t!==n(17).horizontalRuleImg){var i=this;this._image.addEventListener("load",(function(){i._addSectionRemoveButton()}))}this._content.appendChild(this._image),this._image.src=t}"upload_failed"===e&&(this._content.className+=" react_upload_failed_container",this._addReactContainerForRetryButton(),this._addReactContainerForRetryBanner()),"iframe"==e&&(this.setText(""),this._removePlaceholder(),this._addSectionRemoveButton(),this._content.appendChild(t)),"underline"==e&&(this._content.style.textDecoration="underline"),"react_placeholder"===e&&(this.setText(""),this._removePlaceholder(),s.options.hyperlinkEmbedCanConvertToTextLink?this._content.className+=" section_content_container":this._addSectionRemoveButton(),this._reactPlaceholder=d.create("div"),this._reactPlaceholder.className="react_placeholder",this._content.setAttribute("contenteditable","false"),this._content.appendChild(this._reactPlaceholder)),this._updateClass()},_addSectionRemoveButton:function(){s.options.imageRemoveButtonEnabled&&(this._removeButton=d.create("div"),this._removeButton.className+="section_remove_btn",this._removeButton.setAttribute("contenteditable","false"),this._content.className+=" section_content_container",this._content.appendChild(this._removeButton))},_addReactContainerForRetryButton:function(){this._retryButton=d.create("div"),this._retryButton.className="react_retry_button_container",this._retryButton.setAttribute("contenteditable","false"),this._content.appendChild(this._retryButton)},_addReactContainerForRetryBanner:function(){this._retryBanner=d.create("div"),this._retryBanner.className="react_upload_failed_message_container",this._retryBanner.setAttribute("contenteditable","false"),this._content.appendChild(this._retryBanner)},isEditable:function(){var e=this;return!a.nonEditableSet().some((function(t){return e.hasModifier(t)}))},hasAnyModifier:function(e){return Object.keys(this.modifiers).some((function(t){return-1!=e.indexOf(t)}))},hasDifferentModifier:function(e){return Object.keys(this.modifiers).some((function(t){return-1==e.indexOf(t)}))},removeAllModifiers:function(){this.modifiers={},this._updateClass()},removeModifier:function(e){delete this.modifiers[e],this._updateClass()},getModifier:function(e){return this.modifiers[e]},getModifiers:function(){return c({},this.modifiers)},hasModifier:function(e){return e in this.modifiers},_updateClass:function(){for(var e in this.node.className="span",this.modifiers)this.modifiers.hasOwnProperty(e)&&this.modifiers[e]&&(this.node.className+=" "+e)},isEmpty:function(){return!!this.isEditable()&&(""===this.node.textContent||""===this.node.innerHTML||"<br>"==this.node.innerHTML)},getText:function(){return this._content.textContent},setText:function(e){this._content.textContent=e,e||this._setPlaceholder()},_removePlaceholder:function(){this._content.textContent=this.getText()},insertText:function(e,t){var n=this.getText();this.setText(n.slice(0,t)+e+n.slice(t))},deleteText:function(e,t){this.setText(this.getText().slice(0,e)+this.getText().slice(t))},getLength:function(){return this.isEditable()?this.getText().length:1},isOnlyWhiteSpace:function(){return!!this.isEditable()&&!this.hasModifier("citation")&&0==this.getText().trim().length},getFocusNode:function(){return d.isTextNode(this._content.firstChild)?this._content.firstChild:this._content},_setPlaceholder:function(){this._content.innerHTML="<br/>"},shouldAvoidSplitting:function(){return this.hasModifier("link")||this.hasModifier("code")||this.hasModifier("math")},split:function(e,t){var n;return!t&&this.shouldAvoidSplitting()?this:(this.isEmpty()?n=new u(null,this.modifiers):0===e?(n=new u(this.getText(),this.modifiers),this.setText("")):(n=new u(this.getText().slice(e),this.modifiers),this.setText(this.getText().slice(0,e))),this.parent.insertBefore(n,this.nextSibling()),n)},_toText:function(){var e;return e=this.getText(),this.hasModifier("math")&&(e="$"+e+"$"),this.hasModifier("italic")&&(e="*"+e+"*"),this.hasModifier("bold")&&(e="**"+e+"**"),this.hasModifier("underline")&&(e="_"+e+"_"),this.hasModifier("link")&&(e+=" ("+this.getModifier("link").url+")"),e},_toHTML:function(){var e;return this.hasModifier("image")?'<img src="'+this.getModifier("image")+'"/>':this.hasModifier("video")?'<video src="'+this.getModifier("video")+'"/>':(e=this.getText(),e=(e=l.escapeHTML(e)).replace(/\n/gi,"<br>"),this.hasModifier("italic")&&(e="<i>"+e+"</i>"),this.hasModifier("bold")&&(e="<b>"+e+"</b>"),this.hasModifier("underline")&&(e="<u>"+e+"</u>"),this.hasModifier("link")&&(e='<a href="'+this.getModifier("link").url+'">'+e+"</a>"),this.hasModifier("code")?e="<code>"+e+"</code>":this.hasModifier("math")&&(e="<math>"+e+"</math>"),e)},toContent:function(e){return e==r.TEXT?this._toText():e==r.HTML?this._toHTML():void 0}});t.Span=u},function(e,t,n){var i=n(7).Class;t.Extension=i.extend({__init__:function(e){this.doc=e},install:function(){throw new Error("Sub-classes should implement this method.")},destroy:function(){}})},function(e,t,n){var i=n(0).config;t.extend=function(e,t){e=e||{};for(var n=1;n<arguments.length;n++)if(arguments[n])for(var i in arguments[n])arguments[n].hasOwnProperty(i)&&(e[i]=arguments[n][i]);return e},t.documentFragmentFromString=function(e){var t=document.createElement("div");t.innerHTML=e;for(var n=document.createDocumentFragment(),i=t.firstChild,o=null;i;)o=i.nextSibling,n.appendChild(i),i=o;return n};var o=t.isPlainObject=function(e){if("[object Object]"!=Object.prototype.toString.call(e))return!1;var t=e.constructor;if("function"!==typeof t)return!1;var n=t.prototype;return"[object Object]"==Object.prototype.toString.call(n)&&!1!==n.hasOwnProperty("isPrototypeOf")},r=t.cloneObject=function(e){if(!Array.isArray(e)&&!o(e))return e;for(var t=e.constructor(),n=Object.keys(e),i=0;i<n.length;i++){var a=n[i];t[a]=r(e[a])}return t};t.firstScrollingParent=function(e){var t=null;for(e&&(t=e.parentNode);t&&t!==document.body;){var n=window.getComputedStyle(t);if(n){var i=n.getPropertyValue("overflow-y");if("scroll"==i||"auto"==i)return t}t=t.parentNode}return document.body},t.closestRelativeAncestor=function(e){var t=null;for(e&&(t=e.parentNode);t&&t!==document.body;){var n=window.getComputedStyle(t);if(n&&"relative"==n.getPropertyValue("position"))return t;t=t.parentNode}return document.body},t.hasAncestor=function(e,t){return!(!e.closest||"function"!==typeof e.closest)&&null!==e.closest(t)},t.makeEnum=function(e){var t={},n=Array.isArray(e);for(var i in e)e.hasOwnProperty(i)&&(t[i=n?e[i]:i]=i);return t};var a=t.once=function(e){var t,n;return function(){return n||(n=!0,t=e.apply(this,arguments)),t}},s=0;t.randomId=function(e){return[e=e||"",s++,Math.floor(4294967296*Math.random())].join("-")},t.uuid4=function(){var e=Date.now();return"undefined"!==typeof window.performance&&"function"===typeof window.performance.now&&(e+=window.performance.now()),"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)}))},t.escapeHTML=function(e){return e=(e=(e=e.replace(/&/g,"&amp;")).replace(/</g,"&lt;")).replace(/>/g,"&gt;")},t.iterItems=function(e,t){if(o(e))for(var n=Object.keys(e),r=0;r<n.length;r++)t.call(null,n[r],e[n[r]]);else i.platform.logJsError("util.iterItems expects a plain object. got "+e)},t.getLocation=function(e){var t=e.match(/^(https?\:)\/\/(([^:\/?#]*)(?:\:([0-9]+))?)([\/]{0,1}[^?#]*)(\?[^#]*|)(#.*|)$/);return t&&{protocol:t[1],host:t[2],hostname:t[3],port:t[4],pathname:t[5],search:t[6],hash:t[7]}};var l=t.jsonEqual=function(e,t){var n,i;if(e===t)return!0;if("object"!=typeof e||"object"!=typeof t)return e===t;if(null===e||e===undefined||null===t||t===undefined)return!1;if(typeof e!==typeof t)return!1;if(e instanceof Array){if(e.length!==t.length)return!1;for(var o=0;o<e.length;o++)if(!l(e[o],t[o]))return!1;return!0}return n=Object.getOwnPropertyNames(e),i=Object.getOwnPropertyNames(t),n.length==i.length&&n.every((function(n){return l(e[n],t[n])}))};t.formatBytes=function(e,t){if(0==e)return"0 Bytes";var n=t<=0?0:t||2,i=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,i)).toFixed(n))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][i]},t.utoa=function(e){return window.btoa(unescape(encodeURIComponent(e)))},t.atou=function(e){return decodeURIComponent(escape(window.atob(e)))},t.isNewTabModifierDown=function(e){var t="MacIntel"===window.navigator.platform;return t&&e.metaKey||!t&&e.ctrlKey},t.isInModal=function(e){return t.hasAncestor(e,".Modal")},t.loadJS=function(e,t){var n=document.createElement("script");n.type="text/javascript",n.async=!0,n.src=e,t&&(n.onload=n.onreadystatechange=a(t));var i=document.getElementsByTagName("script")[0];i.parentNode.insertBefore(n,i)},t.loadJSIntoIFrame=function(e,t,n){var i=t.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,n&&(i.onload=i.onreadystatechange=a(n)),t.head.appendChild(i)}},function(e,t){t.allModifiers=function(){return["bold","italic","underline","link","citation","math","code","image","video","embed","tweet","playable","iframe","external_source","uploading","hyperlink_embed","react_placeholder","upload_failed"]};var n=t.mutuallyExclusiveSet=function(){return["link","citation"]};t.nonEditableSet=function(){return["video","image","embed","tweet","playable","iframe","external_source","uploading","upload_failed","hyperlink_embed","react_placeholder"]},t.editableSet=function(){return["bold","italic","underline","link","citation","math","code"]};var i=t.restrictedSets=function(){return[["image","embed","tweet","video","playable","iframe","external_source","uploading","upload_failed","hyperlink_embed","react_placeholder"],["math"],["code"]]},o=t.canSetModifier=function(e,t){var o=e.parent;return(!o||-1!=o.allowedModifiers().indexOf(t))&&(-1==n().indexOf(t)||!n().some((function(n){return n!=t&&e.hasModifier(n)})))&&!i().some((function(n){return!(-1==n.indexOf(t)||!e.hasDifferentModifier(n))||!(-1!=n.indexOf(t)||!e.hasAnyModifier(n))}))};t.canForceModifier=function(e,t){if(o(e,t))return!0;var r=e.parent;return(!r||-1!=r.allowedModifiers().indexOf(t))&&(-1!=n().indexOf(t)||i().some((function(e){return-1!=e.indexOf(t)})))}},function(e,t,n){var i=n(6).Section,o=n(18),r=i.extend({init:function(e,t,n){this._super("code",e,t,n)},allowedModifiers:function(){return[]},htmlIndentPrefix:"",htmlIndentSuffix:"",htmlPrefix:"<pre>",htmlSuffix:"</pre>",determineDirection:function(){return o.LTR},shouldRemoveChildrenModifiers:function(){return!0}});t.CodeSection=r},function(e,t,n){var i=n(6).Section,o=n(26),r=(t.isListSection=function(e){return e instanceof r},i.extend({allowsMultipleSoftReturns:function(){return!0},maxIndent:function(){return 2},htmlPrefix:"<li>",htmlSuffix:"</li>",determineDirection:function(){var e=this.firstChild();return e&&!e.isEmpty()?o.resolveBlockDir(e.getText()):null}}));t.UnorderedListSection=r.extend({init:function(e,t,n,i){this._super("unordered-list",e,t,n,i)},_getTextPrefix:function(e){return this._super(e)+"* "},htmlIndentPrefix:"<ul>",htmlIndentSuffix:"</ul>"}),t.OrderedListSection=r.extend({init:function(e,t,n,i){this._super("ordered-list",e,t,n,i)},_getTextPrefix:function(e){for(var t,n=this._super(e),i=this.getIndent(),o=e.indexOf(this)-1,r=1;o>=0&&!(i>(t=e[o]).getIndent())&&t instanceof this.constructor;)i==t.getIndent()&&r++,o--;return n+r+". "},htmlIndentPrefix:"<ol>",htmlIndentSuffix:"</ol>"})},function(e,t,n){var i=n(6).Section,o=n(8).Span,r=n(1).Util,a=i.extend({init:function(e,t,n,i,o){r.assert(1==e.length,"ImageSections should have exactly one child:",e),r.assert(e[0].hasModifier("image"),"missing image modifier on image span: ",e[0],e[0].getModifiers()),this._super("image",e,t,n),this.isPending=o||!1,this.isPending&&!this.children[0].getModifier("external_source")&&this.children[0].setModifier("external_source","eager_image_upload")},allowedModifiers:function(){return["image","external_source","uploading","upload_failed"]},toJSON:function(e){return this.isPending?null:this._super(e)},toContent:function(e,t){return this.isPending?null:this._super(e,t)},setUploadSuccess:function(e){this.isPending&&(this.isPending=!1,this.children[0].updateModifiers({image:e}),this.children[0].removeModifier("external_source"),this.children[0].removeModifier("uploading"),this.removeRetryButton())},setUploadFailed:function(){this.children[0].hasModifier("upload_failed")||(this.children[0].setModifier("upload_failed"),this.parent.insertUploadRetryButton(this))},removeRetryButton:function(){this.children[0].hasModifier("upload_failed")&&(this.children[0].removeModifier("upload_failed"),this.reactUnmountCallback&&this.reactUnmountCallback())},registerReactUnmountCallback:function(e){this.reactUnmountCallback=e},removeChild:function(e){this._super(e),this.removeRetryButton()},htmlIndentPrefix:"",htmlIndentSuffix:"",htmlPrefix:"<p>",htmlSuffix:"</p>"});a.fromURL=function(e,t,n){var i={image:e};return t&&(i.external_source=t),new a([new o("",i)],undefined,undefined,undefined,n)},t.ImageSection=a},function(e,t,n){var i=n(8).Span,o=n(6).Section,r=n(11),a=n(3).PlainSection,s=n(1).Util,l=n(5).CONTENT_TYPES,c=n(28),d=n(24).hyperlinkEmbedsEnabled,u=c.tweetsEnabled,h=c.getTweetData,f=n(0).config,p=o.extend({init:function(e,t,n,i,o){s.assert(1==e.length,"EmbedSections should have exactly one child:",e),s.assert(e[0].hasModifier("embed"),"missing embed modifier on embed span"),this._super(this.type,e,t,n),this.clipboardPending=o,this.clipboardPending?e[0].setModifier("react_placeholder"):this.setEmbed()},setEmbed:function(){if(this.showLoadingDots){var e=x();this.children[0]._content.appendChild(e)}var t=this.children[0].getModifier("embed").url;this._setEmbed(t)},acceptClipboardSuggestion:function(){this.clipboardPending&&(this.clipboardPending=!1,this.children[0].removeModifier("react_placeholder"),this.children[0]._content.classList.remove("section_content_container"),this.children[0].setText(""),this._onRemove&&this._onRemove(),this.setEmbed())},toContent:function(e,t){if(this.clipboardPending)return null;var n=this.children[0].getModifier("embed").url;return e==l.TEXT?n:new i(n,{link:{type:"url",url:n}}).toContent(e)},toJSON:function(e){return this.clipboardPending?null:{type:this.getType(),indent:this.getIndent(),quoted:this.isQuoted(),spans:this.children.map((function(t){return e?t.toJSON(e):{modifiers:{embed:t.getModifier("embed")}}}))}},_setEmbed:function(){},allowedModifiers:function(){return r.nonEditableSet()},_onEmbedSectionCallbackError:function(){var e=this.children[0].getModifier("embed").url,t=this.changeType(a);t.children[0].removeModifier("embed"),t.children[0].setText(e),t.parent&&t.parent.linkifySections([t])},setOnRemoveCallback:function(e){this._onRemove=e},removeChild:function(e){this._super(e),this._onRemove&&this._onRemove()}});p.getValidRegex=function(e){var t=[];e._VALID_REGEXES.forEach((function(e){t.push("(?:"+e.source+")")}));var n=t.join("|");return new RegExp(n)},p.fromOtherSection=function(e,t){var n=null;return e.isEditable()?(Object.keys(y()).some((function(o){var r=y()[o],a=!0,l="",c=0,d=p.getValidRegex(r);return e.children.forEach((function(e){if(e.hasModifier("link")){var t=e.getModifier("link").url;t&&t.match(d)?(c+=1,l=e.getModifier("link").url):a=!1}else{var n=e.getText();s.splitByRegex(n,d).forEach((function(e){e.match?(c+=1,l=e.text):e.text.match(/^ *$/)||(a=!1)}))}})),!(1!=c||!a)&&(n=new r([new i("",{embed:{url:l}})],null,null,null,t),!0)})),n):null};var m=p.extend({init:function(){this._super.apply(this,arguments),this.children[0].setModifier("playable")},_onOEmbedCallbackSuccess:function(e,t,n,i,o){var r=this.children[0].getModifier("embed");if(n!==undefined&&null!==n){s.assert(i===undefined||null===i,"If iframe_html is supplied, iframe_url has to be null / undefined.");var a=s.create("div");a.innerHTML=n,i=a.children[0].src}s.assert(null!==i,"For OEmbedSection, we have to have the iframe URL."),r.thumbnail_url=t,r.content_type=e,r.iframe={url:i},r.aspect_ratio=o,this.children[0].setModifier("embed",r),this.children[0].setModifier("image",t)}}).extend({_setEmbed:function(e){var t=this,i=this.children[0].getModifier("embed");i.thumbnail_url&&i.content_type&&i.iframe&&i.iframe.url?t._onOEmbedCallbackSuccess(i.content_type,i.thumbnail_url,null,i.iframe.url,i.aspect_ratio):n(34).getOEmbedlyData(e,(function(e){var n=e&&e.value;n?t._onOEmbedCallbackSuccess(n.type,n.thumbnail_url,n.html,null,n.aspect_ratio):t._onEmbedSectionCallbackError()}))},type:"oembedly"});m._VALID_REGEXES=[/https?:\/\/www.vimeo.com\/groups\/*\/videos\/.*/,/https?:\/\/www.vimeo.com\/.*/,/https?:\/\/vimeo.com\/groups\/.*\/videos\/.*/,/https?:\/\/vimeo.com\/.*/,/https?:\/\/vimeo.com\/m\/#\/.*/,/https?:\/\/player.vimeo.com\/.*/,/http:\/\/www.hulu.com\/watch.*/,/http:\/\/www.hulu.com\/w\/.*/,/http:\/\/www.hulu.com\/embed\/.*/,/http:\/\/hulu.com\/watch.*/,/http:\/\/hulu.com\/w\/.*/,/http:\/\/hulu.tv\/.*/,/http:\/\/www.ustream.tv\/recorded\/.*/,/http:\/\/www.ustream.tv\/channel\/.*/,/http:\/\/www.ustream.tv\/.*/,/http:\/\/ustre.am\/.*/,/http:\/\/link.brightcove.com\/services\/player\/bcpid.*/,/http:\/\/bcove.me\/.*/,/http:\/\/www.vevo.com\/watch\/.*/,/http:\/\/www.vevo.com\/video\/.*/,/http:\/\/video.google.com\/videoplay\?.*/,/https?:\/\/.*.dailymotion.com\/video\/.*/,/https?:\/\/.*.dailymotion.com\/.*\/video\/.*/,/http:\/\/khanacademy.org\/*/,/http:\/\/www.khanacademy.org\/*/,/https:\/\/khanacademy.org\/*/,/https:\/\/www.khanacademy.org\/*/,/https?:\/\/www.ted.com\/talks\/.*.html.*/,/https?:\/\/www.ted.com\/talks\/lang\/.*\/.*.html*/,/https?:\/\/www.ted.com\/index.php\/talks\/.*.html.*/,/https?:\/\/www.ted.com\/index.php\/talks\/lang\/.*\/.*.html/,/https?:\/\/www.ted.com\/talks\/.*/],m._MORE_VALID_REGEXES=[/http:\/\/.*.tiktok.com\/.*/,/http:\/\/tiktok.com\/.*/,/https:\/\/.*.tiktok.com\/.*/,/https:\/\/tiktok.com\/.*/,/http:\/\/www.facebook.com\/photo.php.*/,/http:\/\/www.facebook.com\/video.php.*/,/https:\/\/www.facebook.com\/photo.php.*/,/https:\/\/www.facebook.com\/video.php.*/,/https:\/\/www.facebook.com\/.*\/posts\/.*/,/http:\/\/www.facebook.com\/.*\/posts\/.*/,/http:\/\/fb.me\/.*/,/https:\/\/fb.me\/.*/,/http:\/\/www.facebook.com\/.*\/photos\/.*/,/https:\/\/www.facebook.com\/.*\/photos\/.*/,/http:\/\/www.facebook.com\/.*\/videos\/.*/,/https:\/\/www.facebook.com\/.*\/videos\/.*/,/http:\/\/fb.com/,/https:\/\/www.facebook.com\/events\/.*/,/https:\/\/www.facebook.com\/watch\/.*/,/http:\/\/www.facebook.com\/watch\/.*/];var g=p.extend({init:function(){this._super.apply(this,arguments),this.children[0].setModifier("playable")},_setEmbed:function(e){var t,n;(n=p.getValidRegex(g).exec(e))?t=n[1]:(console.error(new Error("YouTubeEmbedSection: url did not match regex: "+e)),t=""),this.children[0].setModifier("image","https://img.youtube.com/vi/"+t+"/0.jpg")},type:"yt-embed",htmlIndentPrefix:"",htmlIndentSuffix:"",htmlPrefix:"<p>",htmlSuffix:"</p>"});g._VALID_REGEXES=[/(?:https?:\/{2})?(?:w{3}\.)?(?:youtube\.com\/watch.+v=|m\.youtube\.com\/watch.+v=|youtu.be\/|m\.youtube\.com\/|youtube.com\/embed\/)([^\s?&]+)(\?[^\s]+)?(\&[^\s]+)?/];var v=p.extend({_onTweetCallbackSuccess:function(e,t){this.children[0].setModifier("tweet",!0),this.children[0].setModifier("iframe",e),t&&c.renderTweetIFrame(e)},_setEmbed:function(e){var t=this;h(e,(function(e,n){e?t._onTweetCallbackSuccess(e,n):t._onEmbedSectionCallbackError()}),(function(){t._onEmbedSectionCallbackError()}))},type:"tweet",htmlIndentPrefix:"",htmlIndentSuffix:"",htmlPrefix:"<p>",htmlSuffix:"</p>"});v._VALID_REGEXES=[/https:\/\/(.*\.)?twitter.com\/.*\/status\/.*/];var b=p.extend({_setEmbed:function(e){var t=this;f.platform.makeRpc("/hyperlink/get_embed_data_POST",{formkey:f.platform.getFormkey(),json:JSON.stringify({args:[],kwargs:{url:e}})}).then((function(e){if(e){if(t.data=e.value,"image"===t.data.type)return void t._insertImage(t.data.url);t.children[0].setModifier("hyperlink_embed",!0),t.children[0].setModifier("react_placeholder"),t.parent.insertHyperlinkEmbedPreview(t)}else t._onEmbedSectionCallbackError}))["catch"](this._onEmbedSectionCallbackError)},_insertImage:function(e){this.parent.removeChild(this),this.parent.insertAndUploadImageUrl(e,"link")},convertToTextLink:function(){var e=new i(this.data.url),t=new a([e]);t.setRTL(this.isRTL()),this.parent.insertBefore(t,this),this.parent.removeChild(this),this.parent.moveCaret(e.last()),this.parent.trigger("convertToTextLink")},removeEmbed:function(){s.removeSectionFromDoc(this.parent,this)},type:"hyperlink_embed",htmlIndentPrefix:"",htmlIndentSuffix:"",htmlPrefix:"<p>",htmlSuffix:"</p>",showLoadingDots:!0});b._VALID_REGEXES=[/https?:\/\/.*/];var y=function(){var e={};return e["yt-embed"]=g,e.oembedly=m,u()&&(e.tweet=v),d()&&(e.hyperlink_embed=b),e},x=function(){var e=s.create("div");e.className+="loading_dot_container";for(var t=0;t<3;t++){var n=s.create("div");n.className+="loading_dot",0===t?n.className+=" first":1===t&&(n.className+=" second"),e.appendChild(n)}return e};t.EmbedSection=p,t.OEmbedlySection=m,t.YouTubeEmbedSection=g,t.TweetSection=v,t.HyperlinkEmbedSection=b,t.getEmbedSectionTypes=y},function(e,t,n){var i=n(7).Class,o=t.Selection=i.extend({__init__:function(e,t,n){this.start=e,this.end=t,this.doc=n},toJSON:function(){return{start:this.start.toJSON(),end:this.end.toJSON()}},equals:function(e){return this.start.equals(e.start)&&this.end.equals(e.end)},getStartNode:function(){return this.start.span.getFocusNode()},getEndNode:function(){return this.end.span.getFocusNode()},moveStart:function(e){this.start.span=e.span,this.start.offset=e.offset},moveEnd:function(e){this.end.span=e.span,this.end.offset=e.offset},isCollapsed:function(){return this.start.equals(this.end)},charBefore:function(){return this.start.charBefore()},hasCharBefore:function(){return this.start.hasCharBefore()},previousTextUntil:function(e){for(var t=this.start.span,n=this.start.offset,i="";t&&t!=e.span;)i=t.getText().substring(0,n)+i,(t=t.previousSibling())&&(n=t.getLength());return t&&(i=t.getText().substring(e.offset,n)+i),i},hasCharAfter:function(){return this.start.hasCharAfter()},charAfter:function(){return this.end.charAfter()},charPosition:function(){for(var e=this.start.offset,t=this.start.span.previousSibling();t;)e+=t.getLength(),t=t.previousSibling();for(var n=this.start.span.parent.previousSibling();n;)e+=n.getLength()+1,n=n.previousSibling();return e},containsEntireSection:function(e){var t,n=this.start,i=this.end;for(t=n.span.parent;t&&t.previousSibling()!=i.span.parent;){if(e==t&&(n.span.parent!=e||n.atSectionStart())&&(i.span.parent!=e||i.atSectionEnd()))return!0;t=t.nextSibling()}return!1},getCoveringSpans:function(){for(var e=this.start.span,t=[];e&&e!=this.end.span;)t.push(e),e=e.next();return t.push(e),t},getText:function(){var e="";if(this.start.span.parent!=this.end.span.parent){var t=this.start.span.parent,n=this.end.span.parent,i=new o(this.start,t.last()),r=new o(n.first(),this.end);e+=i.getText();for(var a=t.nextSibling();a&&a!=n;a=a.nextSibling())e+=a.getText();return e+=r.getText()}for(var s=this.start.span,l=this.start.offset;s&&s!=this.end.span;)e+=s.getText().substring(l,s.getLength()),l=0,s=s.nextSibling();return s&&(e+=s.getText().substring(l,this.end.offset)),e}})},function(e,t,n){var i=n(6).Section,o=n(8).Span,r="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJQAAAACCAYAAAC+A/WKAAAAIElEQVQ4EWM8c+bMf4ZRMBoCVAoBJiqZM2rMaAiAQwAAtqkDZ/wM/6kAAAAASUVORK5CYII=",a=i.extend({init:function(){var e=[new o("",{image:r})];this._super("horizontal-rule",e,0,!1)},allowedModifiers:function(){return["image"]},getChildrenContents:function(){return""},_getHTMLPrefix:function(){return"<hr>"},_getHTMLSuffix:function(){return"</hr>"},determineDirection:function(){return null}});t.HorizontalRuleSection=a,t.horizontalRuleImg=r},function(e,t,n){"use strict";var i=null;function o(e){return"LTR"===e?"ltr":"rtl"}function r(e){i=e}e.exports.NEUTRAL="NEUTRAL",e.exports.LTR="LTR",e.exports.RTL="RTL",e.exports.isStrong=function(e){return"LTR"===e||"RTL"===e},e.exports.getHTMLDir=o,e.exports.getHTMLDirIfDifferent=function(e,t){return e===t?null:o(e)},e.exports.setGlobalDir=r,e.exports.initGlobalDir=function(){r("LTR")},e.exports.getGlobalDir=function(){return i||this.initGlobalDir(),i}},function(e,t,n){var i=n(9).Extension,o=n(12).CodeSection;t.TypingExtension=i.extend({install:function(){},isActive:function(e){return e||(e=this.doc.caret.selection),!(e.start.span.parent instanceof o)&&!e.getCoveringSpans().some((function(e){return e.hasModifier("code")||e.hasModifier("math")}))&&!this.doc.formattingState.is("code")&&!this.doc.formattingState.is("math")}})},function(e,t,n){var i=n(21),o=n(5).CONTENT_TYPES,r=n(1).Util,a=n(35),s=n(10),l=s.extend,c=n(23).Container,d=n(4).Position,u=n(8).Span,h=n(29).Quirks,f=n(22).isValidEmail,p=n(36).UndoManager,m=n(30),g=n(37).SHORTCUTS,v=n(6).Section,b=n(3).PlainSection,S=n(13),E=S.UnorderedListSection,C=S.OrderedListSection,_=n(25).H1Section,T=n(12).CodeSection,k=n(14).ImageSection,w=n(17).HorizontalRuleSection,O=n(38).FormattingState,I=n(39).Caret,M=n(15).EmbedSection,R=n(11).canSetModifier,N=n(0).config,L=n(40),P=n(41).qtextDocStyles,D=n(18),A=c.create("doc",{init:function(e,t,o,a){i.rangy.init(),r.loadCss("qtext-doc",P),this.disabledCommands=[],N.setClientInfo(t),N.setOptions(o),N.setPlatformFunctions(a),D.setGlobalDir(N.options.defaultDirection),this.fromJSON(e,!0),r.setData(this.node,"placeholder",N.options.placeholder),N.options.isDarkModeOn&&this.node.classList.add("dark_mode"),N.options.minHeight&&(this.node.style["min-height"]=N.options.minHeight),this._id=N.getDocId(),this._originalJson=this.toJSON(),this._hasBeenModified=!1,this._emitter=new L.EventEmitter,this._allEmitter=new L.EventEmitter,this.enable(),this._attachEventListeners(),this._commands={},this._attachCommands(),this._extensions=[],this._initExtensions();var s=n(42).MutationFixer;this.mutationFixer=new s(this);var l=this.firstChild().firstChild();this.caret=new I(l.first(),l.first(),this),this.formattingState=new O(this.caret),this.undoManager=new p(this._originalJson),this.linkSelector=null,this.imageUploader=null,this.photoSearch=null,this.hyperlinkEmbedManager=null,this._contentType=null,this._backspaceCount=0,this._updatePlaceholder(),this.on("meaningfulChange",this._updatePlaceholder.bind(this)),this.linkInputFocus=!0,this._pendingImages={},this._isComposing=!1},setSendMessageFn:function(e){N.setSendMessageFn(e)},setRpcSupport:function(e,t){N.setRpcFn(e),N.setGetFormkeyFn(t)},setLinkInputFocus:function(e){this.linkInputFocus=e},destroy:function(){this._destroyed=!0,r.safeRemoveChild(this.node,this.node.parentElement),this._extensions.forEach((function(e){e.destroy()}))},contains:function(e){return this.node.contains(e)},isEmpty:function(){return 1==this.children.length&&this.children[0].isEmpty()},isInModal:function(){return s.hasAncestor(this.node,".Modal")},isOnlyWhiteSpace:function(){return this.children.every((function(e){return e.isOnlyWhiteSpace()}))},getLength:function(){var e=0;return this.children.forEach((function(t){e+=t.getLength()})),e},disableCommands:function(e){this.disabledCommands=e||[]},isDisabledCommand:function(e){return e.startsWith("video")?this.disabledCommands.includes("video"):this.disabledCommands.includes(e)},allowsMultipleSections:function(){return!this.isDisabledCommand("return")},disable:function(){this.node.removeAttribute("contenteditable"),this.disabled=!0},enable:function(){this.node.setAttribute("contenteditable","true"),this.disabled=!1},openIOSKeyboardAndFocus:function(e){if(N.clientInfo.isIOSApp&&!this.node.contains(document.activeElement)){var t=window.scrollX,n=window.scrollY,i=document.createElement("input");i.style.position="fixed",i.style.top=0,i.style.left=0,i.style.height=0,i.style.opacity=0,i.autocapitalize="off",i.autocomplete="off",document.body.appendChild(i),i.focus();var o=this;setTimeout((function(){document.body.removeChild(i),o.node.focus(),window.scrollTo(t,n),e&&e()}),300)}},focus:function(){if(this.node)if(!N.clientInfo.isIOSApp||this.node.contains(document.activeElement))this.caret.start&&this.caret.start.span?this.caret.start.span.node.focus():(this.node.focus(),window.scrollTo(x,y)),this.moveCaret(this.caret.start,this.caret.end,!0);else{var e=this.caret.start.clone(),t=this.caret.end.clone(),n=this;this.openIOSKeyboardAndFocus((function(){n.moveCaret(e,t,!0),n.caret.scrollIntoViewIfNeeded()}))}},clear:function(){this.fromJSON({}),this._updateFormattingState(),this.trigger("resetToolbar")},forceDomReflow:function(){for(var e=this.caret.toJSON(),t=this.children.slice(),n=0;n<t.length;n++){var i=t[n];if(!(i instanceof k||i instanceof M)){var o=v.fromJSON(i.toJSON(!0));this.insertAfter(o,i),this.removeChild(i)}}this._caretFromJSON(e)},toJSON:function(e){var t={sections:[],caret:this.caret&&this.caret.toJSON()};return this.children.forEach((function(n){var i=n.toJSON(e);i&&t.sections.push(i)})),r.removeNullValues(t)},fromJSON:function(e,t){for(var n=e.sections||[],i=this.toJSON().sections,o=this.children.slice(),r=a.lineDiff(i,n,s.jsonEqual),l=0;l<r.length;l++){var c=r[l];if("insert"==c.type){var d=v.fromJSON(n[c.index]);d?this.insertBefore(d,this.children[c.index]):console.debug("Not supported yet: ".concat(n[c.index].type))}else"remove"==c.type&&this.removeChild(o[c.index])}n.length&&this.children.length||this.appendChild(new b),this._caretFromJSON(t?null:e.caret),N.options.lightWeightContentToolbar&&t&&1===this.children.length&&(this.children[0]instanceof M||this.children[0]instanceof k)&&this.insertBefore(new b,this.children[0]);var u=this.children[this.children.length-1];N.options.lightWeightContentToolbar&&t&&(u instanceof M||u instanceof k)&&this.insertAfter(new b,u)},_caretFromJSON:function(e){if(e){var t=e.start,n=e.end;-1!=t.sectionIdx&&-1!=t.spanIdx&&-1!=n.sectionIdx&&-1!=n.spanIdx?this.moveCaret(new d(this.children[t.sectionIdx].children[t.spanIdx],t.offset),new d(this.children[n.sectionIdx].children[n.spanIdx],n.offset)):this.caret=new I(this.lastChild().last(),this.lastChild().last(),this)}else this.caret=new I(this.lastChild().last(),this.lastChild().last(),this)},getVideos:function(){return[]},hasBeenModified:function(){return this._hasBeenModified||(this._hasBeenModified=this.hasChanged(this._originalJson)),this._hasBeenModified},hasChanged:function(e){var t=this.toJSON();return!s.jsonEqual(t.sections,e.sections)},on:function(e,t){this._emitter.on(e,t)},onAll:function(e){this._allEmitter.on("all",e)},trigger:function(e){for(var t=new Array(arguments.length-1),n=1;n<arguments.length;++n)t[n-1]=arguments[n];this._allEmitter.trigger("all",[e].concat(t));var i=this._emitter.trigger(e,t),o=i.some((function(e){return!1===e}));return!o&&null},_getToolbarFormattingState:function(e){var t=this.caret.start.span,n=t.parent,i=this.caret.isCollapsed()&&this.caret.hasCharBefore(),o=this.formattingState.is("bold"),a=this.formattingState.is("italic"),l=this.formattingState.is("link"),c=this.formattingState.is("math"),d=this.formattingState.is("code")||n instanceof T,u=n instanceof _,h=n instanceof C,f=n instanceof E,p=h||f,m=t.isEditable(),g=d||c||u||!m,v={span:t,section:n,isMidWord:i,isBold:o,isItalic:a,isLink:l,isMath:c,isCode:d,isH1Tag:u,isOrderedList:h,isUnorderedList:f,isList:p,isEditable:m,disableFormatting:g,disableStyle:g,disableUndo:!(this.undoManager.canUndo()||!s.jsonEqual(this.toJSON(),this.undoManager.state())),disableRedo:!this.undoManager.canRedo()};return r.assert(e in v,"state name not found: "+e),v[e]},_getToolbarItem:function(e){var t=this._getToolbarFormattingState("section"),n=this._getToolbarFormattingState("isMidWord"),i=this._getToolbarFormattingState("isBold"),o=this._getToolbarFormattingState("isItalic"),a=this._getToolbarFormattingState("isLink"),s=this._getToolbarFormattingState("isMath"),l=this._getToolbarFormattingState("isCode"),c=this._getToolbarFormattingState("isH1Tag"),d=this._getToolbarFormattingState("isOrderedList"),u=this._getToolbarFormattingState("isUnorderedList"),h=this._getToolbarFormattingState("isEditable"),f=this._getToolbarFormattingState("disableStyle"),p=this._getToolbarFormattingState("disableUndo"),m=this._getToolbarFormattingState("disableRedo");N.clientInfo.isAndroid&&(f=n||f);var g={bold:{name:"bold",pressed:i,disabled:f},italic:{name:"italic",pressed:o,disabled:f},h1:{name:"h1",pressed:c,disabled:!c&&f},orderedList:{name:"ordered_list",pressed:d,disabled:!h},unorderedList:{name:"unordered_list",pressed:u,disabled:!h},indent:{name:"indent"},deindent:{name:"deindent"},mention:{name:"mention",disabled:a||l||s||!h},quote:{name:"quote",pressed:t.isQuoted(),disabled:!1},code:{name:"code",pressed:l,disabled:!h||s},math:{name:"math",pressed:s,disabled:!h||l},undo:{name:"undo",disabled:p},redo:{name:"redo",disabled:m}};return r.assert(e in g,"item name not found: "+e),c&&!["h1","undo","redo"].includes(e)&&(g[e].disabled=!0),g[e]},_getToolbarLinkItems:function(){var e=[];return N.clientInfo.isNativeApp||e.push({name:"link_input_icon"}),e.concat([{name:"link_input",focused:this.linkInputFocus},{name:"space"},{name:"cite"},{name:"link_save"}])},_isVideoEnabled:function(){return!(!this._isImageEnabled()||!this._isVideoEnabledForUser()||this.isDisabledCommand("video"))},_isVideoEnabledForUser:function(){return N.options.videoEnabled&&(N.options.videoEditorSupported||N.clientInfo.debug)},_isImageEnabled:function(){var e=this._getToolbarFormattingState("isList");return!(N.clientInfo.isMobile&&e)},_getToolbarContentItems:function(){var e=this._getToolbarFormattingState("disableFormatting"),t=this._getToolbarFormattingState("isLink"),n=[],i=this._isImageEnabled(),o=this._isVideoEnabled();return N.options.tabbedEditorToolbar?(!this.isDisabledCommand("video")&&this._isVideoEnabledForUser()&&n.push({name:"video-tab",disabled:!o}),this.isDisabledCommand("image")||n.push({name:"photos-tab",disabled:!i})):(o&&n.push({name:"video"}),i&&n.push({name:"image"})),n.push({name:"link",pressed:t,disabled:e}),n},_getToolbarIndentItems:function(){var e=[];return this._getToolbarFormattingState("isList")&&(e=e.concat([this._getToolbarItem("indent"),this._getToolbarItem("deindent")])),e},_getToolbarTabbedItems:function(){var e=[this._getToolbarItem("italic"),this._getToolbarItem("bold"),this._getToolbarItem("mention"),this._getToolbarItem("undo"),this._getToolbarItem("orderedList"),this._getToolbarItem("unorderedList"),this._getToolbarItem("quote"),this._getToolbarItem("code"),this._getToolbarItem("math")];return e=(e=e.concat(this._getToolbarIndentItems())).concat(this._getToolbarContentItems())},getToolbarState:function(e){if(N.options.lightWeightContentToolbar){var t=this,n=this._getToolbarFormattingState("isList");return 0===e?i=[{name:"text_formatting"},{name:"image"},{name:"space"},{name:"rules"},{name:"post"},{name:"monetization"}]:1===e?(i=[{name:"dismiss"}],N.options.h1ButtonEnabled&&(i=i.concat([t._getToolbarItem("h1")])),i=i.concat([t._getToolbarItem("bold"),t._getToolbarItem("italic"),t._getToolbarItem("orderedList"),t._getToolbarItem("unorderedList")]),n&&(i=i.concat([{name:"indent",disabled:!1},{name:"deindent",disabled:!1}])),i=(i=i.concat(t._getToolbarContentItems().filter((function(e){return"image"!==e.name})))).concat([t._getToolbarItem("mention"),t._getToolbarItem("quote"),t._getToolbarItem("code"),t._getToolbarItem("math"),t._getToolbarItem("undo"),t._getToolbarItem("redo")])):2===e&&(i=t._getToolbarLinkItems()),i.forEach((function(e){t.isDisabledCommand(e.name)&&(e.pressed=!1,e.disabled=!0)})),i}var i;return t=this,0===e?i=t._getToolbarLinkItems():N.options.tabbedEditorToolbar?i=t._getToolbarTabbedItems():1===e?((i=(i=[t._getToolbarItem("bold"),t._getToolbarItem("italic"),t._getToolbarItem("orderedList"),t._getToolbarItem("unorderedList")]).concat(t._getToolbarIndentItems())).push({name:"space"}),(i=i.concat(t._getToolbarContentItems())).push({name:"overflow_show",grayBackground:!0})):2===e&&(i=[t._getToolbarItem("mention"),t._getToolbarItem("quote"),t._getToolbarItem("code"),t._getToolbarItem("math"),{name:"space"},t._getToolbarItem("undo"),t._getToolbarItem("redo"),{name:"overflow_hide"}]),i.forEach((function(e){t.isDisabledCommand(e.name)&&(e.pressed=!1,e.disabled=!0)})),i},updateSpellingSuggestions:function(){N.clientInfo.isIOSApp&&setTimeout((function(){N.platform.sendMessage("selectionChanged")}),0)},flushTextInput:function(){N.clientInfo.isIOSApp&&N.platform.sendMessage("flushTextInput")},handleCommand:function(e){if(this.isDisabledCommand(e))return!1;for(var t=e,n=new Array(arguments.length-1),i=1;i<arguments.length;++i)n[i]=arguments[i];return N.clientInfo.isIOS&&this._backspaceCount>20&&"backspace"==t&&(t="delete-previous-word"),n[0]="command-"+t,this.trigger.apply(this,n)},progressivelyExitSection:function(e,t){if(e.getIndent()>0)e.setIndent(e.getIndent()-1);else if(e instanceof b||t)e.isQuoted()&&e.setQuoted(!1);else for(var n=(e=e.changeType(b)).previousSibling();n&&n.isEditable()&&(n.isEmpty()||""===n.node.textContent.trim());){var i=n;n=n.previousSibling(),this.removeChild(i)}return e},toggleModifier:function(e){var t,n;return this.formattingState.toggleModifier(this.caret,e),this.caret.isCollapsed()?(this.focus(),this.updateSpellingSuggestions(),!1):(t=this._getSelectedSpans(!1),n=t.every((function(t){return t.hasModifier(e)||!R(t,e)})),t.forEach((function(t){t.isEditable()&&(n?t.removeModifier(e):t.setModifier(e,!0))})),this.focus(),!1)},toggleSectionType:function(e){var t=this._getSelectedSections(),n=t[0]instanceof e,i=this.caret.start.clone(),o=this.caret.end.clone();return t.forEach((function(t){t.isEditable()&&(n?t.changeType(b):t.changeType(e))})),this.moveCaret(i,o),n||this.forceDomReflow(),!1},cloneSelection:function(){var e,t,n=this,i=this._getSelectedSpans(!1),o=[];return i.forEach((function(i){e!=i.parent&&(e=i.parent,(t=i.parent.toJSON()).spans=[],n.caret.containsEntireSection(e)||(t.type="plain"),o.push(t)),t.spans.push(i.toJSON())})),o.map((function(e){return v.fromJSON(e)}))},sanitizeContent:function(e){var t=this,n=e.filter((function(e){return!(e instanceof k&&t.isDisabledCommand("image"))&&!(e instanceof M&&t.isDisabledCommand("embed"))&&!(e instanceof w&&t.isDisabledCommand("horizontal-rule"))}));return!t.allowsMultipleSections()&&e.length>0&&(n=[n.reduce((function(e,t){return e.merge(t),e}))]),n=n.map((function(e){var n=e instanceof T&&t.isDisabledCommand("code");return(n=(n=n||e instanceof E&&t.isDisabledCommand("unordered_list"))||e instanceof C&&t.isDisabledCommand("ordered_list"))&&(e=e.changeType(b)),e.setQuoted(e.isQuoted()&&!t.isDisabledCommand("quote")),e.children.forEach((function(e){for(var n in e.modifiers)t.isDisabledCommand(n)&&e.removeModifier(n)})),e}))},saveState:function(){this.undoManager.add(this.toJSON()),this.trigger("meaningfulChange")},setImageUploader:function(e){this.imageUploader=e},setHyperlinkEmbedManager:function(e){this.hyperlinkEmbedManager=e},setUploadRetryManager:function(e){this.uploadRetryManager=e},setLinkSelector:function(e){var t=this;t.linkSelector=e,e.onSubmit((function(n){var i=n.target||{type:"url",url:n.url};!i.url&&n.url&&(i.url=n.url);var o=t._insertOrModifyLink(n.text,i);e.hide(),t.focus(),t.moveCaret(o.nextSibling().last()),setTimeout((function(){t.focus(),t.caret.scrollIntoViewIfNeeded(),t._focusAfterHidingLinkSelectorOnIOS()}),0),t.saveState()})),e.onCancel((function(n){if(e.hide(),t.focus(),n){var i=t.caret.start.span.modifiers,o=new u(n,i);t.insertSpan(t.caret.start,o),t.moveCaret(o.last())}}))},_focusAfterHidingLinkSelectorOnIOS:function(){if(N.clientInfo.isIOSApp){var e=this;setTimeout((function(){e.node&&e.node.blur(),setTimeout((function(){e.focus(),e.caret.scrollIntoViewIfNeeded()}),300)}),300)}},setPhotoSearch:function(e){var t=this;t.photoSearch=e,e.onInsert((function(n){t.insertAndUploadImageUrl(n,"photosearch"),e.hide(),t.focus()})),e.onCancel((function(){e.hide(),t.focus()}))},setContentType:function(e){this._contentType=e},getContentType:function(){return this._contentType||"unknown"},getCurrentDirection:function(){return this.caret.start.span.parent.getDirection()},_parseAndLinkifySections:function(e){var t=[];return e.forEach((function(e){e.children.forEach((function(n){if(R(n,"link"))if(n.hasModifier("link")){if(n.getModifier("link").url.includes("quora.com/_/redirect")){var i=n.getModifier("link").url;n.getModifier("link").url=new window.URLSearchParams(i).get("url")}}else{var o=r.linkify(n.getText());if(0!==o.length&&(1!=o.length||o[0].href)){var a=n.modifiers;o.forEach((function(i){var o=i.text,r=i.href,s=new u(o,a);r&&(s.setModifier("link",{type:"url",url:r},!0),t.push(s)),e.insertBefore(s,n)})),e.removeChild(n)}}}))})),t},linkifySections:function(e){this.fetchLinkPreviews(this._parseAndLinkifySections(e))},insertAndUploadImageUrl:function(e,t,n){if(this.imageUploader){var i=this;this.imageUploader.showUploading(),this.imageUploader.uploadImageUrl(e,(function(e){n&&(n.previousSibling()?i.moveCaret(n.previousSibling().last()):n.nextSibling()?i.moveCaret(n.nextSibling().first()):(n.parent.insertBefore(new u(" "),n),i.moveCaret(n.previousSibling().first())),n.parent.removeChild(n)),i.insertImages([e],{source:t}),i.imageUploader.hideDropZone()}))}},uploadPendingImages:function(e,t){this.imageUploader&&this.imageUploader.uploadPendingImages(e,this.replaceTempUrls.bind(this),this.markFailedUrls.bind(this),t)},replaceTempUrls:function(e){this.children.forEach((function(t){if(t instanceof k&&t.isPending){var n=t.children[0].getModifier("image"),i=e[n];i&&t.setUploadSuccess(i)}}))},markFailedUrls:function(e){this.children.forEach((function(t){if(t instanceof k&&t.isPending){var n=t.children[0].getModifier("image");e.includes(n)&&t.setUploadFailed()}}))},insertSpan:function(e,t){var n;return n=e.atSpanStart()?e.span:e.atSpanEnd()?e.span.nextSibling():e.span.split(e.offset),e.span.parent.insertBefore(t,n),""===e.span.getText()&&e.span.parent.removeChild(e.span),t.last()},insertImages:function(e,t,n){this.handleCommand("image",e,t,n)},insertClipboardSuggestion:function(e,t,i){if(e){var r=n(27).parse(e,o.TEXT);r=this.sanitizeContent(r);var a=n(15).EmbedSection.fromOtherSection(r[0],!0);if(a){var s=this;this.children.forEach((function(e){e.clipboardPending&&s.removeChild(e)})),a.setOnRemoveCallback(i),this.insertSections([a]),setTimeout((function(){t(a.children[0]._reactPlaceholder)}),1)}}},insertHyperlinkEmbedPreview:function(e){var t=this;if(t.hyperlinkEmbedManager){var n={data:e.data,placeholder:e.children[0]._reactPlaceholder,convertToTextLink:e.convertToTextLink.bind(e),removeEmbed:e.removeEmbed.bind(e)};t.hyperlinkEmbedManager.insertHyperlinkEmbedPreview(n),e.setOnRemoveCallback((function(){t.hyperlinkEmbedManager.removeHyperlinkEmbedPreview(n)}))}},insertUploadRetryButton:function(e){var t=this;if(t.uploadRetryManager){var n={button:e.children[0]._retryButton,banner:e.children[0]._retryBanner};t.uploadRetryManager.insertButtonAndBanner(n),e.registerReactUnmountCallback((function(){t.uploadRetryManager.removeButtonAndBanner(n)}))}},retryUpload:function(){this.imageUploader&&(this.children.forEach((function(e){e instanceof k&&e.isPending&&e.removeRetryButton()})),this.imageUploader.retryUpload(this.replaceTempUrls.bind(this),this.markFailedUrls.bind(this)))},moveCaret:function(e,t,n){var i=this.caret.move(e,t,n);return this.trigger("caretMoved"),i},moveCaretEnd:function(e){var t=this.caret.moveEnd(e);return this.trigger("caretMoved"),t},moveCaretStart:function(e){var t=this.caret.moveStart(e);return this.trigger("caretMoved"),t},_updatePlaceholder:function(){this.isEmpty()&&this.children[0]instanceof b&&!this.children[0].isQuoted()?this.node.classList.add("empty"):this.node.classList.remove("empty")},_handleEmptySpan:function(e){var t,n,i;return e.parent.firstChild()==e&&1==e.parent.children.length?(e.setText(""),e.removeAllModifiers(),e.first()):(n=e.previousSibling(),i=e.nextSibling(),e.parent.removeChild(e),n?(e=n,t=n.getLength()):(e=i,t=0),new d(e,t))},updateCaret:function(){var e=this.caret.update();return e&&(this.trigger("caretMoved"),this.trigger("meaningfulChange")),this._updateActiveSpans(),e},_updateCaretAndFormattingState:function(){this.updateCaret()&&this._updateFormattingState()},_updateActiveSpans:function(){var e,t,n=this.node.querySelectorAll(".active"),i=this.caret.start.span,o=this.caret.end.span;for(e=0;e<n.length;e++)n[e].classList.remove("active");for(t=i;t!=o;t=t.next())t.node.classList.add("active");t.node.classList.add("active")},_debugEvent:function(e,t){},_attachEventListeners:function(){var e,t=this,n=this._debugEvent.bind(this),i=new m.Hub(this.node);s.iterItems(g,(function(e,n){var o={source:"keyboard",shortcut:e};i.on(e,(function(e){return t.handleCommand(n,e,o)}))})),["Left","Up","Home"].forEach((function(e){i.on(e,(function(){return"Left"===e&&t.caret.selection.start.span.parent.isRTL()?!(t.caret.isCollapsed()&&t.caret.start.atDocEnd()):!(t.caret.isCollapsed()&&t.caret.start.atDocStart())}))})),["Right","Down","End"].forEach((function(e){i.on(e,(function(){return"Right"===e&&t.caret.selection.start.span.parent.isRTL()?!(t.caret.isCollapsed()&&t.caret.start.atDocStart()):!(t.caret.isCollapsed()&&t.caret.start.atDocEnd())}))})),r.on("beforeinput",this.node,(function(e){if(n("beforeinput",e),"deleteCompositionText"===e.inputType){var t=window.getSelection().getRangeAt(0),i=t.startContainer,o=t.endContainer,a=t.endOffset,s=t.startOffset;r.isTextNode(i)&&i===o&&0===s&&a===i.length&&i.parentElement.insertBefore(document.createTextNode(" "),i)}})),r.on("input",this.node,(function(e){if(n("input",e),"deleteCompositionText"===e.inputType){var i=window.getSelection().getRangeAt(0);return i.startContainer.parentElement.children[0].innerHTML,i.startContainer.parentElement.children[0].innerHTML=" ",!1}if(N.clientInfo.isAndroid&&"@"==e.data)return t.handleCommand("mention","@",{source:"keyboard"})})),r.on("keydown",this.node,(function(o){var r;return n("keydown",o),m.isNavigation(o)&&!t.caret.isCollapsed()||t.updateCaret(),m.isOnlyShiftKey(o)&&"Meta"===o.key||t.caret.scrollIntoViewIfNeeded(),N.clientInfo.isIOS&&(8===o.which?t._backspaceCount+=1:t._backspaceCount=0,e<+new Date-500&&(t._backspaceCount=0)),r=i.trigger(o),t.trigger("keydown",o.which),t.trigger("keydownEvent",o),setTimeout(t.trigger.bind(t,"meaningfulChange"),0),r})),r.on("keypress",this.node,(function(e){if(n("keypress",e),t.updateCaret(),!e||0===e.which||e.ctrlKey||e.metaKey||e.altKey||t._beforeTextInput(e),"@"==String.fromCharCode(e.which))return t.handleCommand("mention","@",{source:"keyboard"});var i=String.fromCharCode(e.which);return i==e.key?t.trigger("keypress",i):void 0})),r.on("keyup",this.node,(function(i){return n("keyup",i),!t.caret.isCollapsed()&&m.isNavigation(i)&&i.shiftKey&&!m.isOnlyShiftKey(i)||t.updateCaret(),N.clientInfo.isIOS&&(e=+new Date),i.isComposing||(m.isNavigation(i)||!t.caret.isCollapsed()?t._updateFormattingState():t._afterTextInput()),!1})),r.on("compositionstart",this.node,(function(e){t._isComposing=!0,n("compositionstart",e)})),r.on(["textInput","compositionupdate"],this.node,(function(e,i){if(n(i,e),N.clientInfo.isAndroid||t.updateCaret(),t._isComposing&&t.caret.selection.end.span.getText().includes("\n")||t._beforeTextInput(e),"textInput"==i&&h.usesCompositionEvents())return!0;if("compositionupdate"==i&&!h.usesCompositionEvents())return setTimeout((function(){t._afterTextInput()}),0),!0;if(!t.caret.isCollapsed())return!0;var o=e.data;return!(" "==o&&!1===t.handleCommand("space")||o.includes("\n")&&0==t.handleCommand("return")||o&&!1===t.trigger("keypress",o))&&!e.isComposing&&void setTimeout((function(){t.updateCaret(),t.caret.scrollIntoViewIfNeeded(),t._afterTextInput()}),0)})),r.on("compositionend",this.node,(function(e){t._isComposing=!1,n("compositionend",e),t._afterTextInput()})),r.on("focus",this.node,(function(){N.restoreConfig(t),t.linkSelector&&t.linkSelector.hide(),t.photoSearch&&t.photoSearch.hide(),t.trigger("focus")})),r.on("blur",this.node,(function(){N.cacheConfig(t),t.trigger("blur")})),(N.clientInfo.isMobile||N.clientInfo.isIPad)&&t._runForever((function(){t.updateCaret()})),this._attachMouseAndTouchEvents(),this._attachClipboardEvents(),this._attachDragAndDropListeners()},_attachClipboardEvents:function(){r.on("copy",this.node,this.handleCommand.bind(this,"copy")),r.on("cut",this.node,this.handleCommand.bind(this,"cut")),r.on("paste",this.node,this.handleCommand.bind(this,"paste"))},_attachMouseAndTouchEvents:function(){var e=this,t=null,n=this.trigger.bind(this,"longpress"),i=this._debugEvent.bind(this);r.on(["mousedown","touchstart"],this.node,(function(o,r){t||(t=setTimeout((function(){n(o)}),500)),i(r,o),setTimeout(e._updateCaretAndFormattingState.bind(e),0),e.trigger(r,o)})),r.on(["mouseup","touchend"],this.node,(function(n,o){t&&(clearTimeout(t),t=null),i(o,n),setTimeout(e._updateCaretAndFormattingState.bind(e),0),e.trigger(o,n)})),r.on(["mousemove","touchmove"],this.node,(function(t,n){setTimeout(e._updateCaretAndFormattingState.bind(e),0),e.trigger(n,t)}))},_attachDragAndDropListeners:function(){if(!N.clientInfo.isMobile){var e=this,t=!1,a=this._debugEvent.bind(this);r.on(["dragstart","dragend"],this.node,(function(n,i){a(i,n),t="dragstart"==i;var o=e.caret.start.span.parent;e.caret.isCollapsed()&&(o.isEditable()?"IMG"==n.target.nodeName&&(o=u.get(n.target.parentElement.parentElement).parent,e.moveCaret(o.first(),o.last())):e.moveCaret(o.first(),o.last()))})),r.on("drop",this.node,(function(r){a("drop",r);var s,l,c,d,u,h=[o.PUBLIC_HTML,o.HTML];if(t)t=!1,c=e.cloneSelection();else{for(d=0;d<h.length;d++)if(u=r.dataTransfer.getData(h[d])){c=n(27).parse(u,h[d]),c=e.sanitizeContent(c);break}c=c||[]}try{s=i.rangeFromPoint(r.clientX,r.clientY),l=e.caret._fromNode(s.startContainer,s.startOffset),e.saveState(),e._deleteSelection(),e.moveCaret(l),e.insertSections(c),r.preventDefault()}catch(f){console.error(f)}}))}},_attachCommands:function(){var e,t,i,o=n(45).COMMANDS,r=Object.keys(o);for(i=0;i<r.length;i++)t=r[i],this.isDisabledCommand(t)||(e=new(0,o[t])(this),this._commands[t]=e,this._emitter.on("command-"+t,e.run.bind(e,t)))},_initExtensions:function(){var e,t,i=n(61).EXTENSIONS;for(t=0;t<i.length;t++)(e=new(0,i[t])(this)).install(),this._extensions.push(e)},_runForever:function(e){var t=this;window.requestAnimationFrame((function n(){if(!t._destroyed)try{e()}catch(i){}finally{window.requestAnimationFrame(n)}}))},_beforeTextInput:function(e){var t=this.caret.start.span.parent;if(this.caret.isCollapsed()||(this.saveState(),this._deleteSelection(),t=this.caret.start.span.parent,this.formattingState.updatePosition(this.caret)),!t.isEditable()){var n=new b;this.caret.start.atSectionStart()?this.insertBefore(n,t):this.insertAfter(n,t),this.moveCaret(n.first()),this.caret.updateAndroidCaretPosition(1)}},_afterTextInput:function(){this.formattingState.hasChanged(this.caret)&&this._applyFormattingChange();var e=this.caret.start,t=e.span.parent,n=t.getLength(),i=1===n&&1===e.span.getLength();(n>0&&!t.isDirectionConfirmed()||0==n||i)&&t.resetRTL()},_updateFormattingState:function(){this.formattingState.update(this.caret),this.trigger("updateToolbar")},_applyFormattingChange:function(){var e=this.caret.start.span,t=this.formattingState.position.offset,n=this.caret.start.offset;e===this.formattingState.position.span?n>t?(n<e.getLength()&&e.split(n,!0),t>0&&(e=e.split(t,!0)),this.formattingState.apply(e),this.moveCaret(e.last()),this._updateFormattingState()):n<t&&this._updateFormattingState():this._updateFormattingState()},_deleteSelection:function(){var e,t,n=this.caret.start,i=this.caret.end,o=n.span.parent,r=i.span.parent;if(o.isEditable()&&(n.atSpanStart()?n.atSectionStart()||(t=n.alternatePosition()):t=n),o==r)if(o.isEditable())o.deleteText(n,i);else{var a=n.span.next(),s=n.span.previous();a?t=a.first():s?t=s.last():(e=new b,this.insertAfter(e,o),t=e.first()),this.removeChild(o)}else{for(o.isEditable()?o.deleteText(n,o.last()):(e=new b,this.insertBefore(e,o),this.removeChild(o),o=e);o.nextSibling()!=r;)this.removeChild(o.nextSibling());r.isEditable()?r.deleteText(r.first(),i):(e=new b,this.insertBefore(e,r),this.removeChild(r),r=e),t=o.merge(r)}t||(t=o.first()),this.moveCaret(t,t,!0)},_getSelectedSpans:function(e,t){t||this.updateCaret();var n=[],i=this.caret.start,o=this.caret.end;if(this.caret.isCollapsed())return[];if(i.span==o.span)o.offset<o.span.getLength()&&o.span.split(o.offset,e),i.offset>0&&(o.span=i.span=i.span.split(i.offset,e)),n=[i.span];else{i.offset>0&&(i.offset==i.span.getLength()?i.span=i.span.next():i.span=i.span.split(i.offset,e)),o.offset<o.span.getLength()&&(0===o.offset?o.span=o.span.previous():o.span.split(o.offset,e));for(var r=i.span;r!=o.span;r=r.next())n.push(r);n.push(o.span)}return this.moveCaret(i.span.first(),o.span.last()),n},_toggleMathOrCodeModifier:function(e){if(!this.caret.isCollapsed()){var t=this._getSelectedSpans(!0);t[0].getModifier(e)?t.forEach((function(t){t.removeModifier(e)})):((t=this._mergeSpansBySection(t)).forEach((function(t){t.setModifier(e,!0,!0)})),this.moveCaret(t[0].first(),t[t.length-1].last())),this._updateFormattingState()}},_getSelectedSections:function(){this.updateCaret();var e,t=[],n=this.caret.start,i=this.caret.end;if(this.caret.isCollapsed())t.push(n.span.parent);else{for(e=n.span.parent;e!=i.span.parent;e=e.nextSibling())t.push(e);t.push(i.span.parent)}return t},insertSections:function(e){var t,n,i,o,r,a,s,c=this;if(0!==e.length){var d=this.caret.doc.isEmpty();if(c.caret.isCollapsed()||c._deleteSelection(!0),this.handleCommand("embed",e),t=c.caret.start,!(i=t.span.parent).isEditable()){var u=new b;c.caret.start.atSectionStart()?c.insertBefore(u,i):c.insertAfter(u,i),c.moveCaret(u.first()),i=u,t=u.first()}s=l({},t.span.modifiers),i.split(t),o=i.nextSibling(),e.forEach((function(e){e.children.forEach((function(t){e.isEditable()&&t.updateModifiers(s,!0)})),c.insertBefore(e,o),i instanceof T&&e.isEditable()&&e.changeType(T),e.setIndent(e.getIndent())}));var h=this._parseAndLinkifySections(e);r=i.nextSibling();var f=N.options.lightWeightContentToolbar&&d&&(r instanceof M||r instanceof k);r.constructor==i.constructor||r instanceof b?i.merge(r):i.isEmpty()&&(f||this.removeChild(i)),(a=o.previousSibling()).isEditable()&&(a.constructor==o.constructor||o instanceof b)?(n=a.last(),a.merge(o)):n=f?i.first():o.first(),this.moveCaret(n),this.fetchLinkPreviews(h),a instanceof k&&o instanceof C&&this.forceDomReflow()}},_shouldAllowLinks:function(e){var t=(e=e||this.caret.start.span).parent;return!!this.caret.isCollapsed()&&!e.hasModifier("link")&&!(t instanceof T||e.hasModifier("code"))&&!e.hasModifier("math")&&!(t instanceof _)},_insertOrModifyLink:function(e,t,n,i){var o=this.caret.start,r=!i&&o.span.hasAnyModifier(["link","citation"]),a=r?o.span:new u(e),s=new u(" ");if("@"==o.charAfter()&&N.clientInfo.isAndroid){var l=o.span.getText().slice(0,o.offset),c=o.span.getText().slice(o.offset+1);o.span.setText(l+c)}return r||a.updateModifiers(o.span.modifiers),a.removeModifier("link"),a.removeModifier("citation"),s.updateModifiers(a.modifiers),r||(o=this.insertSpan(o,a)),n?(a.setModifier("citation",{target:t}),a.setText(" ")):(a.setModifier("link",t),a.setText(e)),o=a.last(),this.caret.move(o)," "!==this.caret.charAfter()&&(o=this.insertSpan(o,s),this.caret.move(o)),a},_previewLink:function(e,t){var n,i,o,a=this;t=t||this.saveState.bind(this),e.hasModifier("link")?o=e.getModifier("link").url:e.hasModifier("citation")?(i="target"in(n=e.getModifier("citation"))?n.target:n,o=i.url):o=e.getText(),o.startsWith("mailto:")&&f(o.slice(7))||(o=r.ensureProtocol(o),this.linkSelector&&this.linkSelector.getLinkPreview(o,(function(n){a.disabled||(t(),e.hasModifier("citation")?e.setModifier("citation",l({title:n.title},e.getModifier("citation"))):"image"==n.type?a.insertAndUploadImageUrl(o,"link",e):(e.setText(n.title),a.caret.start.span==e&&(a.moveCaret(e.last()),a._updateFormattingState())))}),(function(){})))},fetchLinkPreviews:function(e){var t=this,n=s.once((function(){t.saveState()}));e.forEach((function(e){t._previewLink(e,n)}))},_mergeSpansBySection:function(e){var t,n=null,i=null,o=[];return e.forEach((function(e){e.parent!=i?(n=e,i=e.parent,o.push(e)):(t=r.objectIntersection(n.modifiers,e.modifiers),n.removeAllModifiers(),n.updateModifiers(t),n.setText(n.getText()+e.getText()),e.parent.removeChild(e))})),o}});t.Doc=A},function(e,t){var n=t.rangy={getSelection:function(){return window.getSelection()},createRange:function(){return document.createRange()},init:function(){}};t.rangeFromPoint=function(e,t){var i,o,r,a,s;return document.caretPositionFromPoint?(r=(i=document.caretPositionFromPoint(e,t)).offsetNode,a=i.offset):document.caretRangeFromPoint?(r=(o=document.caretRangeFromPoint(e,t)).startContainer,a=o.startOffset):document.elementFromPoint&&(r=document.elementFromPoint(e,t),a=0),r&&a!==undefined?((s=n.createRange()).setStart(r,a),s.setEnd(r,a),s.collapse(!0),s):null}},function(e,t){t.isValidEmail=function(){var e=new RegExp("^([^\\x00-\\x20\\x22\\x28\\x29\\x2c\\x2e\\x3a-\\x3c\\x3e\\x40\\x5b-\\x5d\\x7f-\\xff]+|\\x22([^\\x0d\\x22\\x5c\\x80-\\xff]|\\x5c[\\x00-\\x7f])*\\x22)(\\x2e([^\\x00-\\x20\\x22\\x28\\x29\\x2c\\x2e\\x3a-\\x3c\\x3e\\x40\\x5b-\\x5d\\x7f-\\xff]+|\\x22([^\\x0d\\x22\\x5c\\x80-\\xff]|\\x5c[\\x00-\\x7f])*\\x22))*\\x40([^\\x00-\\x20\\x22\\x28\\x29\\x2c\\x2e\\x3a-\\x3c\\x3e\\x40\\x5b-\\x5d\\x7f-\\xff]+|\\x5b([^\\x0d\\x5b-\\x5d\\x80-\\xff]|\\x5c[\\x00-\\x7f])*\\x5d)(\\x2e([^\\x00-\\x20\\x22\\x28\\x29\\x2c\\x2e\\x3a-\\x3c\\x3e\\x40\\x5b-\\x5d\\x7f-\\xff]+|\\x5b([^\\x0d\\x5b-\\x5d\\x80-\\xff]|\\x5c[\\x00-\\x7f])*\\x5d))*$");return function(t){return e.test(t)}}()},function(e,t,n){var i=n(7).Class,o=n(1).Util,r=i.extend({__init__:function(e){this.kind=e,this.node=o.create("DIV"),this.node.className=this.kind,this.children=[]},init:function(){},insertAfter:function(e,t){if(e.parent&&e.parent.removeChild(e),t){var n=t.node.nextSibling;this.node.insertBefore(e.node,n),this.children.splice(this.children.indexOf(t)+1,0,e)}else this.node.appendChild(e.node),this.children.push(e);e.parent=this},insertBefore:function(e,t){e.parent&&e.parent.removeChild(e),t?(this.node.insertBefore(e.node,t.node),this.children.splice(this.children.indexOf(t),0,e)):(this.node.appendChild(e.node),this.children.push(e)),e.parent=this},appendChild:function(e){this.insertBefore(e)},appendChildren:function(e){e.forEach(this.appendChild.bind(this))},hasChild:function(e){return-1!==this.children.indexOf(e)},removeChild:function(e){if(this.hasChild(e)){var t=this.children.indexOf(e);this.children.splice(t,1),o.safeRemoveChild(e.node,this.node)}},removeChildren:function(){for(var e,t=this.firstChild();t;)e=t.nextSibling(),this.removeChild(t),t=e},previousSibling:function(){return this.node.previousSibling&&this.Class.get(this.node.previousSibling)},nextSibling:function(){return this.node.nextSibling&&this.Class.get(this.node.nextSibling)},firstChild:function(){return 0===this.children.length?null:this.children[0]},lastChild:function(){return 0===this.children.length?null:this.children[this.children.length-1]}});r.create=function(e,t){var n;return o.assert(!t.__init__,"Do not override __init__"),t.__init__=function(){this._super(e),this.init.apply(this,arguments),this.Class=n,n.add(this,this.node)},(n=r.extend(t)).add=function(e,t){o.setData(t,"kind",e.kind),t.qtextContainer=e},n.get=function(e){return o.assert(n.is(e)),e.qtextContainer},n.is=function(t){return!!t&&1==t.nodeType&&o.getData(t,"kind")==e},n},t.Container=r},function(e,t,n){var i=n(0).config;t.hyperlinkEmbedsEnabled=function(){return i.options.qtext_hyperlink_embed}},function(e,t,n){var i=n(6).Section,o=n(26),r=i.extend({init:function(e,t,n,i){this._super("heading",e,t,n,i)},htmlIndentPrefix:"",htmlIndentSuffix:"",htmlPrefix:"<h1>",htmlSuffix:"</h1>",determineDirection:function(){var e=this.firstChild();return e&&!e.isEmpty()?o.resolveBlockDir(e.getText(),this._super()):this._super()},isOneLineOnly:function(){return!0},allowedModifiers:function(){return[]},shouldRemoveChildrenModifiers:function(){return!0}});t.H1Section=r},function(e,t,n){"use strict";var i=n(18),o="\u0590\u05be\u05c0\u05c3\u05c6\u05c8-\u05cf\u05d0-\u05ea\u05eb-\u05ef\u05f0-\u05f2\u05f3-\u05f4\u05f5-\u05ff\u07c0-\u07c9\u07ca-\u07ea\u07f4-\u07f5\u07fa\u07fb-\u07ff\u0800-\u0815\u081a\u0824\u0828\u082e-\u082f\u0830-\u083e\u083f\u0840-\u0858\u085c-\u085d\u085e\u085f-\u089f\u200f\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb37\ufb38-\ufb3c\ufb3d\ufb3e\ufb3f\ufb40-\ufb41\ufb42\ufb43-\ufb44\ufb45\ufb46-\ufb4f",r="\u0608\u060b\u060d\u061b\u061c\u061d\u061e-\u061f\u0620-\u063f\u0640\u0641-\u064a\u066d\u066e-\u066f\u0671-\u06d3\u06d4\u06d5\u06e5-\u06e6\u06ee-\u06ef\u06fa-\u06fc\u06fd-\u06fe\u06ff\u0700-\u070d\u070e\u070f\u0710\u0712-\u072f\u074b-\u074c\u074d-\u07a5\u07b1\u07b2-\u07bf\u08a0-\u08b2\u08b3-\u08e3\ufb50-\ufbb1\ufbb2-\ufbc1\ufbc2-\ufbd2\ufbd3-\ufd3d\ufd40-\ufd4f\ufd50-\ufd8f\ufd90-\ufd91\ufd92-\ufdc7\ufdc8-\ufdcf\ufdf0-\ufdfb\ufdfc\ufdfe-\ufdff\ufe70-\ufe74\ufe75\ufe76-\ufefc\ufefd-\ufefe",a=new RegExp("[A-Za-z\xaa\xb5\xba\xc0-\xd6\xd8-\xf6\xf8-\u01ba\u01bb\u01bc-\u01bf\u01c0-\u01c3\u01c4-\u0293\u0294\u0295-\u02af\u02b0-\u02b8\u02bb-\u02c1\u02d0-\u02d1\u02e0-\u02e4\u02ee\u0370-\u0373\u0376-\u0377\u037a\u037b-\u037d\u037f\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u0482\u048a-\u052f\u0531-\u0556\u0559\u055a-\u055f\u0561-\u0587\u0589\u0903\u0904-\u0939\u093b\u093d\u093e-\u0940\u0949-\u094c\u094e-\u094f\u0950\u0958-\u0961\u0964-\u0965\u0966-\u096f\u0970\u0971\u0972-\u0980\u0982-\u0983\u0985-\u098c\u098f-\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09be-\u09c0\u09c7-\u09c8\u09cb-\u09cc\u09ce\u09d7\u09dc-\u09dd\u09df-\u09e1\u09e6-\u09ef\u09f0-\u09f1\u09f4-\u09f9\u09fa\u0a03\u0a05-\u0a0a\u0a0f-\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32-\u0a33\u0a35-\u0a36\u0a38-\u0a39\u0a3e-\u0a40\u0a59-\u0a5c\u0a5e\u0a66-\u0a6f\u0a72-\u0a74\u0a83\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2-\u0ab3\u0ab5-\u0ab9\u0abd\u0abe-\u0ac0\u0ac9\u0acb-\u0acc\u0ad0\u0ae0-\u0ae1\u0ae6-\u0aef\u0af0\u0b02-\u0b03\u0b05-\u0b0c\u0b0f-\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32-\u0b33\u0b35-\u0b39\u0b3d\u0b3e\u0b40\u0b47-\u0b48\u0b4b-\u0b4c\u0b57\u0b5c-\u0b5d\u0b5f-\u0b61\u0b66-\u0b6f\u0b70\u0b71\u0b72-\u0b77\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99-\u0b9a\u0b9c\u0b9e-\u0b9f\u0ba3-\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bbe-\u0bbf\u0bc1-\u0bc2\u0bc6-\u0bc8\u0bca-\u0bcc\u0bd0\u0bd7\u0be6-\u0bef\u0bf0-\u0bf2\u0c01-\u0c03\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c39\u0c3d\u0c41-\u0c44\u0c58-\u0c59\u0c60-\u0c61\u0c66-\u0c6f\u0c7f\u0c82-\u0c83\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cbe\u0cbf\u0cc0-\u0cc4\u0cc6\u0cc7-\u0cc8\u0cca-\u0ccb\u0cd5-\u0cd6\u0cde\u0ce0-\u0ce1\u0ce6-\u0cef\u0cf1-\u0cf2\u0d02-\u0d03\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d\u0d3e-\u0d40\u0d46-\u0d48\u0d4a-\u0d4c\u0d4e\u0d57\u0d60-\u0d61\u0d66-\u0d6f\u0d70-\u0d75\u0d79\u0d7a-\u0d7f\u0d82-\u0d83\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0dcf-\u0dd1\u0dd8-\u0ddf\u0de6-\u0def\u0df2-\u0df3\u0df4\u0e01-\u0e30\u0e32-\u0e33\u0e40-\u0e45\u0e46\u0e4f\u0e50-\u0e59\u0e5a-\u0e5b\u0e81-\u0e82\u0e84\u0e87-\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa-\u0eab\u0ead-\u0eb0\u0eb2-\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0ed0-\u0ed9\u0edc-\u0edf\u0f00\u0f01-\u0f03\u0f04-\u0f12\u0f13\u0f14\u0f15-\u0f17\u0f1a-\u0f1f\u0f20-\u0f29\u0f2a-\u0f33\u0f34\u0f36\u0f38\u0f3e-\u0f3f\u0f40-\u0f47\u0f49-\u0f6c\u0f7f\u0f85\u0f88-\u0f8c\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce-\u0fcf\u0fd0-\u0fd4\u0fd5-\u0fd8\u0fd9-\u0fda\u1000-\u102a\u102b-\u102c\u1031\u1038\u103b-\u103c\u103f\u1040-\u1049\u104a-\u104f\u1050-\u1055\u1056-\u1057\u105a-\u105d\u1061\u1062-\u1064\u1065-\u1066\u1067-\u106d\u106e-\u1070\u1075-\u1081\u1083-\u1084\u1087-\u108c\u108e\u108f\u1090-\u1099\u109a-\u109c\u109e-\u109f\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fb\u10fc\u10fd-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1360-\u1368\u1369-\u137c\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166d-\u166e\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16eb-\u16ed\u16ee-\u16f0\u16f1-\u16f8\u1700-\u170c\u170e-\u1711\u1720-\u1731\u1735-\u1736\u1740-\u1751\u1760-\u176c\u176e-\u1770\u1780-\u17b3\u17b6\u17be-\u17c5\u17c7-\u17c8\u17d4-\u17d6\u17d7\u17d8-\u17da\u17dc\u17e0-\u17e9\u1810-\u1819\u1820-\u1842\u1843\u1844-\u1877\u1880-\u18a8\u18aa\u18b0-\u18f5\u1900-\u191e\u1923-\u1926\u1929-\u192b\u1930-\u1931\u1933-\u1938\u1946-\u194f\u1950-\u196d\u1970-\u1974\u1980-\u19ab\u19b0-\u19c0\u19c1-\u19c7\u19c8-\u19c9\u19d0-\u19d9\u19da\u1a00-\u1a16\u1a19-\u1a1a\u1a1e-\u1a1f\u1a20-\u1a54\u1a55\u1a57\u1a61\u1a63-\u1a64\u1a6d-\u1a72\u1a80-\u1a89\u1a90-\u1a99\u1aa0-\u1aa6\u1aa7\u1aa8-\u1aad\u1b04\u1b05-\u1b33\u1b35\u1b3b\u1b3d-\u1b41\u1b43-\u1b44\u1b45-\u1b4b\u1b50-\u1b59\u1b5a-\u1b60\u1b61-\u1b6a\u1b74-\u1b7c\u1b82\u1b83-\u1ba0\u1ba1\u1ba6-\u1ba7\u1baa\u1bae-\u1baf\u1bb0-\u1bb9\u1bba-\u1be5\u1be7\u1bea-\u1bec\u1bee\u1bf2-\u1bf3\u1bfc-\u1bff\u1c00-\u1c23\u1c24-\u1c2b\u1c34-\u1c35\u1c3b-\u1c3f\u1c40-\u1c49\u1c4d-\u1c4f\u1c50-\u1c59\u1c5a-\u1c77\u1c78-\u1c7d\u1c7e-\u1c7f\u1cc0-\u1cc7\u1cd3\u1ce1\u1ce9-\u1cec\u1cee-\u1cf1\u1cf2-\u1cf3\u1cf5-\u1cf6\u1d00-\u1d2b\u1d2c-\u1d6a\u1d6b-\u1d77\u1d78\u1d79-\u1d9a\u1d9b-\u1dbf\u1e00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u200e\u2071\u207f\u2090-\u209c\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2134\u2135-\u2138\u2139\u213c-\u213f\u2145-\u2149\u214e\u214f\u2160-\u2182\u2183-\u2184\u2185-\u2188\u2336-\u237a\u2395\u249c-\u24e9\u26ac\u2800-\u28ff\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2c7b\u2c7c-\u2c7d\u2c7e-\u2ce4\u2ceb-\u2cee\u2cf2-\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d70\u2d80-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u3005\u3006\u3007\u3021-\u3029\u302e-\u302f\u3031-\u3035\u3038-\u303a\u303b\u303c\u3041-\u3096\u309d-\u309e\u309f\u30a1-\u30fa\u30fc-\u30fe\u30ff\u3105-\u312d\u3131-\u318e\u3190-\u3191\u3192-\u3195\u3196-\u319f\u31a0-\u31ba\u31f0-\u31ff\u3200-\u321c\u3220-\u3229\u322a-\u3247\u3248-\u324f\u3260-\u327b\u327f\u3280-\u3289\u328a-\u32b0\u32c0-\u32cb\u32d0-\u32fe\u3300-\u3376\u337b-\u33dd\u33e0-\u33fe\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua014\ua015\ua016-\ua48c\ua4d0-\ua4f7\ua4f8-\ua4fd\ua4fe-\ua4ff\ua500-\ua60b\ua60c\ua610-\ua61f\ua620-\ua629\ua62a-\ua62b\ua640-\ua66d\ua66e\ua680-\ua69b\ua69c-\ua69d\ua6a0-\ua6e5\ua6e6-\ua6ef\ua6f2-\ua6f7\ua722-\ua76f\ua770\ua771-\ua787\ua789-\ua78a\ua78b-\ua78e\ua790-\ua7ad\ua7b0-\ua7b1\ua7f7\ua7f8-\ua7f9\ua7fa\ua7fb-\ua801\ua803-\ua805\ua807-\ua80a\ua80c-\ua822\ua823-\ua824\ua827\ua830-\ua835\ua836-\ua837\ua840-\ua873\ua880-\ua881\ua882-\ua8b3\ua8b4-\ua8c3\ua8ce-\ua8cf\ua8d0-\ua8d9\ua8f2-\ua8f7\ua8f8-\ua8fa\ua8fb\ua900-\ua909\ua90a-\ua925\ua92e-\ua92f\ua930-\ua946\ua952-\ua953\ua95f\ua960-\ua97c\ua983\ua984-\ua9b2\ua9b4-\ua9b5\ua9ba-\ua9bb\ua9bd-\ua9c0\ua9c1-\ua9cd\ua9cf\ua9d0-\ua9d9\ua9de-\ua9df\ua9e0-\ua9e4\ua9e6\ua9e7-\ua9ef\ua9f0-\ua9f9\ua9fa-\ua9fe\uaa00-\uaa28\uaa2f-\uaa30\uaa33-\uaa34\uaa40-\uaa42\uaa44-\uaa4b\uaa4d\uaa50-\uaa59\uaa5c-\uaa5f\uaa60-\uaa6f\uaa70\uaa71-\uaa76\uaa77-\uaa79\uaa7a\uaa7b\uaa7d\uaa7e-\uaaaf\uaab1\uaab5-\uaab6\uaab9-\uaabd\uaac0\uaac2\uaadb-\uaadc\uaadd\uaade-\uaadf\uaae0-\uaaea\uaaeb\uaaee-\uaaef\uaaf0-\uaaf1\uaaf2\uaaf3-\uaaf4\uaaf5\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uab30-\uab5a\uab5b\uab5c-\uab5f\uab64-\uab65\uabc0-\uabe2\uabe3-\uabe4\uabe6-\uabe7\uabe9-\uabea\uabeb\uabec\uabf0-\uabf9\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\ue000-\uf8ff\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\uff21-\uff3a\uff41-\uff5a\uff66-\uff6f\uff70\uff71-\uff9d\uff9e-\uff9f\uffa0-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc"+o+r+"]"),s=new RegExp("["+o+r+"]");function l(e){var t=a.exec(e);return null==t?null:t[0]}function c(e){var t=l(e);return null==t?i.NEUTRAL:s.exec(t)?i.RTL:i.LTR}function d(e,t){if(t=t||i.NEUTRAL,!e.length)return t;var n=c(e);return n===i.NEUTRAL?t:n}function u(e,t){return t||(t=i.getGlobalDir()),d(e,t)}e.exports.firstStrongChar=l,e.exports.firstStrongCharDir=c,e.exports.resolveBlockDir=d,e.exports.getDirection=u,e.exports.isDirectionLTR=function(e,t){return u(e,t)===i.LTR},e.exports.isDirectionRTL=function(e,t){return u(e,t)===i.RTL}},function(e,t,n){var i=n(7).Class,o=n(1).Util,r=n(0).config,a=n(10),s=n(4).Position,l=n(44).htmlToNode,c=n(8).Span,d=n(20).Doc,u=n(5).CONTENT_TYPES,h=n(3).PlainSection,f=n(12).CodeSection,p=n(13).UnorderedListSection,m=n(13).OrderedListSection,g=n(14).ImageSection,v=n(17).HorizontalRuleSection,b=function(e){return-1!=["OL","UL"].indexOf(e)},y=function(e){return-1!=["H1","H2","H3","H4","H5"].indexOf(e)},x=function(e){return"BLOCKQUOTE"==e},S=function(e){return e.nodeType==e.COMMENT_NODE||-1!=["STYLE","LINK","SCRIPT","TITLE"].indexOf(e.nodeName)},E=i.extend({__init__:function(e,t){this.spans=t||[],this.modifiers=a.extend(e,{}),this.indent=0,this.content=""},visit:function(e){this._enter(e),this._exit(e)},_visitChildren:function(e){for(var t=e.firstChild;null!==t;t=t.nextSibling)this.visit(t)},_enter:function(e){if("true"!==e.ariaHidden){if(o.isTextNode(e)){var t=e.textContent;return t=(t=t.replace(/\n/g," ")).replace(/ {2,}/g," "),void(this.content+=t)}"BR"!=e.nodeName.toUpperCase()?("bold"==e.style.fontWeight&&(this.modifiers.bold=!0),"italic"==e.style.fontStyle&&(this.modifiers.italic=!0),C(e)&&(this.modifiers[C(e)]=_(e)),this._visitChildren(e)):this.content+="\n"}},_exit:function(e){o.isTextNode(e)||"BR"==e.nodeName.toUpperCase()?this._createSpan():(C(e)&&delete this.modifiers[C(e)],"italic"==e.style.fontStyle&&delete this.modifiers.italic,"bold"==e.style.fontWeight&&delete this.modifiers.bold)},_createSpan:function(){var e=this.content;if(e.length){if(e=e.replace(/(\u00a0)+/gm," "),this.spans.length>0){var t=this.spans[this.spans.length-1];if(a.jsonEqual(t.modifiers,this.modifiers)){var n=t.getText();return t.setText(n+e),void(this.content="")}}this.spans.push(new c(e,this.modifiers)),this.content=""}}}),C=function(e){return{B:"bold",STRONG:"bold",I:"italic",EM:"italic",U:"italic",A:"link",CODE:"code",MATH:"math"}[e.nodeName.toUpperCase()]},_=function(e){return{B:!0,I:!0,EM:!0,U:!0,A:{type:"url",url:e.href},CODE:!0,MATH:!0}[e.nodeName.toUpperCase()]},T=function(e,t,n){var i=new E(t,n);return i.visit(e),i.spans},k=function M(e,t,n){var i,r,a="OL"==e.nodeName.toUpperCase()?m:p,s=[];n=n||0,t=t||{},o.assert(b(e.nodeName),"Unknown list type",e);for(var l=e.firstElementChild;l;l=l.nextElementSibling)"LI"==(i=l.nodeName.toUpperCase())?((r=new a(T(l,t))).setIndent(n),s.push(r)):b(i)&&(s=s.concat(M(l,t,n+1)));return s},w=function(e){var t,n,i=[],o=new f;for(i.push(o),n=e.firstChild;n;n=n.nextSibling)"BR"==n.nodeName.toUpperCase()?(o=new f,i.push(o)):(t=o.firstChild()).setText(t.getText()+n.textContent);return i},O=function(e){return function t(e,n,i,l){var c,u,f=new d({},r.clientInfo,r.options,r.platform);n=n||{},i=i||[],l=!!l;for(var p=function(){if(i.length){var e=new h(i);if(/\S/.test(e.getText())){f.appendChild(e);for(var t=e.firstChild();t;){var n=t.getText(),o=n.indexOf("\n\n");-1!=o?(t.setText(n.replace("\n\n","")),t.parent.split(new s(t,o)),t=f.lastChild().firstChild()):t=t.nextSibling()}}i.length=[]}},m=e.firstChild;m;m=m.nextSibling)if("SPAN"==(c=m.nodeName.toUpperCase())&&0!==m.textContent.length||"SUP"==c&&0!==m.textContent.length||o.isTextNode(m)||"BR"==c)T(m,n,i);else if(-1!=["B","I","U","A","EM","STRONG","MATH","CODE"].indexOf(c)){var E={};E[C(m)]=_(m),E=a.extend(E,n),f.appendChildren(t(m,E,i))}else p(),S(m)||(b(c)?f.appendChildren(k(m,n)):y(c)?f.appendChildren(t(m,a.extend({bold:!0},n),i,!0)):x(c)?((u=t(m,n,i,!0)).forEach((function(e){e.setQuoted(!0)})),f.appendChildren(u)):"HR"==c?f.appendChild(new v):"PRE"==c?f.appendChildren(w(m)):"IMG"==c?o.isValidUrl(m.src)&&m.src.startsWith("http")&&f.appendChild(g.fromURL(m.src,"html_paste",r.options.eagerImageUploading)):f.appendChildren(t(m,n,i,!0)));return l&&p(),f.destroy(),f.children.slice(1,f.children.length)}(l(e),{},[],!0)},I=function(e){var t=[];return 0===e.length?[]:(o.splitLines(e).forEach((function(e){t.push(new h([new c(e)]))})),t)};t.parseHTML=O,t.parseText=I,t.parse=function(e,t){return t==u.HTML||t==u.PUBLIC_HTML?O(e):t==u.TEXT||t==u.TEXT_URI?I(e):[]}},function(e,t,n){var i=n(33),o=n(0).config,r={};t.getTweetData=function(e,t,n){var i=function(e){for(var t=r[e]||[],n=0;n<t.length;n++){var i=t[n],o=i.getElementsByTagName("twitterwidget");if(!i.isConnected&&o.length>0)return i}return null}(e);i?t(i,!1):function(e,t,n){o.platform.makeRpc("/twitter/get_twitter_oembed_json_POST",{formkey:o.platform.getFormkey(),json:JSON.stringify({args:[],kwargs:{url:e}})}).then((function(e){"error"in e?n(e):t(e)}))["catch"](n)}(e,(function(i){if(i){var o=document.createElement("iframe");o.className="tweet-content styleable",o.srcdoc=i.value.html,t(o,!0),function(e,t){var n=r[e];n?n.push(t):r[e]=[t]}(e,o)}else n(null)}),n)};var a=t.loadEmbeds=function(e,t){s()&&i.onInit(t,(function(t){t&&t.widgets?t.widgets.load(e):o.platform.logJsError("Twitter","Error: Twitter JS initialized but widgets not available")}))};t.renderTweetIFrame=function(e){e.onload=function(){var t,n,r=e.contentDocument||e.contentWindow.document;e.contentWindow._id=i.getIframeWindowId(),t=e.contentWindow,n=function(){setTimeout((function(){e.style.height=r.body.scrollHeight+30+"px"}),300)},i.onInit(t,(function(e){e&&e.events?e.events.bind("loaded",n):o.platform.logJsError("Twitter","Error: Twitter JS initialized but events not available")})),a(r.body,e.contentWindow)}};var s=t.tweetsEnabled=function(){return!(o.clientInfo.isIOSApp&&o.clientInfo.buildNumber<742)}},function(e,t,n){var i=n(0).config,o={usesCompositionEvents:function(){return i.clientInfo.isGecko||i.clientInfo.isWebkit&&i.clientInfo.webkitVersion>532},dragEventContainsFile:function(e){var t=e.dataTransfer;return!!t&&(!!(t.files&&t.files.length>0)||!!t.types&&(!(!t.types.indexOf||-1==t.types.indexOf("Files"))||!(!t.types.contains||!t.types.contains("application/x-moz-file"))))},insertsPeriodWithDoubleSpace:function(){return i.clientInfo.isIOS}};t.Quirks=o},function(e,t,n){var i=n(7).Class,o=n(0).config,r=t.isMac=/Mac/.test(window.navigator.platform),a={8:"BACKSPACE",9:"TAB",13:"RETURN",27:"ESCAPE",35:"END",36:"HOME",37:"LEFT",38:"UP",39:"RIGHT",40:"DOWN",46:"DELETE",106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},s=i.extend({__init__:function(e){e=e.toUpperCase(),this.alt=/ALT-/.test(e),this.ctrl=/CTRL-/.test(e)||!r&&/CMD-/.test(e),this.meta=/META-/.test(e)||r&&/CMD-/.test(e),this.shift=/SHIFT-/.test(e),this.character=e.split("-").pop()},toString:function(){var e="";return this.alt&&(e+="ALT-"),this.ctrl&&(e+="CTRL-"),this.meta&&(e+="META-"),this.shift&&(e+="SHIFT-"),e+=this.character}}),l=i.extend({__init__:function(){this._handlers=[]},on:function(e,t){var n=new s(e);if(n in this._handlers)throw new Error("Already attached handler for "+n);this._handlers[n]=t},trigger:function(e){var t=function(e){var t=a[e.which]||String.fromCharCode(e.which).toUpperCase(),n="";return e.altKey&&(n+="ALT-"),e.ctrlKey&&(n+="CTRL-"),e.metaKey&&(n+="META-"),e.shiftKey&&(n+="SHIFT-"),n+=t}(e);if(o.clientInfo.isIOSApp&&"SHIFT-RETURN"===t&&(t="RETURN"),o.options.shiftReturnHard&&!o.clientInfo.isMobile){if("RETURN"===t)return!0;"SHIFT-RETURN"===t&&(t="RETURN")}var n=this._handlers[t];return!n||n(e)}});t.getShortcutHint=function(e){var t=new s(e),n="";return r?(t.meta&&(n+="&#x2318;"),t.ctrl&&(n+="^"),t.alt&&(n+="&#x2325;"),t.shift&&(n+="&#x21E7;")):(t.ctrl&&(n+="Ctrl-"),t.alt&&(n+="Alt-"),t.shift&&(n+="Shift-")),n+t.character[0]+t.character.slice(1).toLowerCase()},t.isNavigation=function(e){return-1!=[35,36,37,38,39,40].indexOf(e.which)},t.isOnlyShiftKey=function(e){return e.shiftKey&&16==e.which},t.Hub=l,t.SPECIAL_KEYS=a},function(e,t,n){var i=n(20);e.exports={Doc:i.Doc}},function(e,t){t.iterLinks=function(e,t){n(e,{callback:function(e,n){return n&&t(n,e),""}})};var n=t.linkify=function(){var e=new RegExp("(?:\\b[a-z\\d.-]+://[^<>\\s\\[\\]]+|\\b(?:(?:(?:[^\\s!@#$%^&*()_=+[\\]{}\\\\|;:'\",.<>/?]+)\\.)+(?:ac|ad|aero|ae|af|ag|ai|al|am|an|ao|aq|arpa|ar|asia|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|biz|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|cat|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|coop|com|co|cr|cu|cv|cx|cy|cz|de|dj|dk|dm|do|dz|ec|edu|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gov|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|info|int|in|io|iq|ir|is|it|je|jm|jobs|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mil|mk|ml|mm|mn|mobi|mo|mp|mq|mr|ms|mt|museum|mu|mv|mw|mx|my|mz|name|na|nc|net|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|org|pa|pe|pf|pg|ph|pk|pl|pm|pn|pro|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|su|sv|sy|sz|tc|td|tel|tf|tg|th|tj|tk|tl|tm|tn|to|tp|travel|tr|tt|tv|tw|tz|ua|ug|uk|um|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|xn--0zwm56d|xn--11b5bs3a9aj6g|xn--80akhbyknj4f|xn--9t4b11yi5a|xn--deba0ad|xn--g6w251d|xn--hgbk6aj7f53bba|xn--hlcj6aya9esc7a|xn--jxalpdlp|xn--kgbechtv|xn--zckzah|ye|yt|yu|za|zm|zw))(?:[;/][^#?<>\\s\\[\\]]*)?(?:\\?[^#<>\\s]*)?(?:#[^<>\\s]*)?(?!\\w)|(?:mailto:)?[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:(?:(?:[^\\s!@#$%^&*()_=+[\\]{}\\\\|;:'\",.<>/?]+)\\.)+(?:ac|ad|aero|ae|af|ag|ai|al|am|an|ao|aq|arpa|ar|asia|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|biz|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|cat|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|coop|com|co|cr|cu|cv|cx|cy|cz|de|dj|dk|dm|do|dz|ec|edu|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gov|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|info|int|in|io|iq|ir|is|it|je|jm|jobs|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mil|mk|ml|mm|mn|mobi|mo|mp|mq|mr|ms|mt|museum|mu|mv|mw|mx|my|mz|name|na|nc|net|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|org|pa|pe|pf|pg|ph|pk|pl|pm|pn|pro|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|su|sv|sy|sz|tc|td|tel|tf|tg|th|tj|tk|tl|tm|tn|to|tp|travel|tr|tt|tv|tw|tz|ua|ug|uk|um|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|xn--0zwm56d|xn--11b5bs3a9aj6g|xn--80akhbyknj4f|xn--9t4b11yi5a|xn--deba0ad|xn--g6w251d|xn--hgbk6aj7f53bba|xn--hlcj6aya9esc7a|xn--jxalpdlp|xn--kgbechtv|xn--zckzah|ye|yt|yu|za|zm|zw))(?:\\?[^#<>\\s]*)?(?:#[^<>\\s]*)?(?!\\w))","ig"),t=new RegExp("^[a-z\\d.-]+://","i"),n={"'":"`",">":"<",")":"(","]":"[","}":"{","\xbb":"\xab","\u203a":"\u2039"},i={callback:function(e,t){return t?'<a href="'+t+'" title="'+t+'">'+e+"</a>":e},punct_regexp:/(?:[!?.,:;'"]|(?:&|&amp;)(?:lt|gt|quot|apos|raquo|laquo|rsaquo|lsaquo);)$/};return function(o,r){r=r||{};var a,s,l,c,d,u,h,f,p,m,g,v,b="",y=[];for(s in i)r[s]===undefined&&(r[s]=i[s]);for(;a=e.exec(o);)if(l=a[0],h=(u=e.lastIndex)-l.length,!/[\/:]/.test(o.charAt(h-1))){do{f=l,v=l.substr(-1),(g=n[v])&&(p=l.match(new RegExp("\\"+g+"(?!$)","g")),m=l.match(new RegExp("\\"+v,"g")),(p?p.length:0)<(m?m.length:0)&&(l=l.substr(0,l.length-1),u--)),r.punct_regexp&&(l=l.replace(r.punct_regexp,(function(e){return u-=e.length,""})))}while(l.length&&l!==f);c=l,t.test(c)||(c=(-1!==c.indexOf("@")?c.indexOf("mailto:")?"mailto:":"":c.indexOf("irc.")?c.indexOf("ftp.")?"http://":"ftp://":"irc://")+c),d!=h&&(y.push([o.slice(d,h)]),d=u),y.push([l,c])}for(y.push([o.substr(d)]),s=0;s<y.length;s++)b+=r.callback.apply(window,y[s]);return b||o}}()},function(e,t,n){var i=n(10),o=1,r={};t.getIframeWindowId=function(){var e=o;return o+=1,e},t.onInit=function(e,t){!function(e,t){var n=e.twttr={_events:[],ready:function(e){n._events.push(e)}};r[e._id]||(r[e._id]=[]),r[e._id].push(t),i.loadJSIntoIFrame("//platform.twitter.com/widgets.js",e.document,(function(){n.ready((function(t){r[e._id].forEach((function(e){e.call(t,t)})),r[e._id]=[]}))}))}(e,t)}},function(e,t,n){var i=n(0).config;t.getOEmbedlyData=function(e,t){!function(e,t){i.platform.makeRpc("/embedly_/get_oembedly_json_POST",{formkey:i.platform.getFormkey(),json:JSON.stringify({args:[],kwargs:{url:e}})}).then((function(e){"error"in e||e&&e.value&&"error"in e.value?t(null):t(e)}))["catch"]((function(){t(null)}))}(e,(function(e){t(e||null)}))}},function(e,t){t.lineDiff=function(e,t,n){for(var i=e.length,o=t.length,r=[],a=0;a<=i;a++)r[a]=[];n=n||function(e,t){return e==t};for(var s=0,l=[[i,o]];s<l.length;){var c=l[s++],d=c[0],u=c[1],h=null,f=null;r[d][u]||(d>=i&&u>=o?r[d][u]=[]:(d<i&&u<o&&n(e[d],t[u])?h=r[d+1][u+1]:(d<i&&(h=[{type:"remove",index:d}].concat(r[d+1][u])),u<o&&(f=[{type:"insert",index:u}].concat(r[d][u+1]),(!h||f.length<h.length)&&(h=f))),r[d][u]=h),d>0&&!r[d-1][u]&&l.push([d-1,u]),u>0&&!r[d][u-1]&&l.push([d,u-1]),d>0&&u>0&&!r[d-1][u-1]&&l.push([d-1,u-1]))}return r[0][0]}},function(e,t,n){var i=n(7).Class.extend({__init__:function(e){this.current={state:e,next:null,prev:null}},state:function(){return this.current.state},add:function(e){this.current.next&&(this.current.next.prev=null),this.current.next={state:e,prev:this.current,next:null},this.current=this.current.next},undo:function(){this.current.prev&&(this.current=this.current.prev)},redo:function(){this.current.next&&(this.current=this.current.next)},canUndo:function(){return!!this.current.prev},canRedo:function(){return!!this.current.next}});t.UndoManager=i},function(e,t,n){var i=n(30),o=n(10).extend,r={Backspace:"backspace",Delete:"delete",Return:"return","Alt-Return":"return","Ctrl-Return":"return","Shift-Return":"soft-return"," ":"space",Tab:"indent","Shift-Tab":"deindent","Cmd-B":"bold","Cmd-I":"italic","Cmd-U":"underline","Cmd-K":"link","Cmd-Shift-7":"ordered_list","Cmd-Shift-8":"unordered_list","Cmd-Shift-9":"quote","Cmd-Shift-K":"code","Cmd-Shift-L":"math","Cmd-Z":"undo","Cmd-Shift-Z":"redo"};i.isMac?o(r,{"Ctrl-H":"backspace","Ctrl-D":"delete","Ctrl-K":"delete-forward","Cmd-Backspace":"delete-backward","Ctrl-T":"transpose","Ctrl-Backspace":"backspace","Ctrl-Delete":"delete","Shift-Backspace":"backspace","Shift-Delete":"delete","Alt-Backspace":"delete-previous-word","Alt-Delete":"delete-next-word","Ctrl-U":"underline"}):o(r,{"Ctrl-Backspace":"delete-previous-word","Ctrl-Delete":"delete-next-word","Shift-Backspace":"backspace","Shift-Delete":"delete","Alt-Backspace":"backspace","Alt-Delete":"delete"}),t.SHORTCUTS=r},function(e,t,n){var i=n(7).Class,o=n(11).canForceModifier,r=n(10);t.FormattingState=i.extend({__init__:function(e){this._modifiers={},this.update(e)},is:function(e){return e in this._modifiers},update:function(e){this.updatePosition(e);var t=e.getCoveringSpans(),n=Object.keys(e.start.span.getModifiers()).filter((function(e){return t.every((function(t){return t.hasModifier(e)||!o(t,e)}))}));this._modifiers={};var i=this;n.forEach((function(t){i._modifiers[t]=e.start.span.getModifier(t)})),this._isLinked()||(delete this._modifiers.link,delete this._modifiers.citation)},updatePosition:function(e){this.caret=e,this.position=e.start.clone(),this.spanText=e.start.span.getText()},_isLinked:function(){var e=this.caret.start.span;return!(!e.hasModifier("link")&&!e.hasModifier("citation"))&&(this.caret.isCollapsed()?!this.caret.start.atSpanStart()&&!this.caret.start.atSpanEnd():e==this.caret.end.span)},toggleModifier:function(e,t){t in this._modifiers?delete this._modifiers[t]:"link"!=t&&"citation"!=t&&(this._modifiers[t]=!0),this.position=e.start.clone()},hasChanged:function(e){return!r.jsonEqual(this._modifiers,e.start.span.getModifiers())&&this.spanText!=e.start.span.getText()},apply:function(e){var t=!r.jsonEqual(e.modifiers,this._modifiers);return e.removeAllModifiers(),e.updateModifiers(this._modifiers),t}})},function(e,t,n){var i=n(7).Class,o=n(1).Util,r=n(10),a=n(21).rangy,s=n(8).Span,l=n(6).Section,c=n(20),d=n(4).Position,u=n(16).Selection,h=n(0).config,f=function(e,t,n){var i="Failed to set range safe="+n+": ";i+="("+(o.isTextNode(e)?e.textContent:e.outerHTML)+") "+t,h.platform.logJsError("IndexSizeError",i)},p=function(e,t,n){try{try{e.setStart(t,n)}catch(i){0==t.textContent.length&&e.setStart(t,0),f(t,n,!1)}}catch(i){f(t,n,!0)}},m=function(e,t,n){try{try{e.setEnd(t,n)}catch(i){0==t.textContent.length&&e.setEnd(t,0),f(t,n,!1)}}catch(i){f(t,n,!0)}};t.Caret=i.extend({__init__:function(e,t,n){this.selection=new u(e,t,n),this.doc=n;var i=this;Object.defineProperty(i,"start",{get:function(){return i.selection.start},set:function(e){i.selection=new u(e,i.end)}}),Object.defineProperty(i,"end",{get:function(){return i.selection.end},set:function(e){i.selection=new u(i.start,e)}})},toJSON:function(){return this.selection.toJSON()},getStartNode:function(){return this.selection.getStartNode()},getEndNode:function(){return this.selection.getEndNode()},moveStart:function(e){return this.selection.moveStart(e)},moveEnd:function(e){return this.selection.moveEnd(e)},move:function(e,t,n){t=t||e;var i=!0;return this.start.equals(e)&&this.end.equals(t)&&(i=!1),this.start.span=e.span,this.start.offset=e.offset,this.end.span=t.span,this.end.offset=t.offset,this._apply(n),i},isCollapsed:function(){return this.selection.isCollapsed()},charBefore:function(){return this.selection.charBefore()},hasCharBefore:function(){return this.selection.hasCharBefore()},previousTextUntil:function(e){return this.selection.previousTextUntil(e)},charAfter:function(){return this.selection.charAfter()},charPosition:function(){return this.selection.charPosition()},hasCharAfter:function(){return this.selection.hasCharAfter()},updateAndroidCaretPosition:function(e){e=e||0,h.clientInfo.isMobile&&h.clientInfo.isAndroidApp&&h.platform.sendMessage&&h.platform.sendMessage("setCaretPos",{selectionStart:this.charPosition()+e})},update:function(e){var t,n,i,o=a.getSelection();return!!o.anchorNode&&(o.isCollapsed?t=n=this._fromNode(o.anchorNode,o.anchorOffset):(i=o.getRangeAt(0),t=this._fromNode(i.startContainer,i.startOffset),n=this._fromNode(i.endContainer,i.endOffset)),!(!t||!n)&&this.move(t,n,e))},_fromNode:function(e,t){var n,i,o,r;if(!this.doc.contains(e)){if(!(h.clientInfo.isMobile&&h.clientInfo.isAndroidApp&&h.clientInfo.osVersion<4.4))return null;for(var a=e;a&&!c.Doc.is(a);)a=a.parentNode;if(!a)return null}if(c.Doc.is(e))r=c.Doc.get(e),0===t?(i=r.firstChild().firstChild(),o=0):o=(i=r.lastChild().lastChild()).getLength();else if(l.is(e))n=l.get(e),0===t?(i=n.firstChild(),o=0):o=(i=n.lastChild()).getLength();else if(!s.is(e.parentNode)||1!==t&&0!==t){for(;e&&!s.is(e);)e=e.parentNode;if(!e)return null;i=s.get(e),o=t}else i=s.get(e.parentNode),o=0===t?0:i.getLength();return new d(i,o)},_apply:function(e){var t,n,i,o,r=a.getSelection(),s=this.getStartNode();if(this.isCollapsed()){if(!e&&r.isCollapsed&&s==r.anchorNode&&this.start.offset==r.anchorOffset)return;o=a.createRange(),p(o,s,this.start.offset),m(o,s,this.start.offset),o.collapse(!0),r.removeAllRanges(),r.addRange(o)}else{if(t=this.end.span.getFocusNode(),r.isCollapsed)o=a.createRange();else if(o=r.getRangeAt(0),n=this._fromNode(o.startContainer,o.startOffset),i=this._fromNode(o.endContainer,o.endOffset),!e&&n&&i&&this.start.equals(n)&&this.end.equals(i))return;p(o,s,this.start.offset),m(o,t,this.end.offset),r.removeAllRanges(),r.addRange(o)}},getAbsolutePosition:function(e){var t=window.getSelection(),n=o.firstScrollingParent(this.doc.node),i=o.closestRelativeAncestor(this.doc.node),r=(document.body.parentElement,t.rangeCount>0&&t.getRangeAt(0)),s=r?r.getClientRects():[];if(r&&0===s.length&&(s=r.startContainer.getClientRects()),s.length>0){var l={top:s[0].top,left:s[0].left};if(e&&i){var c=o.getOffset(i);l.top-=c.top,l.left-=c.left}else l.top+=n.scrollTop-n.getClientRects()[0].top,l.left+=n.scrollLeft-n.getClientRects()[0].left;return l}var d=a.getSelection().anchorNode;return o.isTextNode(d)&&(d=this.start.span.parent.node),d&&d.children.length&&"img"==d.children[0].tagName.toLowerCase()?o.getOffset(d.children[0]):o.getContainerOffset(d,n)},scrollIntoViewIfNeeded:function(){if(this.isCollapsed()&&a.getSelection().anchorNode){var e=o.firstScrollingParent(this.doc.node),t=e.clientHeight||window.innerHeight;if(h.clientInfo.isIOS&&!h.clientInfo.isUIWebView&&(t=Math.max(document.documentElement.clientHeight,t)),h.clientInfo.isIOSMobileWeb){var n=window.innerHeight>window.innerWidth;window.navigator.userAgent.indexOf("iPad")>=0?t-=n?325:410:t-=n?265:200}var i,r,s=this.getAbsolutePosition(),l=document.body.parentElement,c=e.scrollTop||l.scrollTop,d=c+t;h.clientInfo.isMobile||(d-=50),s&&(i=s.top,r=i+36,setTimeout((function(){i<c?e?e.scrollTop+=i-c:l.scrollTop+=i-c:r>d&&(e?e.scrollTop+=r-d:l.scrollTop+=r-d)}),0))}},containsEntireSection:function(e){return this.selection.containsEntireSection(e)},mergeAdjacentSpans:function(){if(this.isCollapsed()){var e=this.start.span,t=e.nextSibling(),n=e.previousSibling(),i=this.start.offset;t&&r.jsonEqual(e.modifiers,t.modifiers)&&(e.setText(e.getText()+t.getText()),t.parent.removeChild(t),this.move(new d(e,i))),n&&r.jsonEqual(e.modifiers,n.modifiers)&&(i+=n.getLength(),e.setText(n.getText()+e.getText()),n.parent.removeChild(n),this.move(new d(e,i)))}},getCoveringSpans:function(){return this.selection.getCoveringSpans()}})},function(e,t,n){var i=n(7).Class;t.EventEmitter=i.extend({on:function(e,t){this.__handlers=this.__handlers||{},this.__handlers[e]=this.__handlers[e]||[],this.__handlers[e].push(t)},off:function(e,t){if(this.__handlers&&this.__handlers[e]){var n=this.__handlers[e].indexOf(t);-1!=n&&this.__handlers[e].splice(n,1)}},once:function(e,t){this.__onceHandlers=this.__onceHandlers||{},this.__onceHandlers[e]=this.__onceHandlers[e]||[],this.__onceHandlers[e].push(t)},trigger:function(e,t){for(var n=this.__handlers&&this.__handlers[e]||[],i=[],o=0;o<n.length;o++)try{i.push(n[o].apply(null,t||[]))}catch(a){console.error(a)}for(var r=this.__onceHandlers&&this.__onceHandlers[e]||[];0!==r.length;)try{i.push(r.pop().apply(null,t||[]))}catch(a){console.error(a)}return i}})},function(e,t){t.qtextDocStyles='\n.doc {\n  /* We disable selection on mobile by default, so have to reset here */\n  -webkit-user-select: auto;\n  min-height: 100px;\n  background-color: transparent;\n  counter-reset: indent0 indent1 indent2 citation;\n}\n.doc div {\n  -webkit-user-select: auto;\n}\n.doc.empty:before {\n  content: attr(data-placeholder);\n  color: #949494;\n  position: absolute;\n}\n\n.u-layout-direction--ltr .editor_padding_reset .doc.empty:before {\n  left: 0;\n}\n\n.u-layout-direction--rtl .editor_padding_reset .doc.empty:before {\n  right: 0;\n}\n\n.doc:focus {\n  outline: none;\n}\n\n.doc .section {\n  position: relative;\n  counter-reset: indent0 indent1 indent2;\n  padding: 1em 0 0;\n}\n.doc .section:first-child {\n  padding-top: 0;\n}\n.doc .section[data-type="unordered-list"],\n.doc .section[data-type="ordered-list"],\n.doc .section[data-type="math"],\n.doc .section[data-type="code"] {\n  padding: 0;\n}\n.doc .section[data-type="yt-embed"] .span.image img {\n  margin-top: -45px;\n}\n.doc .section:not([data-type="math"]) + [data-type="math"] {\n  margin-top: 1em;\n}\n.doc .section:not([data-type="code"]) + [data-type="code"] {\n  counter-reset: indent0 indent1 indent2 linenumber;\n  padding-top: 1em;\n}\n.doc .section:not([data-type="code"]) + [data-type="code"]:before {\n  top: 1em;\n}\n.doc .section:not([data-type="code"]) + [data-type="code"]:after {\n  content: \'\';\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  height: 1em;\n  background: #fff;\n}\n\n.q-color-mode--dark .doc .section:not([data-type="code"]) + [data-type="code"]:after {\n  background: #181818;\n}\n\n.doc .section:not([data-quoted="true"]) + [data-quoted="true"] {\n  margin-top: 1em;\n  padding-top: 0;\n}\n.doc .section:not([data-type="unordered-list"]) + [data-type="unordered-list"],\n.doc .section:not([data-type="ordered-list"]) + [data-type="ordered-list"] {\n  padding-top: 1em;\n}\n.doc .section[data-type="unordered-list"],\n.doc .section[data-type="ordered-list"] {\n  margin-right: 2em;\n  padding-top: 0.7em;\n}\n.doc .section[data-type="unordered-list"][data-indent="0"][data-dir=\'LTR\'],\n.doc .section[data-type="ordered-list"][data-indent="0"][data-dir=\'LTR\'] {\n  margin-left: 2em;\n}\n.doc .section[data-type="unordered-list"][data-indent="1"][data-dir=\'LTR\'],\n.doc .section[data-type="ordered-list"][data-indent="1"][data-dir=\'LTR\'] {\n  margin-left: 4em;\n}\n.doc .section[data-type="unordered-list"][data-indent="2"][data-dir=\'LTR\'],\n.doc .section[data-type="ordered-list"][data-indent="2"][data-dir=\'LTR\'] {\n  margin-left: 6em;\n}\n.doc .section[data-type="unordered-list"][data-indent="0"][data-dir=\'RTL\'],\n.doc .section[data-type="ordered-list"][data-indent="0"][data-dir=\'RTL\'] {\n  margin-right: 2em;\n}\n.doc .section[data-type="unordered-list"][data-indent="1"][data-dir=\'RTL\'],\n.doc .section[data-type="ordered-list"][data-indent="1"][data-dir=\'RTL\'] {\n  margin-right: 4em;\n}\n.doc .section[data-type="unordered-list"][data-indent="2"][data-dir=\'RTL\'],\n.doc .section[data-type="ordered-list"][data-indent="2"][data-dir=\'RTL\'] {\n  margin-right: 6em;\n}\n.doc .section[data-type="unordered-list"] {\n  display: list-item;\n}\n.doc .section[data-type="unordered-list"][data-indent="0"] {\n  list-style-type: disc;\n}\n.doc .section[data-type="unordered-list"][data-indent="1"] {\n  list-style-type: circle;\n}\n.doc .section[data-type="unordered-list"][data-indent="2"] {\n  list-style-type: square;\n}\n.doc .section[data-type="ordered-list"] {\n  counter-reset: indent0;\n}\n.doc .section[data-type="ordered-list"]:before {\n  box-sizing: border-box;\n  position: absolute;\n  width: 3em;\n}\n.doc .section[data-type="ordered-list"][data-dir=\'LTR\']:before {\n  left: -3em;\n  padding-right: 0.5em;\n  text-align: right;\n  direction: ltr;\n}\n.doc .section[data-type="ordered-list"][data-dir=\'RTL\']:before {\n  right: -3em;\n  padding-left: 0.5em;\n  text-align: left;\n  direction: rtl;\n}\n.doc .section[data-type="ordered-list"][data-indent="0"] {\n  counter-increment: indent0;\n  counter-reset: indent1;\n}\n.doc .section[data-type="ordered-list"][data-indent="0"]::before {\n  content: counter(indent0, decimal) ".";\n}\n.doc .section[data-type="ordered-list"][data-indent="1"] {\n  counter-increment: indent1;\n  counter-reset: indent2;\n}\n.doc .section[data-type="ordered-list"][data-indent="1"]::before {\n  content: counter(indent1, lower-alpha) ".";\n}\n.doc .section[data-type="ordered-list"][data-indent="2"] {\n  counter-increment: indent2;\n  counter-reset: none;\n}\n.doc .section[data-type="ordered-list"][data-indent="2"]:before {\n  content: counter(indent2, lower-roman) ".";\n}\n.doc .section[data-quoted="true"][data-dir=\'LTR\'] {\n  color: #666;\n  border-left: 2px solid #e2e2e2;\n  padding-left: 1em;\n}\n.doc .section[data-quoted=\'true\'][data-dir=\'RTL\'] {\n  color: #666;\n  border-right: 2px solid #e2e2e2;\n  padding-right: 1em;\n}\n\n.q-color-mode--dark .doc .section[data-quoted=\'true\'] {\n    border-color: rgba(255, 255, 255, .5);\n    color: inherit;\n    opacity: .8;\n}\n\n.doc .section[data-quoted="true"][data-type="code"][data-dir=\'LTR\'] {\n  padding-left: 1.4em;\n}\n.doc .section[data-quoted="true"][data-type="code"][data-dir=\'RTL\'] {\n  padding-right: 1.4em;\n}\n.doc .section[data-quoted="true"][data-type="code"]:before {\n  content: \'\';\n  position: absolute;\n  left: 0;\n  top: 0;\n  bottom: 0;\n  background-color: #fff;\n  width: 1em;\n}\n.doc .section[data-quoted="true"][data-type="code"]:after {\n  content: none;\n}\n.doc .section[data-quoted="true"][data-type="unordered-list"][data-dir=\'LTR\'] {\n  margin-left: 2em;\n  padding-left: 0;\n  border-left: 0;\n}\n.doc .section[data-quoted="true"][data-type="unordered-list"][data-dir=\'RTL\'] {\n  margin-right:2em;\n  padding-right:0;\n  border-right:0\n}\n.doc .section[data-quoted="true"][data-type="unordered-list"]:before {\n  content: \'\';\n  position: absolute;\n  top: 0;\n  bottom: 0;\n}\n.doc .section[data-quoted="true"][data-type="unordered-list"][data-dir=\'LTR\']:before {\n  border-left: 2px solid #e2e2e2;\n  left: 0;\n}\n.doc .section[data-quoted="true"][data-type="unordered-list"][data-dir=\'RTL\']:before {\n  border-right:2px solid #e2e2e2;\n  right:0;\n}\n.doc .section[data-quoted="true"][data-type="unordered-list"][data-indent="0"][data-dir=\'LTR\'] {\n  margin-left: 3em;\n}\n.doc .section[data-quoted="true"][data-type="unordered-list"][data-indent="0"][data-dir=\'RTL\'] {\n  margin-right: 3em;\n}\n.doc .section[data-quoted="true"][data-type="unordered-list"][data-indent="0"][data-dir=\'LTR\']:before {\n  left: -3em;\n}\n.doc .section[data-quoted="true"][data-type="unordered-list"][data-indent="0"][data-dir=\'RTL\']:before {\n  right: -3em;\n}\n.doc .section[data-quoted="true"][data-type="unordered-list"][data-indent="1"][data-dir=\'LTR\'] {\n  margin-left: 5em;\n}\n.doc .section[data-quoted="true"][data-type="unordered-list"][data-indent="1"][data-dir=\'RTL\'] {\n  margin-right: 5em;\n}\n.doc .section[data-quoted="true"][data-type="unordered-list"][data-indent="1"][data-dir=\'LTR\']:before {\n  left: -5em;\n}\n.doc .section[data-quoted="true"][data-type="unordered-list"][data-indent="1"][data-dir=\'RTL\']:before {\n  right: -5em;\n}\n.doc .section[data-quoted="true"][data-type="unordered-list"][data-indent="2"][data-dir=\'LTR\'] {\n  margin-left: 7em;\n}\n.doc .section[data-quoted="true"][data-type="unordered-list"][data-indent="2"][data-dir=\'RTL\'] {\n  margin-right: 7em;\n}\n.doc .section[data-quoted="true"][data-type="unordered-list"][data-indent="2"][data-dir=\'LTR\']:before {\n  left: -7em;\n}\n.doc .section[data-quoted="true"][data-type="unordered-list"][data-indent="2"][data-dir=\'RTL\']:before {\n  right: -7em;\n}\n.doc .section[data-quoted="true"][data-type="ordered-list"][data-dir=\'LTR\'] {\n  margin-left: 0;\n  border-left: 2px solid #e2e2e2;\n}\n.doc .section[data-quoted="true"][data-type="ordered-list"][data-dir=\'RTL\'] {\n  margin-right: 0;\n  border-right: 2px solid #e2e2e2;\n}\n.doc .section[data-quoted="true"][data-type="ordered-list"][data-indent="0"][data-dir=\'LTR\'] {\n  padding-left: 3em;\n}\n.doc .section[data-quoted="true"][data-type="ordered-list"][data-indent="0"][data-dir=\'RTL\'] {\n  padding-right: 3em;\n}\n.doc .section[data-quoted="true"][data-type="ordered-list"][data-indent="0"][data-dir=\'LTR\']:before {\n  left: 0;\n}\n.doc .section[data-quoted="true"][data-type="ordered-list"][data-indent="0"][data-dir=\'RTL\']:before {\n  right: 0;\n}\n.doc .section[data-quoted="true"][data-type="ordered-list"][data-indent="1"][data-dir=\'LTR\'] {\n  padding-left: 5em;\n}\n.doc .section[data-quoted="true"][data-type="ordered-list"][data-indent="1"][data-dir=\'RTL\'] {\n  padding-right: 5em;\n}\n.doc .section[data-quoted="true"][data-type="ordered-list"][data-indent="1"][data-dir=\'LTR\']:before {\n  left: 2em;\n}\n.doc .section[data-quoted="true"][data-type="ordered-list"][data-indent="1"][data-dir=\'RTL\']:before {\n  right: 2em;\n}\n.doc .section[data-quoted="true"][data-type="ordered-list"][data-indent="2"][data-dir=\'LTR\'] {\n  padding-left: 7em;\n}\n.doc .section[data-quoted="true"][data-type="ordered-list"][data-indent="2"][data-dir=\'RTL\'] {\n  padding-right: 7em;\n}\n.doc .section[data-quoted="true"][data-type="ordered-list"][data-indent="2"][data-dir=\'LTR\']:before {\n  left: 4em;\n}\n.doc .section[data-quoted="true"][data-type="ordered-list"][data-indent="2"][data-dir=\'RTL\']:before {\n  right: 4em;\n}\n.doc .section[data-type="horizontal-rule"] {\n  text-align: center;\n}\n.doc .section[data-type="horizontal-rule"] .span.image {\n  padding: 5px;\n}\n.doc .section[data-type="image"] .span.image.uploading img {\n  opacity: 0.3;\n}\n.doc .span {\n  display: inline;\n}\n.doc .span .content {\n  display: inline;\n}\n.doc .span.bold {\n  font-weight: bold;\n}\n.doc .span.italic {\n  font-style: italic;\n}\n.doc .span.link {\n  color: #2b6dad;\n}\n.doc .span.citation {\n  color: #28d;\n  counter-increment: citation;\n}\n.doc .span.citation:before {\n  content: "[" counter(citation) "]";\n  font-size: 13px;\n  vertical-align: super;\n  line-height: 1;\n}\n.doc .span.link.active,\n.doc .span.citation.active {\n  text-decoration: underline;\n}\n.doc .span.image {\n  display: inline-block;\n  color: inherit;\n  cursor: pointer;\n  line-height: 0;\n  position: relative;\n  max-width: 100%;\n}\n.doc .span.image img {\n  max-width: 100%;\n}\n.doc .span.image.active:after {\n  background-color: rgba(0, 140, 255, 0.3);\n  border: 3px solid #28D;\n}\n.doc .span.playable .content {\n  padding-bottom: 56.25%;\n  height: 0;\n  overflow: hidden;\n  display: inline-block;\n}\n.doc .span.playable .content:before {\n  content: "";\n  display: block;\n  position: absolute;\n  background: url(/static/ans_frontend_assets/images/play3.png) center center no-repeat;\n  height: 100%;\n  width: 100%;\n  left: 0;\n  top: 0;\n  z-index: 10;\n}\n.doc .span.playable .content iframe,\n.doc .span.playable .content .embed {\n  position: absolute;\n  top: 0;\n  left: 0;\n  border: none;\n  width: 100%;\n  height: 100%;\n}\n.doc .span.playable .content img {\n  width: 100%;\n}\n.doc .span.iframe iframe {\n  border: none;\n  width: 100%;\n  display: block;\n  margin: 0 auto;\n  pointer-events: none;\n}\n.doc .section[data-type=\'heading\'] {\n  /* TODO(kjopek) this is temp styling. confirm with design later */\n  font-size: 20px;\n  font-weight: 700;\n}\n.doc .section[data-type=\'code\'],\n.doc .span.code {\n  font-family: monospace;\n  background-color: #f6f6f6;\n  color: #666;\n  font-size: 13px;\n}\n.q-color-mode--dark .doc .section[data-type=\'code\'],\n.q-color-mode--dark .doc .span.code {\n  background-color: rgba(255, 255, 255, .1);\n  color: inherit;\n}\n\n.doc .section[data-dir=\'LTR\'] {\n  direction: ltr;\n  text-align: left;\n}\n.doc .section[data-dir=\'RTL\'] {\n  direction: rtl;\n  text-align: right;\n}\n.doc .section[data-type=\'code\'] {\n  padding-left: 3em;\n  counter-increment: linenumber;\n}\n\n.doc .section[data-type=\'code\'] li {\n  margin: 0;\n}\n\n.doc .section[data-type=\'code\']:before {\n  content: counter(linenumber);\n  position: absolute;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  width: 2em;\n  padding-right: 0.3em;\n  text-align: right;\n  color: #949494;\n  background: #e6e6e6;\n}\n.q-color-mode--dark .doc .section[data-type=\'code\']:before {\n  color: inherit;\n  background: rgba(255, 255, 255, .05);\n}\n\n.doc .section[data-type=\'math\'],\n.doc .span.math {\n  font-family: monospace;\n  background-color: #e6e7e8;\n  padding: 2px 4px;\n  border-radius: 3px;\n}\n\n.q-color-mode--dark .doc .section[data-type=\'math\'],\n.q-color-mode--dark .doc .span.math {\n  background-color: rgba(255, 252, 224, .1);\n}\n\n.doc .section[data-type=\'math\'],\n.doc .section[data-type=\'code\'],\n.doc .span.math,\n.doc .span.code {\n  direction: ltr;\n  text-align: left;\n  unicode-bidi: isolate;\n}\n.doc .section[data-type=\'math\'].bold,\n.doc .section[data-type=\'code\'].bold,\n.doc .span.math.bold,\n.doc .span.code.bold,\n.doc .section[data-type=\'math\'].italic,\n.doc .section[data-type=\'code\'].italic,\n.doc .span.math.italic,\n.doc .span.code.italic,\n.doc .section[data-type=\'math\'].link,\n.doc .section[data-type=\'code\'].link,\n.doc .span.math.link,\n.doc .span.code.link,\n.doc .section[data-type=\'math\'] .bold,\n.doc .section[data-type=\'code\'] .bold,\n.doc .span.math .bold,\n.doc .span.code .bold,\n.doc .section[data-type=\'math\'] .italic,\n.doc .section[data-type=\'code\'] .italic,\n.doc .span.math .italic,\n.doc .span.code .italic,\n.doc .section[data-type=\'math\'] .link,\n.doc .section[data-type=\'code\'] .link,\n.doc .span.math .link,\n.doc .span.code .link {\n  font-weight: normal;\n  font-style: normal;\n  text-decoration: none;\n  color: inherit;\n  background: inherit;\n  padding: 0;\n  margin: 0;\n}\n\n.qtext2_tooltip {\n  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;\n  font-weight: bold;\n  position: absolute;\n  padding: 4px 8px;\n  font-size: 12px;\n  background: #000;\n  color: #fff;\n  border-radius: 2px;\n  white-space: nowrap;\n  max-width: 400px;\n  overflow: hidden;\n  box-sizing: border-box;\n  z-index: 1650;\n\n  direction: ltr;\n  unicode-bidi: isolate;\n\n  display: none;\n  opacity: 0;\n  -webkit-transition: opacity 55ms ease-in;\n  -o-transition: opacity 55ms ease-in;\n  transition: opacity 55ms ease-in;\n}\n\n.qtext2_tooltip.visible {\n  display: block;\n  opacity: 1;\n}\n\n.qtext2_tooltip a {\n  color: #ddd;\n}\n\n.doc .span .content.section_content_container {\n  position: relative;\n  display: inline-block;\n  user-select: none;\n  -webkit-user-select: none;\n}\n\n.doc .span.hyperlink_embed .content.section_content_container,\n.doc .span.tweet .content.section_content_container,\n.doc .span.react_placeholder .content.section_content_container {\n  width: 100%;\n}\n\n.doc .span .content.react_upload_failed_container img {\n  min-height: 120px;\n  min-width: 200px;\n}\n\n.doc .span .content.section_content_container.react_upload_failed_container {\n  position: relative;\n}\n\n.doc .span .content.section_content_container .section_remove_btn {\n  position: absolute;\n  top: 0;\n  right: 0;\n  cursor: pointer;\n  background-color: #000;\n  color: #fff;\n  border: 1px #000 solid;\n  text-align: center;\n  width: 24px;\n  height: 24px;\n  line-height: 24px;\n  border-radius: 100%;\n  user-select: none;\n  -webkit-user-select: none;\n  z-index: 10;\n}\n\n.doc.dark_mode .span .content.section_content_container .section_remove_btn {\n  background-color: #ccc;\n  color: #000;\n}\n\n.doc .span .content.section_content_container .section_remove_btn:after {\n  content: \'\\2715\';\n  user-select: none;\n  -webkit-user-select: none;\n  font-size: 22px;\n}\n\n.doc .span .content .title_wrapper {\n  display: flex;\n  justify-content: space-between;\n  padding: 4px 8px;\n}\n\n.doc .span .content .buttons_container {\n  display: flex;\n}\n\n.loading_dot_container {\n  display: flex;\n  justify-content: center;\n}\n\n.loading_dot {\n  width: 10px;\n  height: 10px;\n  background-color: #ccc;\n  border-radius: 100%;\n  display: inline-block;\n  -webkit-animation: sk-three-bounce 1.4s ease-in-out 0s infinite both;\n  animation: sk-three-bounce 1.4s ease-in-out 0s infinite both;\n  width: 8px;\n  height: 8px;\n  margin-left: 2px;\n  margin-right: 2px;\n}\n\n@-webkit-keyframes sk-three-bounce {\n  0%,\n  80%,\n  100% {\n    -webkit-transform: scale(0);\n    transform: scale(0);\n  }\n  40% {\n    -webkit-transform: scale(1);\n    transform: scale(1);\n  }\n}\n\n@keyframes sk-three-bounce {\n  0%,\n  80%,\n  100% {\n    -webkit-transform: scale(0);\n    transform: scale(0);\n  }\n  40% {\n    -webkit-transform: scale(1);\n    transform: scale(1);\n  }\n}\n\n.loading_dot.first {\n  -webkit-animation-delay: -0.32s;\n  animation-delay: -0.32s;\n}\n\n.loading_dot.second {\n  -webkit-animation-delay: -0.16s;\n  animation-delay: -0.16s;\n}\n'},function(e,t,n){var i=n(20).Doc,o=n(6).Section,r=n(3).PlainSection,a=n(8).Span,s=n(4).Position,l=n(1).Util,c=n(10).extend,d=n(7).Class,u=n(0).config;t.MutationFixer=d.extend({__init__:function(e){this.doc=e;try{var t=n(43);this.mutationSummary=new t.MutationSummary({rootNode:e.node,observeOwnChanges:!1,queries:[{all:!0}],callback:this.handleMutationSummaries.bind(this)})}catch(i){}},pause:function(){this.mutationSummary.disconnect()},resume:function(){this.mutationSummary.reconnect()},handleMutationSummaries:function(e){var t=e[0];this.handleNodesAdded(t),this.handleNodesRemoved(t),this.handleNodeAttributeChanges(t),this.doc.hasBeenModified()&&this.doc.trigger("meaningfulChange")},handleNodesAdded:function(e){var t=e.added;if(t&&0!==t.length){var n=this;t.forEach((function(e){try{n._handleNodeAdded(e)}catch(t){t.stack}}))}},_handleNodeAdded:function(e){var t;3==e.nodeType&&this.isQText2SpanContent(e.parentElement)&&!u.clientInfo.isIOSApp&&e.parentElement.normalize(),this.isValidQText2Node(e)||e.parentElement&&(this.isValidQText2Node(e.parentElement)?(e.parentElement,this.isQText2SpanContent(e.parentElement)?t=this._handleNodeAddedToSpanContent(e):this.isQText2Span(e.parentElement)?t=this._handleNodeAddedToSpan(e,this.getQText2Span(e.parentElement)):this.isQText2Container(e.parentElement)?t=this._handleNodeAddedToContainer(e,this.getQText2Container(e.parentElement)):e.parentElement,t&&this.doc.moveCaret(t)):e.parentElement)},_handleNodeAddedToSpanContent:function(e){var t,n,i,o,r,s=this.getQText2Span(e.parentElement.parentElement),l=this._getModifiersFromNode(e);if(this.nodeShouldBeSingleChild(e))return t=s.parent,i=(n=s.previous())?n.last():s.next().first(),t.removeChild(s),i;for(t=s.parent,o=e.parentElement.childNodes[0],r=!0;o;)o==e?r=!1:t.insertBefore(new a(o.textContent,s.modifiers),r?s:s.nextSibling()),o=o.nextSibling;return s.setText(e.textContent),this._applyModifier(s,l),this.safeRemoveNodeFromDom(e),s.last()},_handleNodeAddedToSpan:function(e,t,n){n=c(this._getModifiersFromNode(e),n||{});for(var i=t.node.textContent,o=e,r=e.textContent.length;o.previousSibling;)r+=(o=o.previousSibling).textContent.length;for(var a=Array.prototype.slice.call(t.node.childNodes),l=0;l<a.length;l++)a[l]!=t._content&&this.safeRemoveNodeFromDom(a[l]);return t._content||(t._content=t.createContentNode()),t.node!=t._content.parentElement&&t.node.appendChild(t._content),t.setText(i),this._applyModifier(t,n),new s(t,r)},_handleNodeAddedToContainer:function(e,t,n){n=c(this._getModifiersFromNode(e),n||{});var i,o,s,d,u=this.doc;if(!t.hasChild(this.getQText2Container(e))){t.children.forEach((function(e){u.contains(e.node)||t.removeChild(e)})),l.isTextNode(e)?("section"==t.kind?o=i=new a(e.textContent,n):"doc"==t.kind&&(i=new a(e.textContent,n),o=new r([i])),this._replaceNodeWithContainer(e,o,t),d=o.last()):"BR"==e.nodeName&&("section"==t.kind?d=this._splitSectionAtNode(e,t):"doc"==t.kind&&(o=new r,this._replaceNodeWithContainer(e,o,t),d=o.first())),s=this._emptyNodeContents(e);for(var h=0;h<s.length;h++)d=this._handleNodeAddedToContainer(s[h],t,n);return d}this._applyModifiersToContainer(this.getQText2Container(e),n)},_emptyNodeContents:function(e){for(var t=Array.prototype.slice.call(e.childNodes),n=0;n<t.length;n++)e.parentElement.insertBefore(t[n],e);return this.safeRemoveNodeFromDom(e),t},_splitSectionAtNode:function(e,t){var n,i;return(n=this.getQText2Span(e.nextSibling))&&(i=n.first()),(n=this.getQText2Span(e.previousSibling))&&(i=n.last()),this.safeRemoveNodeFromDom(e),i=i||t.last(),t.split(i)},_replaceNodeWithContainer:function(e,t,n){var i;return(i=this.getQText2Container(e.nextSibling,t.Class))?(n.insertBefore(t,i),void this.safeRemoveNodeFromDom(e)):(i=this.getQText2Container(e.previousSibling,t.Class))?(n.insertAfter(t,i),void this.safeRemoveNodeFromDom(e)):(n.appendChild(t),n.node.insertBefore(t.node,n.node.firstElementChild),void this.safeRemoveNodeFromDom(e))},safeRemoveNodeFromDom:function(e){e.parentElement&&l.safeRemoveChild(e,e.parentElement)},_getQText2ContainerType:function(e,t){return t.is(e)&&t.get(e)},isQText2SpanContent:function(e){return!!e.qtextSpanContent},getQText2Span:function(e){return this._getQText2ContainerType(e,a)},isQText2Span:function(e){return!!this.getQText2Span(e)},getQText2Section:function(e){return this._getQText2ContainerType(e,o)},isQText2Section:function(e){return!!this.getQText2Section(e)},getQText2Doc:function(e){return this._getQText2ContainerType(e,i)},isQText2Doc:function(e){return!!this.getQText2Doc(e)},isValidQText2Node:function(e){if(!e)return!1;if(this.isQText2Container(e))return!0;if(this.isQText2SpanContent(e))return!0;if("loading_dot_container"===e.className||"loading_dot_container"===e.parentElement.className)return!0;if(!e.parentElement)return!1;if("react_placeholder"===e.className||"react_placeholder"===e.parentElement.className)return!0;if(e.className.includes("react_upload_failed_container")||e.parentElement.className.includes("react_upload_failed_container"))return!0;if(this.isQText2SpanContent(e.parentElement)){if(l.isTextNode(e))return!0;if(this.nodeShouldBeSingleChild(e)){var t=this.getQText2Span(e.parentElement.parentElement);return t&&1==t.parent.children.length}if("section_remove_btn"===e.className)return!0}return!1},nodeShouldBeSingleChild:function(e){return e&&("IMG"==e.nodeName||"BR"==e.nodeName||"IFRAME"==e.nodeName)},nodeCanBeStyled:function(e){return e&&e.className.includes("styleable")},getQText2Container:function(e){for(var t,n=[a,o,i],r=0;r<n.length&&!(t=this._getQText2ContainerType(e,n[r]));r++);return t},isQText2Container:function(e){return!!this.getQText2Container(e)},handleNodesRemoved:function(e){var t=e.removed;if(t&&0!==t.length){var n=this;t.forEach((function(t){try{n._handleNodeRemoved(t,e.getOldParentNode(t))}catch(i){i.stack}}))}},_handleNodeRemoved:function(e,t){var n,r;if(a.is(t))r=(n=a.get(t)).parent,(this.doc.contains(t)||this.doc.hasChild(r)&&r.hasChild(n))&&(r.removeChild(n),0===r.children.length&&this.doc.removeChild(r));else if(o.is(t)){if(!(r=o.get(t)))return;a.is(e)&&(n=a.get(e),r.hasChild(n)&&r.removeChild(n)),0===r.children.length&&this.doc.removeChild(r)}else i.is(t)&&o.is(e)&&(r=o.get(e),this.doc.hasChild(r)&&this.doc.removeChild(r));this.doc.node.firstElementChild||(this.doc.clear(),this.doc.focus())},handleNodeAttributeChanges:function(e){var t=e.attributeChanged;t.style&&t.style.length&&t.style.forEach(this._handleNodeStyleAttributeChanged.bind(this))},_handleNodeStyleAttributeChanged:function(e){if(!this.nodeCanBeStyled(e)){var t=this._getModifiersFromNode(e);e.style.cssText="";var n=[];if(a.is(e))n.push(a.get(e));else if(a.is(e.parentElement))n.push(a.get(e.parentElement));else if(o.is(e))for(var i=o.get(e).firstChild();i;)n.push(i),i=i.nextSibling();this._applyModifiers(n,t)}},_getModifiersFromNode:function(e){var t={};if(e.style){var n=e.style.cssText;"font-weight:bold"==(n=n.replace(/\s|;/g,""))?t.bold=!0:"font-weight:normal"==n?t.bold=!1:("text-decoration:none"==n||"text-decoration:underline"==n)&&(t.underline=!1)}var i={B:"bold",STRONG:"bold",I:"italic",EM:"italic"}[e.nodeName];return i&&(t[i]=!0),t},_applyModifiers:function(e,t){var n=this;e.forEach((function(e){n._applyModifier(e,t)}))},_applyModifiersToContainer:function(e,t){var n=[];"span"==e.kind?n=[e]:"section"==e.kind?n=e.children:"doc"==e.kind&&e.children.forEach((function(e){n.push.apply(n,e.children)})),this._applyModifiers(n,t)},_applyModifier:function(e,t){for(var n=Object.keys(t),i=0;i<n.length;i++){var o=n[i];t[o]?e.setModifier(o,!0):e.removeModifier(o)}}})},function(e,t){var n,i=this.__extends||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i};if((n="undefined"!==typeof WebKitMutationObserver?WebKitMutationObserver:MutationObserver)===undefined)throw console.error("DOM Mutation Observers are required."),console.error("https://developer.mozilla.org/en-US/docs/DOM/MutationObserver"),Error("DOM Mutation Observers are required");var o,r=function(){function e(){this.nodes=[],this.values=[]}return e.prototype.isIndex=function(e){return+e===e>>>0},e.prototype.nodeId=function(t){var n=t[e.ID_PROP];return n||(n=t[e.ID_PROP]=e.nextId_++),n},e.prototype.set=function(e,t){var n=this.nodeId(e);this.nodes[n]=e,this.values[n]=t},e.prototype.get=function(e){var t=this.nodeId(e);return this.values[t]},e.prototype.has=function(e){return this.nodeId(e)in this.nodes},e.prototype["delete"]=function(e){var t=this.nodeId(e);delete this.nodes[t],this.values[t]=undefined},e.prototype.keys=function(){var e=[];for(var t in this.nodes)this.isIndex(t)&&e.push(this.nodes[t]);return e},e.ID_PROP="__mutation_summary_node_map_id__",e.nextId_=1,e}();!function(e){e[e.STAYED_OUT=0]="STAYED_OUT",e[e.ENTERED=1]="ENTERED",e[e.STAYED_IN=2]="STAYED_IN",e[e.REPARENTED=3]="REPARENTED",e[e.REORDERED=4]="REORDERED",e[e.EXITED=5]="EXITED"}(o||(o={}));var a=function(){function e(e,t,n,i,o,r,a,s){void 0===t&&(t=!1),void 0===n&&(n=!1),void 0===i&&(i=!1),void 0===o&&(o=null),void 0===r&&(r=!1),void 0===a&&(a=null),void 0===s&&(s=null),this.node=e,this.childList=t,this.attributes=n,this.characterData=i,this.oldParentNode=o,this.added=r,this.attributeOldValues=a,this.characterDataOldValue=s,this.isCaseInsensitive=this.node.nodeType===window.Node.ELEMENT_NODE&&this.node instanceof window.HTMLElement&&this.node.ownerDocument instanceof window.HTMLDocument}return e.prototype.getAttributeOldValue=function(e){return this.attributeOldValues?(this.isCaseInsensitive&&(e=e.toLowerCase()),this.attributeOldValues[e]):undefined},e.prototype.getAttributeNamesMutated=function(){var e=[];if(!this.attributeOldValues)return e;for(var t in this.attributeOldValues)e.push(t);return e},e.prototype.attributeMutated=function(e,t){this.attributes=!0,this.attributeOldValues=this.attributeOldValues||{},e in this.attributeOldValues||(this.attributeOldValues[e]=t)},e.prototype.characterDataMutated=function(e){this.characterData||(this.characterData=!0,this.characterDataOldValue=e)},e.prototype.removedFromParent=function(e){this.childList=!0,this.added||this.oldParentNode?this.added=!1:this.oldParentNode=e},e.prototype.insertedIntoParent=function(){this.childList=!0,this.added=!0},e.prototype.getOldParent=function(){if(this.childList){if(this.oldParentNode)return this.oldParentNode;if(this.added)return null}return this.node.parentNode},e}(),s=function(){this.added=new r,this.removed=new r,this.maybeMoved=new r,this.oldPrevious=new r,this.moved=undefined},l=function(e){function t(t,n){e.call(this),this.rootNode=t,this.reachableCache=undefined,this.wasReachableCache=undefined,this.anyParentsChanged=!1,this.anyAttributesChanged=!1,this.anyCharacterDataChanged=!1;for(var i=0;i<n.length;i++){var o=n[i];switch(o.type){case"childList":this.anyParentsChanged=!0;for(var r=0;r<o.removedNodes.length;r++){var a=o.removedNodes[r];this.getChange(a).removedFromParent(o.target)}for(r=0;r<o.addedNodes.length;r++)a=o.addedNodes[r],this.getChange(a).insertedIntoParent();break;case"attributes":this.anyAttributesChanged=!0,this.getChange(o.target).attributeMutated(o.attributeName,o.oldValue);break;case"characterData":this.anyCharacterDataChanged=!0,this.getChange(o.target).characterDataMutated(o.oldValue)}}}return i(t,e),t.prototype.getChange=function(e){var t=this.get(e);return t||(t=new a(e),this.set(e,t)),t},t.prototype.getOldParent=function(e){var t=this.get(e);return t?t.getOldParent():e.parentNode},t.prototype.getIsReachable=function(e){if(e===this.rootNode)return!0;if(!e)return!1;this.reachableCache=this.reachableCache||new r;var t=this.reachableCache.get(e);return t===undefined&&(t=this.getIsReachable(e.parentNode),this.reachableCache.set(e,t)),t},t.prototype.getWasReachable=function(e){if(e===this.rootNode)return!0;if(!e)return!1;this.wasReachableCache=this.wasReachableCache||new r;var t=this.wasReachableCache.get(e);return t===undefined&&(t=this.getWasReachable(this.getOldParent(e)),this.wasReachableCache.set(e,t)),t},t.prototype.reachabilityChange=function(e){return this.getIsReachable(e)?this.getWasReachable(e)?o.STAYED_IN:o.ENTERED:this.getWasReachable(e)?o.EXITED:o.STAYED_OUT},t}(r),c=function(){function e(e,t,n,i,o){this.rootNode=e,this.mutations=t,this.selectors=n,this.calcReordered=i,this.calcOldPreviousSibling=o,this.treeChanges=new l(e,t),this.entered=[],this.exited=[],this.stayedIn=new r,this.visited=new r,this.childListChangeMap=undefined,this.characterDataOnly=undefined,this.matchCache=undefined,this.processMutations()}return e.prototype.processMutations=function(){if(this.treeChanges.anyParentsChanged||this.treeChanges.anyAttributesChanged)for(var e=this.treeChanges.keys(),t=0;t<e.length;t++)this.visitNode(e[t],undefined)},e.prototype.visitNode=function(e,t){if(!this.visited.has(e)){this.visited.set(e,!0);var n=this.treeChanges.get(e),i=t;if((n&&n.childList||i==undefined)&&(i=this.treeChanges.reachabilityChange(e)),i!==o.STAYED_OUT){if(this.matchabilityChange(e),i===o.ENTERED)this.entered.push(e);else if(i===o.EXITED)this.exited.push(e),this.ensureHasOldPreviousSiblingIfNeeded(e);else if(i===o.STAYED_IN){var r=o.STAYED_IN;n&&n.childList&&(n.oldParentNode!==e.parentNode?(r=o.REPARENTED,this.ensureHasOldPreviousSiblingIfNeeded(e)):this.calcReordered&&this.wasReordered(e)&&(r=o.REORDERED)),this.stayedIn.set(e,r)}if(i!==o.STAYED_IN)for(var a=e.firstChild;a;a=a.nextSibling)this.visitNode(a,i)}}},e.prototype.ensureHasOldPreviousSiblingIfNeeded=function(e){if(this.calcOldPreviousSibling){this.processChildlistChanges();var t=e.parentNode,n=this.treeChanges.get(e);n&&n.oldParentNode&&(t=n.oldParentNode);var i=this.childListChangeMap.get(t);i||(i=new s,this.childListChangeMap.set(t,i)),i.oldPrevious.has(e)||i.oldPrevious.set(e,e.previousSibling)}},e.prototype.getChanged=function(e,t,n){this.selectors=t,this.characterDataOnly=n;for(var i=0;i<this.entered.length;i++){var r=this.entered[i];(l=this.matchabilityChange(r))!==o.ENTERED&&l!==o.STAYED_IN||e.added.push(r)}var a=this.stayedIn.keys();for(i=0;i<a.length;i++)if(r=a[i],(l=this.matchabilityChange(r))===o.ENTERED)e.added.push(r);else if(l===o.EXITED)e.removed.push(r);else if(l===o.STAYED_IN&&(e.reparented||e.reordered)){var s=this.stayedIn.get(r);e.reparented&&s===o.REPARENTED?e.reparented.push(r):e.reordered&&s===o.REORDERED&&e.reordered.push(r)}for(i=0;i<this.exited.length;i++){var l;r=this.exited[i],(l=this.matchabilityChange(r))!==o.EXITED&&l!==o.STAYED_IN||e.removed.push(r)}},e.prototype.getOldParentNode=function(e){var t=this.treeChanges.get(e);if(t&&t.childList)return t.oldParentNode?t.oldParentNode:null;var n=this.treeChanges.reachabilityChange(e);if(n===o.STAYED_OUT||n===o.ENTERED)throw Error("getOldParentNode requested on invalid node.");return e.parentNode},e.prototype.getOldPreviousSibling=function(e){var t=e.parentNode,n=this.treeChanges.get(e);n&&n.oldParentNode&&(t=n.oldParentNode);var i=this.childListChangeMap.get(t);if(!i)throw Error("getOldPreviousSibling requested on invalid node.");return i.oldPrevious.get(e)},e.prototype.getOldAttribute=function(e,t){var n=this.treeChanges.get(e);if(!n||!n.attributes)throw Error("getOldAttribute requested on invalid node.");var i=n.getAttributeOldValue(t);if(i===undefined)throw Error("getOldAttribute requested for unchanged attribute name.");return i},e.prototype.attributeChangedNodes=function(e){if(!this.treeChanges.anyAttributesChanged)return{};var t,n;if(e){t={},n={};for(var i=0;i<e.length;i++)t[h=e[i]]=!0,n[h.toLowerCase()]=h}var r={},a=this.treeChanges.keys();for(i=0;i<a.length;i++){var s=a[i],l=this.treeChanges.get(s);if(l.attributes&&o.STAYED_IN===this.treeChanges.reachabilityChange(s)&&o.STAYED_IN===this.matchabilityChange(s))for(var c=s,d=l.getAttributeNamesMutated(),u=0;u<d.length;u++){var h=d[u];(!t||t[h]||l.isCaseInsensitive&&n[h])&&l.getAttributeOldValue(h)!==c.getAttribute(h)&&(n&&l.isCaseInsensitive&&(h=n[h]),r[h]=r[h]||[],r[h].push(c))}}return r},e.prototype.getOldCharacterData=function(e){var t=this.treeChanges.get(e);if(!t||!t.characterData)throw Error("getOldCharacterData requested on invalid node.");return t.characterDataOldValue},e.prototype.getCharacterDataChanged=function(){if(!this.treeChanges.anyCharacterDataChanged)return[];for(var e=this.treeChanges.keys(),t=[],n=0;n<e.length;n++){var i=e[n];if(o.STAYED_IN===this.treeChanges.reachabilityChange(i)){var r=this.treeChanges.get(i);r.characterData&&i.textContent!=r.characterDataOldValue&&t.push(i)}}return t},e.prototype.computeMatchabilityChange=function(e,t){this.matchCache||(this.matchCache=[]),this.matchCache[e.uid]||(this.matchCache[e.uid]=new r);var n=this.matchCache[e.uid],i=n.get(t);return i===undefined&&(i=e.matchabilityChange(t,this.treeChanges.get(t)),n.set(t,i)),i},e.prototype.matchabilityChange=function(e){var t=this;if(this.characterDataOnly)switch(e.nodeType){case Node.COMMENT_NODE:case Node.TEXT_NODE:return o.STAYED_IN;default:return o.STAYED_OUT}if(!this.selectors)return o.STAYED_IN;if(e.nodeType!==Node.ELEMENT_NODE)return o.STAYED_OUT;for(var n=e,i=this.selectors.map((function(e){return t.computeMatchabilityChange(e,n)})),r=o.STAYED_OUT,a=0;r!==o.STAYED_IN&&a<i.length;){switch(i[a]){case o.STAYED_IN:r=o.STAYED_IN;break;case o.ENTERED:r=r===o.EXITED?o.STAYED_IN:o.ENTERED;break;case o.EXITED:r=r===o.ENTERED?o.STAYED_IN:o.EXITED}a++}return r},e.prototype.getChildlistChange=function(e){var t=this.childListChangeMap.get(e);return t||(t=new s,this.childListChangeMap.set(e,t)),t},e.prototype.processChildlistChanges=function(){if(!this.childListChangeMap){this.childListChangeMap=new r;for(var e=0;e<this.mutations.length;e++){var t=function(e,t){!e||i.oldPrevious.has(e)||i.added.has(e)||i.maybeMoved.has(e)||t&&(i.added.has(t)||i.maybeMoved.has(t))||i.oldPrevious.set(e,t)},n=this.mutations[e];if("childList"==n.type&&(this.treeChanges.reachabilityChange(n.target)===o.STAYED_IN||this.calcOldPreviousSibling)){for(var i=this.getChildlistChange(n.target),a=n.previousSibling,s=0;s<n.removedNodes.length;s++)t(l=n.removedNodes[s],a),i.added.has(l)?i.added["delete"](l):(i.removed.set(l,!0),i.maybeMoved["delete"](l)),a=l;for(t(n.nextSibling,a),s=0;s<n.addedNodes.length;s++){var l=n.addedNodes[s];i.removed.has(l)?(i.removed["delete"](l),i.maybeMoved.set(l,!0)):i.added.set(l,!0)}}}}},e.prototype.wasReordered=function(e){if(!this.treeChanges.anyParentsChanged)return!1;this.processChildlistChanges();var t=e.parentNode,n=this.treeChanges.get(e);n&&n.oldParentNode&&(t=n.oldParentNode);var i=this.childListChangeMap.get(t);if(!i)return!1;if(i.moved)return i.moved.get(e);i.moved=new r;var o=new r;function a(e){if(!e)return!1;if(!i.maybeMoved.has(e))return!1;var t=i.moved.get(e);return t!==undefined||(o.has(e)?t=!0:(o.set(e,!0),t=function(e){if(l.has(e))return l.get(e);for(var t=e.previousSibling;t&&(i.added.has(t)||a(t));)t=t.previousSibling;return l.set(e,t),t}(e)!==function n(e){var t=s.get(e);if(t!==undefined)return t;for(t=i.oldPrevious.get(e);t&&(i.removed.has(t)||a(t));)t=n(t);return t===undefined&&(t=e.previousSibling),s.set(e,t),t}(e)),o.has(e)?(o["delete"](e),i.moved.set(e,t)):t=i.moved.get(e)),t}var s=new r,l=new r;return i.maybeMoved.keys().forEach(a),i.moved.get(e)},e}(),d=function(){function e(e,t){var n=this;if(this.projection=e,this.added=[],this.removed=[],this.reparented=t.all||t.element||t.characterData?[]:undefined,this.reordered=t.all?[]:undefined,e.getChanged(this,t.elementFilter,t.characterData),t.all||t.attribute||t.attributeList){var i=t.attribute?[t.attribute]:t.attributeList,o=e.attributeChangedNodes(i);t.attribute?this.valueChanged=o[t.attribute]||[]:(this.attributeChanged=o,t.attributeList&&t.attributeList.forEach((function(e){n.attributeChanged.hasOwnProperty(e)||(n.attributeChanged[e]=[])})))}if(t.all||t.characterData){var r=e.getCharacterDataChanged();t.characterData?this.valueChanged=r:this.characterDataChanged=r}this.reordered&&(this.getOldPreviousSibling=e.getOldPreviousSibling.bind(e))}return e.prototype.getOldParentNode=function(e){return this.projection.getOldParentNode(e)},e.prototype.getOldAttribute=function(e,t){return this.projection.getOldAttribute(e,t)},e.prototype.getOldCharacterData=function(e){return this.projection.getOldCharacterData(e)},e.prototype.getOldPreviousSibling=function(e){return this.projection.getOldPreviousSibling(e)},e}(),u=/[a-zA-Z_]+/,h=/[a-zA-Z0-9_\-]+/;function f(e){return'"'+e.replace(/"/,'\\"')+'"'}var p=function(){function e(){}return e.prototype.matches=function(e){if(null===e)return!1;if(this.attrValue===undefined)return!0;if(!this.contains)return this.attrValue==e;for(var t=e.split(" "),n=0;n<t.length;n++)if(this.attrValue===t[n])return!0;return!1},e.prototype.toString=function(){return"class"===this.attrName&&this.contains?"."+this.attrValue:"id"!==this.attrName||this.contains?this.contains?"["+this.attrName+"~="+f(this.attrValue)+"]":"attrValue"in this?"["+this.attrName+"="+f(this.attrValue)+"]":"["+this.attrName+"]":"#"+this.attrValue},e}(),m=function(){function e(){this.uid=e.nextUid++,this.qualifiers=[]}return Object.defineProperty(e.prototype,"caseInsensitiveTagName",{get:function(){return this.tagName.toUpperCase()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectorString",{get:function(){return this.tagName+this.qualifiers.join("")},enumerable:!0,configurable:!0}),e.prototype.isMatching=function(t){return t[e.matchesSelector](this.selectorString)},e.prototype.wasMatching=function(e,t,n){if(!t||!t.attributes)return n;var i=t.isCaseInsensitive?this.caseInsensitiveTagName:this.tagName;if("*"!==i&&i!==e.tagName)return!1;for(var o=[],r=!1,a=0;a<this.qualifiers.length;a++){var s=this.qualifiers[a],l=t.getAttributeOldValue(s.attrName);o.push(l),r=r||l!==undefined}if(!r)return n;for(a=0;a<this.qualifiers.length;a++)if(s=this.qualifiers[a],(l=o[a])===undefined&&(l=e.getAttribute(s.attrName)),!s.matches(l))return!1;return!0},e.prototype.matchabilityChange=function(e,t){var n=this.isMatching(e);return n?this.wasMatching(e,t,n)?o.STAYED_IN:o.ENTERED:this.wasMatching(e,t,n)?o.EXITED:o.STAYED_OUT},e.parseSelectors=function(t){var n,i,o=[];function r(){n&&(i&&(n.qualifiers.push(i),i=undefined),o.push(n)),n=new e}function a(){i&&n.qualifiers.push(i),i=new p}for(var s,l=/\s/,c="Invalid or unsupported selector syntax.",d=1,f=0;f<t.length;){var m=t[f++];switch(d){case 1:if(m.match(u)){r(),n.tagName=m,d=2;break}if("*"==m){r(),n.tagName="*",d=3;break}if("."==m){r(),a(),n.tagName="*",i.attrName="class",i.contains=!0,d=4;break}if("#"==m){r(),a(),n.tagName="*",i.attrName="id",d=4;break}if("["==m){r(),a(),n.tagName="*",i.attrName="",d=6;break}if(m.match(l))break;throw Error(c);case 2:if(m.match(h)){n.tagName+=m;break}if("."==m){a(),i.attrName="class",i.contains=!0,d=4;break}if("#"==m){a(),i.attrName="id",d=4;break}if("["==m){a(),i.attrName="",d=6;break}if(m.match(l)){d=14;break}if(","==m){d=1;break}throw Error(c);case 3:if("."==m){a(),i.attrName="class",i.contains=!0,d=4;break}if("#"==m){a(),i.attrName="id",d=4;break}if("["==m){a(),i.attrName="",d=6;break}if(m.match(l)){d=14;break}if(","==m){d=1;break}throw Error(c);case 4:if(m.match(u)){i.attrValue=m,d=5;break}throw Error(c);case 5:if(m.match(h)){i.attrValue+=m;break}if("."==m){a(),i.attrName="class",i.contains=!0,d=4;break}if("#"==m){a(),i.attrName="id",d=4;break}if("["==m){a(),d=6;break}if(m.match(l)){d=14;break}if(","==m){d=1;break}throw Error(c);case 6:if(m.match(u)){i.attrName=m,d=7;break}if(m.match(l))break;throw Error(c);case 7:if(m.match(h)){i.attrName+=m;break}if(m.match(l)){d=8;break}if("~"==m){i.contains=!0,d=9;break}if("="==m){i.attrValue="",d=11;break}if("]"==m){d=3;break}throw Error(c);case 8:if("~"==m){i.contains=!0,d=9;break}if("="==m){i.attrValue="",d=11;break}if("]"==m){d=3;break}if(m.match(l))break;throw Error(c);case 9:if("="==m){i.attrValue="",d=11;break}throw Error(c);case 10:if("]"==m){d=3;break}if(m.match(l))break;throw Error(c);case 11:if(m.match(l))break;if('"'==m||"'"==m){s=m,d=13;break}i.attrValue+=m,d=12;break;case 12:if(m.match(l)){d=10;break}if("]"==m){d=3;break}if("'"==m||'"'==m)throw Error(c);i.attrValue+=m;break;case 13:if(m==s){d=10;break}i.attrValue+=m;break;case 14:if(m.match(l))break;if(","==m){d=1;break}throw Error(c)}}switch(d){case 1:case 2:case 3:case 5:case 14:r();break;default:throw Error(c)}if(!o.length)throw Error(c);return o},e.nextUid=1,e.matchesSelector=function(){var e=document.createElement("div");return"function"===typeof e.webkitMatchesSelector?"webkitMatchesSelector":"function"===typeof e.mozMatchesSelector?"mozMatchesSelector":"function"===typeof e.msMatchesSelector?"msMatchesSelector":"matchesSelector"}(),e}(),g=/^([a-zA-Z:_]+[a-zA-Z0-9_\-:\.]*)$/;function v(e){if("string"!=typeof e)throw Error("Invalid request opion. attribute must be a non-zero length string.");if(!(e=e.trim()))throw Error("Invalid request opion. attribute must be a non-zero length string.");if(!e.match(g))throw Error("Invalid request option. invalid attribute name: "+e);return e}function b(e){if(!e.trim().length)throw Error("Invalid request option: elementAttributes must contain at least one attribute.");for(var t={},n={},i=e.split(/\s+/),o=0;o<i.length;o++)if(r=i[o]){var r,a=(r=v(r)).toLowerCase();if(t[a])throw Error("Invalid request option: observing multiple case variations of the same attribute is not supported.");n[r]=!0,t[a]=!0}return Object.keys(n)}var y=function(){function e(t){var i=this;this.connected=!1,this.options=e.validateOptions(t),this.observerOptions=e.createObserverOptions(this.options.queries),this.root=this.options.rootNode,this.callback=this.options.callback,this.elementFilter=Array.prototype.concat.apply([],this.options.queries.map((function(e){return e.elementFilter?e.elementFilter:[]}))),this.elementFilter.length||(this.elementFilter=undefined),this.calcReordered=this.options.queries.some((function(e){return e.all})),this.queryValidators=[],e.createQueryValidator&&(this.queryValidators=this.options.queries.map((function(t){return e.createQueryValidator(i.root,t)}))),this.observer=new n((function(e){i.observerCallback(e)})),this.reconnect()}return e.createObserverOptions=function(e){var t,n={childList:!0,subtree:!0};function i(e){n.attributes&&!t||(n.attributes=!0,n.attributeOldValue=!0,e?(t=t||{},e.forEach((function(e){t[e]=!0,t[e.toLowerCase()]=!0}))):t=undefined)}return e.forEach((function(e){if(e.characterData)return n.characterData=!0,void(n.characterDataOldValue=!0);if(e.all)return i(),n.characterData=!0,void(n.characterDataOldValue=!0);if(e.attribute)i([e.attribute.trim()]);else{var t=function(e){var t={};return e.forEach((function(e){e.qualifiers.forEach((function(e){t[e.attrName]=!0}))})),Object.keys(t)}(e.elementFilter).concat(e.attributeList||[]);t.length&&i(t)}})),t&&(n.attributeFilter=Object.keys(t)),n},e.validateOptions=function(t){for(var n in t)if(!(n in e.optionKeys))throw Error("Invalid option: "+n);if("function"!==typeof t.callback)throw Error("Invalid options: callback is required and must be a function");if(!t.queries||!t.queries.length)throw Error("Invalid options: queries must contain at least one query request object.");for(var i={callback:t.callback,rootNode:t.rootNode||document,observeOwnChanges:!!t.observeOwnChanges,oldPreviousSibling:!!t.oldPreviousSibling,queries:[]},o=0;o<t.queries.length;o++){var r=t.queries[o];if(r.all){if(Object.keys(r).length>1)throw Error("Invalid request option. all has no options.");i.queries.push({all:!0})}else if("attribute"in r){if((s={attribute:v(r.attribute)}).elementFilter=m.parseSelectors("*["+s.attribute+"]"),Object.keys(r).length>1)throw Error("Invalid request option. attribute has no options.");i.queries.push(s)}else if("element"in r){var a=Object.keys(r).length,s={element:r.element,elementFilter:m.parseSelectors(r.element)};if(r.hasOwnProperty("elementAttributes")&&(s.attributeList=b(r.elementAttributes),a--),a>1)throw Error("Invalid request option. element only allows elementAttributes option.");i.queries.push(s)}else{if(!r.characterData)throw Error("Invalid request option. Unknown query request.");if(Object.keys(r).length>1)throw Error("Invalid request option. characterData has no options.");i.queries.push({characterData:!0})}}return i},e.prototype.createSummaries=function(e){if(!e||!e.length)return[];for(var t=new c(this.root,e,this.elementFilter,this.calcReordered,this.options.oldPreviousSibling),n=[],i=0;i<this.options.queries.length;i++)n.push(new d(t,this.options.queries[i]));return n},e.prototype.checkpointQueryValidators=function(){this.queryValidators.forEach((function(e){e&&e.recordPreviousState()}))},e.prototype.runQueryValidators=function(e){this.queryValidators.forEach((function(t,n){t&&t.validate(e[n])}))},e.prototype.changesToReport=function(e){return e.some((function(e){return!!["added","removed","reordered","reparented","valueChanged","characterDataChanged"].some((function(t){return e[t]&&e[t].length}))||!(!e.attributeChanged||!Object.keys(e.attributeChanged).some((function(t){return!!e.attributeChanged[t].length})))}))},e.prototype.observerCallback=function(e){this.options.observeOwnChanges||this.observer.disconnect();var t=this.createSummaries(e);this.runQueryValidators(t),this.options.observeOwnChanges&&this.checkpointQueryValidators(),this.changesToReport(t)&&this.callback(t),!this.options.observeOwnChanges&&this.connected&&(this.checkpointQueryValidators(),this.observer.observe(this.root,this.observerOptions))},e.prototype.reconnect=function(){if(this.connected)throw Error("Already connected");this.observer.observe(this.root,this.observerOptions),this.connected=!0,this.checkpointQueryValidators()},e.prototype.takeSummaries=function(){if(!this.connected)throw Error("Not connected");var e=this.createSummaries(this.observer.takeRecords());return this.changesToReport(e)?e:undefined},e.prototype.disconnect=function(){var e=this.takeSummaries();return this.observer.disconnect(),this.connected=!1,e},e.NodeMap=r,e.parseElementFilter=m.parseSelectors,e.optionKeys={callback:!0,queries:!0,rootNode:!0,oldPreviousSibling:!0,observeOwnChanges:!0},e}();t.MutationSummary=y},function(e,t,n){var i=n(0).config;t.htmlToNode=function(e){var t;return(t=i.clientInfo.isMSIE&&i.clientInfo.version<9||!document.implementation||!document.implementation.createHTMLDocument?document.createElement("DIV"):document.implementation.createHTMLDocument("title for old FF versions").createElement("DIV")).innerHTML=e,t}},function(e,t,n){var i=n(2),o=n(46).Backspace,r=n(47).Code,a=n(48).Copy,s=n(49).Delete,l=n(50).Indent,c=n(51).Image,d=n(52).Link,u=n(53).Math,h=n(54).Mention,f=n(55).Paste,p=n(56).Quote,m=n(57).Return,g=n(58).SoftReturn,v=n(59).UndoRedo,b=n(60).Embed,y=n(13),x=y.OrderedListSection,S=y.UnorderedListSection,E=n(25).H1Section;t.COMMANDS={backspace:o,cite:d,code:r,copy:a,cut:a,deindent:l,"delete":s,"delete-backward":s,"delete-forward":s,"delete-next-word":s,"delete-previous-word":s,indent:l,image:c,link:d,math:u,mention:h,paste:f,quote:p,redo:v,"return":m,"soft-return":g,undo:v,embed:b,bold:i.spanModifierToggle("bold"),italic:i.spanModifierToggle("italic"),ordered_list:i.sectionTypeToggle(x),unordered_list:i.sectionTypeToggle(S),h1:i.sectionTypeToggle(E)}},function(e,t,n){var i=n(2).Command,o=n(4).Position,r=n(1).Util,a=n(3).PlainSection;n(0).config,t.Backspace=i.extend({exec:function(){var e=this._actualBackspace();return e||this.doc.updateSpellingSuggestions(),this.doc.caret.scrollIntoViewIfNeeded(),e},_actualBackspace:function(){var e,t,n,i;if(!this.doc.caret.isCollapsed())return this.doc.saveState(),this.doc._deleteSelection(),!1;if(s=(e=(n=this.doc.caret.start.clone()).span.parent).previousSibling(),i=n.span.getText(),(n.atSectionStart()&&!n.atDocStart()||!e.isEditable()&&!n.atSectionStart()||"\n"==n.charBefore()||"."==n.charBefore()||","==n.charBefore())&&this.doc.saveState(),!e.isEditable())return this.doc.caret.start.atSectionStart()?s&&s.isEmpty()&&this.doc.removeChild(s):(s||(s=new a,this.doc.insertBefore(s,e)),this.doc.removeChild(e),this.doc.moveCaret(s.last()),this.doc.caret.updateAndroidCaretPosition()),!1;if(n.atDocStart())return(t=this.doc.progressivelyExitSection(e))!=e&&this.doc.saveState(),this.doc.moveCaret(t.first(),t.first(),!0),!1;if(n.atSectionStart()){if(e.getIndent()>0)e.setIndent(e.getIndent()-1),this.doc.caret.updateAndroidCaretPosition();else if(s.hasSectionRemoveButton()){this.doc.removeChild(s);var s=e.previousSibling()}else s.isEditable()||e.isEmpty()?(this.doc.moveCaret(s.merge(e)),this.doc.caret.mergeAdjacentSpans()):this.doc.moveCaret(s.last());return!1}var l=!1;n.atSpanStart()&&(n.span=n.span.previous(),n.offset=n.span.getLength(),i=n.span.getText(),l=!0);for(var c=i.slice(0,n.offset),d=i.slice(n.offset),u=0,h=c.length;h>0&&"\n"==c[h-1];h--)u+=1;return 1==u&&d.startsWith("\n")&&(d=d.slice(1),l=!0),r.isAstralSymbol(c.slice(c.length-2))?(c=c.slice(0,-2),l=!0):c=c.slice(0,-1),n.atSectionEnd()&&c.endsWith("\n")&&(0===u?c+="\n":c=c.slice(0,-1),l=!0),c+d===""&&(l=!0),!l||(this.doc.flushTextInput(),n.span.setText(c+d),n.span.isEmpty()?(n=this.doc._handleEmptySpan(n.span),this.doc.moveCaret(n,n,!0)):this.doc.moveCaret(new o(n.span,c.length)),!1)}})},function(e,t,n){var i=n(2).Command,o=n(12).CodeSection,r=n(11).canForceModifier;t.Code=i.extend({exec:function(){return this.doc.saveState(),this.doc.caret.isCollapsed()?(this.doc.formattingState.is("code")||!this.doc.allowsMultipleSections()?this.doc.toggleModifier("code"):this.doc.toggleSectionType(o),!1):(!this.doc._getSelectedSections().some((function(e){return!e.isEditable()}))&&this.doc.caret.start.atSectionStart()&&this.doc.caret.end.atSectionEnd()?this.doc.toggleSectionType(o):this.doc._toggleMathOrCodeModifier("code"),!1)},shouldExec:function(){return this.doc.caret.isCollapsed()?this.doc.caret.start.span.parent.isEditable():!(this.doc._getSelectedSections().some((function(e){return!e.isEditable()}))||!this.doc.caret.start.atSectionStart()||!this.doc.caret.end.atSectionEnd())||this.doc.caret.getCoveringSpans().some((function(e){return r(e,"code")}))}})},function(e,t,n){var i=n(2).Command,o=n(6).Section,r=n(5).CONTENT_TYPES,a=n(0).config;t.Copy=i.extend({exec:function(e,t){if(!(a.clientInfo.isMobile&&a.clientInfo.isIOSMobileWeb&&a.clientInfo.osVersion<11)&&!a.clientInfo.isMSEdge){var n=this._selectedSectionsJSON().map(o.fromJSON),i=this.getContentForType(n,r.TEXT),s=this.getContentForType(n,r.HTML);t.clipboardData.setData(r.TEXT,i),t.clipboardData.setData(r.HTML,s),t.preventDefault(),t.stopPropagation(),"cut"==e&&this.doc._deleteSelection()}},getContentForType:function(e,t){return e.map((function(n){return n.toContent(t,e)})).join("")},_selectedSectionsJSON:function(){if(this.doc.caret.isCollapsed())return[];var e,t,n=[],i=this.doc.caret.start.clone(),o=this.doc.caret.end.clone(),r=i.span;for(r=i.span;r&&r.previous()!=o.span;r=r.next())if(!(i.span===r&&i.atSpanEnd()||o.span===r&&o.atSpanStart())){if(e!=r.parent){if(!(t=(e=r.parent).toJSON()))continue;t.spans=[],n.push(t)}var a=i.span===r?i.offset:undefined,s=o.span===r?o.offset:undefined;t.spans.push(r.toJSON(!1,a,s))}return n}})},function(e,t,n){var i=n(2).Command,o=n(1).Util,r=n(3).PlainSection;t.Delete=i.extend({exec:function(e){if(this.doc.saveState(),this.doc.caret.isCollapsed()){if("delete"==e)return this._deleteSingle();"delete-forward"==e?this.doc.moveCaretEnd(this.doc.caret.start.span.parent.last()):"delete-backward"==e?this.doc.moveCaretStart(this.doc.caret.start.span.parent.first()):"delete-next-word"==e?this.doc.moveCaretEnd(this.doc.caret.start.nextWordBoundary()):"delete-previous-word"==e&&this.doc.moveCaretStart(this.doc.caret.start.previousWordBoundary())}return this._deleteSelection()},_deleteSelection:function(){if(!this.doc.caret.isCollapsed())return this.doc._deleteSelection(),!1},_deleteSingle:function(){var e,t,n;if(t=(e=(n=this.doc.caret.start.clone()).span.parent).nextSibling(),this.doc.caret.isCollapsed()){if(!e.isEditable())return this.doc.caret.start.atSectionEnd()?t&&t.isEmpty()&&this.doc.removeChild(t):(t||(t=new r,this.doc.insertBefore(t,e)),this.doc.removeChild(e),this.doc.moveCaret(t.first()),this.doc.caret.updateAndroidCaretPosition()),!1;if(n.atDocEnd())return!1;if(n.atSectionEnd())return e=n.span.parent,this.doc.moveCaret(e.merge(e.nextSibling())),!1;n.atSpanEnd()&&(n.span=n.span.next(),n.offset=0);var i=n.span.getText();return o.isAstralSymbol(i.slice(n.offset,n.offset+2))?n.span.deleteText(n.offset,n.offset+2):n.span.deleteText(n.offset,n.offset+1),n.span.isEmpty()?this.doc.moveCaret(this.doc._handleEmptySpan(n.span)):this.doc.moveCaret(n),!1}}})},function(e,t,n){var i=n(2).Command,o=n(12).CodeSection,r=n(4).Position;t.Indent=i.extend({exec:function(e){return"indent"==e?this._indent():this._deindent()},_maybeInsertTab:function(){var e=this.doc.caret.isCollapsed(),t=this.doc.caret.start.clone(),n=t.span,i=n.parent,a=n.getText(),s=t.offset;return!!(e&&i instanceof o)&&(n.setText(a.slice(0,s)+"\t"+a.slice(s)),this.doc.moveCaret(new r(n,s+1)),!0)},_afterIndent:function(e){e&&this.doc.forceDomReflow(),this.doc.updateCaret()},_indent:function(){if(this._maybeInsertTab())return!1;var e=this.doc._getSelectedSections(),t=!1;return e.forEach((function(e){e.setIndent(e.getIndent()+1)&&(t=!0)})),this._afterIndent(t),!t},_deindent:function(){var e=this.doc._getSelectedSections(),t=!1;return e.forEach((function(e){e.setIndent(e.getIndent()-1)&&(t=!0)})),this._afterIndent(t),!t}})},function(e,t,n){var i=n(2).Command,o=n(14).ImageSection,r=n(0).config;t.Image=i.extend({exec:function(e,t,n,i){if(0!==t.length){var a=t.map((function(e){return r.options.eagerImageUploading?o.fromURL(e,null,i):o.fromURL(e)}));this.doc.saveState(),this.doc.insertSections(a),this.doc.saveState()}}})},function(e,t,n){var i=n(2).Command,o=n(8).Span,r=n(1).Util,a=n(4).Position,s=n(11).canForceModifier,l=n(22).isValidEmail;t.Link=i.extend({exec:function(){var e=this;this.doc.linkStart=this.doc.caret.start.clone();var t,n,i,o=this.doc.caret.start.span;return!!o.isEditable()&&(o.hasModifier("link")?(this.doc.caret.isCollapsed()||this.doc.saveState(),this.doc.formattingState.toggleModifier(this.doc.caret,"link"),this.doc._getSelectedSpans(!0).forEach((function(e){e.removeModifier("link")})),!1):(o.hasModifier("citation")&&(t=o.getModifier("citation").target,i=!0),t&&(n=t.url),this.doc.linkSelector.getExternalURL((function(t){setTimeout((function(){return e.onLinkInput(t)}),200)}),n,i),!1))},shouldExec:function(){return s(this.doc.caret.start.span,"link")},onLinkInput:function(e){this.doc.moveCaretStart(this.doc.linkStart,!0);var t,n,i,s=this.doc.caret.isCollapsed(),c=this.doc.caret.start.clone(),d=this.doc._getSelectedSpans(!0,!0),u=e.url,h=e.isCitation,f=this.doc.caret.start.span,p=h&&f.hasModifier("citation")||!h&&f.hasModifier("link"),m=p?f.getText():u;this.doc.saveState(),u&&(u=u.startsWith("mailto:")&&l(u.slice(7))?u:r.ensureProtocol(u),t={type:"url",url:u},h||(d=this.doc._mergeSpansBySection(d)),s?(n=this.doc._insertOrModifyLink(m,t,h,!0),c=new a(n.nextSibling(),1)):h?(n=new o(" ",{citation:{target:t}}),(i=d[d.length-1]).parent.insertAfter(n,i)):d.forEach((function(e){e.setModifier("link",t)})),!n||f.hasModifier("link")&&p||this.doc.fetchLinkPreviews([n])),this.doc.node.focus(),s?this.doc.moveCaret(c):this.doc.moveCaret(d[0].first(),d[d.length-1].last()),this.doc.caret.scrollIntoViewIfNeeded()}})},function(e,t,n){var i=n(2).Command,o=n(11).canForceModifier;t.Math=i.extend({exec:function(){return this.doc.saveState(),this.doc.caret.isCollapsed()?this.doc.formattingState.toggleModifier(this.doc.caret,"math"):this.doc._toggleMathOrCodeModifier("math"),!1},shouldExec:function(){return this.doc.caret.getCoveringSpans().some((function(e){return o(e,"math")}))}})},function(e,t,n){var i=n(2).Command,o=n(5),r=n(0).config,a=n(18);t.Mention=i.extend({exec:function(e,t){if(this.doc._shouldAllowLinks()&&!this.doc.linkSelector.isActive()){if("@"==t){var n=this.doc.caret.charBefore();if(n&&!o.WORD_START_REGEX.test(n))return}var i=this.doc.getCurrentDirection()==a.RTL;if(this.doc.focus(),r.clientInfo.isMobile)this.doc.linkSelector.show(t);else{var s=this.doc.caret.getAbsolutePosition(!0)||{};this.doc.linkSelector.show(t,s.left,s.top,i)}return!1}}})},function(e,t,n){var i=n(2).Command,o=n(27),r=n(5).CONTENT_TYPES,a=[r.PUBLIC_HTML,r.HTML,r.TEXT,r.TEXT_URI],s=n(0).config,l=/href=(['"])([^'">]*)\1[^>]*>\2/im;t.Paste=i.extend({exec:function(e,t){if(!t.clipboardData||!t.clipboardData.types||!t.clipboardData.getData)return!1;var n,i=this,o=!0;return a.some((function(e){for(var a=0;a<t.clipboardData.types.length;a++)if(t.clipboardData.types[a]==e&&(n=t.clipboardData.getData(e))&&i.allowClipboardData(e,n)&&(e!==r.TEXT||0===t.clipboardData.files.length)){t.stopImmediatePropagation(),i.doc.saveState(),i._paste(n,e),i.doc.trigger("paste_event",t),o=!1;break}if(!o)return!0})),o&&this.doc.trigger("paste",t),!1},allowClipboardData:function(e,t){return e!==r.HTML||!l.test(t)},_paste:function(e,t){var n=o.parse(e,t);n=this.doc.sanitizeContent(n),this.doc.insertSections(n),s.platform.sendMessage("showKeyboard")}})},function(e,t,n){var i=n(2).Command,o=n(13).isListSection;t.Quote=i.extend({exec:function(){var e,t,n=this.doc._getSelectedSections(),i=n[0],r=i.isQuoted(),a=[];for(this.doc.saveState();o(i)&&(e=i.previousSibling())&&e.getType()==i.getType();)a.push(e),i=e;for(i=n[n.length-1];o(i)&&(t=i.nextSibling())&&t.getType()==i.getType();)a.push(t),i=t;return(n=n.concat(a)).forEach((function(e){e.setQuoted(!r)})),!1}})},function(e,t,n){var i=n(2).Command,o=n(3).PlainSection,r=n(12).CodeSection;t.Return=i.extend({exec:function(){this.doc.saveState();var e=this._actualReturn();return this.doc.updateSpellingSuggestions(),this.doc.caret.scrollIntoViewIfNeeded(),this.doc.caret.updateAndroidCaretPosition(),e},_actualReturn:function(){var e,t,n,i,a;return this.doc.caret.isCollapsed()||this.doc._deleteSelection(),n=(t=(e=this.doc.caret.start.span.parent).previousSibling())&&t.isEmpty(),a=this.doc.caret.start.clone(),e.isEditable()?(a=e.isEmpty()||""===e.node.textContent.trim()?e instanceof r&&t instanceof r&&!n||e instanceof o&&!e.isQuoted()&&0===e.getIndent()?e.split(a):(e=this.doc.progressivelyExitSection(e)).first():e.split(a),this.doc.moveCaret(a),!1):(i=new o,this.doc.caret.start.atSectionStart()?this.doc.insertBefore(i,e):(this.doc.insertBefore(i,e.nextSibling()),this.doc.moveCaret(i.first())),!1)}})},function(e,t,n){var i=n(2).Command,o=n(12).CodeSection,r=n(4).Position;t.SoftReturn=i.extend({exec:function(){var e=this.doc.caret.start,t=e.span,n=e.offset,i=t.parent,a=t.getText(),s="\n"==this.doc.caret.charBefore();if(!i.isEditable())return this.doc.handleCommand("return");if(this.doc.saveState(),i instanceof o){var l=i.split(e);return this.doc.moveCaret(l),!1}if(!i.allowsMultipleSoftReturns()&&!this.doc.isDisabledCommand("return")&&s){for(;a.endsWith("\n");)a=a.slice(0,-1);return t.setText(a),this.doc.handleCommand("return")}return e.atSectionEnd()?(t.setText(a+"\n\n"),this.doc.moveCaret(t.last())):(t.setText(a.slice(0,n)+"\n"+a.slice(n)),this.doc.moveCaret(new r(t,n+1))),this.doc.moveCaret(new r(t,n+1)),!1}})},function(e,t,n){var i=n(2).Command,o=n(10);t.UndoRedo=i.extend({exec:function(e){return"undo"==e?this._undo():this._redo()},_undo:function(){return this.doc.undoManager.canRedo()||o.jsonEqual(this.doc.toJSON(!0),this.doc.undoManager.state())||this.doc.saveState(),this.doc.undoManager.undo(),this.doc.fromJSON(this.doc.undoManager.state()),!1},_redo:function(){return this.doc.undoManager.redo(),this.doc.fromJSON(this.doc.undoManager.state()),!1}})},function(e,t,n){var i=n(2).Command,o=n(15).EmbedSection;t.Embed=i.extend({exec:function(e,t){t.forEach((function(e,n){var i=o.fromOtherSection(e);null!==i&&(t[n]=i)}))}})},function(e,t,n){var i=n(62).Tooltips,o=n(64).Autolist,r=n(65).Autolink,a=n(66).AutoQuote,s=n(67).AutoCode,l=n(68).Ellipses,c=n(69).HR,d=n(70).UndoState,u=n(71).Mention,h=n(72).NonEditableCursors,f=n(73).SmartQuotes,p=n(74).DoubleSpace,m=n(75).Dashes,g=n(76).Arrows,v=n(77).ExternalImageUpload;t.EXTENSIONS=[c,i,r,o,a,s,l,d,u,h,f,p,m,g,v]},function(e,t,n){var i=n(9).Extension,o=n(1).Util,r=n(63);t.Tooltips=i.extend({install:function(){this._activeLinkSpan=null,this.doc.on("caretMoved",this.onCaretMoved.bind(this)),this.doc.on("blur",this.onDocBlur.bind(this))},destroy:function(){this._hideTooltip()},onDocBlur:function(){this._hideTooltip()},onCaretMoved:function(){this._maybeShowTooltip()},_maybeShowTooltip:function(){this._shouldShowTooltip()?this._showTooltip():this._hideTooltip()},_shouldShowTooltip:function(){var e=this.doc.caret.start.span;return e.hasModifier("link")||e.hasModifier("citation")},_showTooltip:function(){var e,t=this.doc.caret.start.span;if(t.hasModifier("link")?e=t.getModifier("link"):t.hasModifier("citation")&&(e=t.getModifier("citation").target),e&&e.url){this._activeLinkSpan=t;var n=o.create("a");n.target="_blank",n.rel="noreferrer nofollow",n.href=e.url,n.textContent=e.url,r.show(t.node,n,t.parent.node)}},_hideTooltip:function(){this._activeLinkSpan=null,r.hide()}})},function(e,t,n){var i,o,r=null,a=n(1).Util;t.show=function(e,t,n){i||((i=document.createElement("div")).className="qtext2_tooltip",document.body.appendChild(i),(o=document.createElement("div")).style.overflow="hidden",o.style.textOverflow="ellipsis",o.style.whiteSpace="nowrap",i.appendChild(o));var s=n.offsetWidth;t.nodeType?(o.innerHTML="",o.appendChild(t)):o.innerHTML=t;var l=a.getOffset(e),c=a.getSize(e),d=l.left+.5*c.width,u=a.getOffset(n).left,h=u+s;l.top<30?a.setPixelVal(i,"top",c.height+20):a.setPixelVal(i,"top",l.top+window.scrollY-30);var f=i.offsetWidth,p=d-f/2,m=d+f/2;p<u?a.setPixelVal(i,"left",u):m>h?a.setPixelVal(i,"left",h-f):a.setPixelVal(i,"left",p),clearTimeout(r),r=setTimeout((function(){i.classList.add("visible")}),500)},t.hide=function(){i&&(clearTimeout(r),r=setTimeout((function(){i.classList.remove("visible")}),100))}},function(e,t,n){var i=n(9).Extension,o=n(4).Position,r=n(3).PlainSection,a=n(13),s=a.UnorderedListSection,l=a.OrderedListSection,c=n(5);t.Autolist=i.extend({install:function(){this.doc.on("command-space",this.onSpace.bind(this))},onSpace:function(){if(this.shouldAutoList()){var e=this.doc.caret.start.clone(),t=e.span,n=t.parent,i=e.offset,r=t.getText(),a=r.slice(0,i),d=new RegExp("^([-*+]|--|"+c.EM_DASH+")$"),u=/^1[.)]$/;if(n.firstChild()==t&&(d.test(a)||u.test(a))){var h=d.exec(a)||u.exec(a);return h=h[0],t.setText(r.slice(0,h.length)+" "+r.slice(h.length)),this.doc.moveCaret(new o(t,h.length+1)),this.doc.saveState(),t.setText(r.slice(h.length)),this.doc.moveCaret(t.first(),null,!0),d.test(a)?this.doc.toggleSectionType(s):this.doc.toggleSectionType(l),!1}}},shouldAutoList:function(){if(this.doc.isDisabledCommand("ordered_list")||this.doc.isDisabledCommand("unordered_list"))return!1;var e=this.doc.caret.isCollapsed(),t=this.doc.caret.start.span,n=t.parent;return!!e&&!(t.hasModifier("link")||t.hasModifier("math")||t.hasModifier("code"))&&n instanceof r}})},function(e,t,n){var i=n(9).Extension,o=n(8).Span,r=n(1).Util,a=n(4).Position,s=n(3).PlainSection,l=n(15).EmbedSection,c=n(24).hyperlinkEmbedsEnabled,d=["m.in"];t.Autolink=i.extend({install:function(){this.doc.on("command-space",this.onSpace.bind(this)),this.doc.on("command-return",this.onReturn.bind(this)),this.doc.on("convertToTextLink",this.onConvertToTextLink.bind(this))},onSpace:function(){return this.detectLinksBeforeCaret()},onReturn:function(){return this.detectLinksBeforeCaret(!0)},onConvertToTextLink:function(){return this.detectLinksBeforeCaret(!1,!0)},detectLinksBeforeCaret:function(e,t){var n=this.doc.caret.start,i=n.span;if(e&&n.atSectionStart()){if(!(i=i.previous()))return!1;n=i.last()}return!this._detectLinks(i,n,!e,t)},_detectLinks:function(e,t,n,i){if(!this.doc._shouldAllowLinks(e))return!1;var u,h=e.parent,f=t||e.last(),p=f.offset,m=f.previousWordBoundary(/\s/),g=e.getText(),v=g.slice(m.offset,p);if(r.linkify(v).forEach((function(e){var t=e.text,n=e.href;n&&t==v&&!d.includes(v)?u=new o(v,{link:{type:"url",url:n}}):v=v.slice(t.length)})),!u)return!1;n&&(e.setText(g.slice(0,p)+" "+g.slice(p)),this.doc.moveCaret(new a(e,p+1))),this.doc.saveState();var b,y,x=e;if((m=new a(f.span,p-v.length)).equals(e.first())&&f.equals(e.last())?n?(x.setText(" "),y=new a(x,1)):x=null:(m.equals(e.first())||(b=new o(e.getText().slice(0,m.offset),e.modifiers)),n?(x.setText(" "+x.getText().slice(f.offset)),y=new a(x,1)):f.equals(e.last())?x=null:x.setText(x.getText().slice(f.offset))),b&&h.insertBefore(b,e),h.insertBefore(u,e),x||h.removeChild(e),y&&n&&this.doc.moveCaret(y),this.doc.fetchLinkPreviews([u]),!i&&c()){var S=l.fromOtherSection(h);if(null!==S&&(this.doc.insertBefore(S,h),this.doc.removeChild(h),n)){var E=new s;this.doc.insertAfter(E,S)}}return!0}})},function(e,t,n){var i=n(9).Extension,o=n(3).PlainSection,r=n(4).Position,a=n(0).config;t.AutoQuote=i.extend({install:function(){this.doc.on("command-space",this.onSpace.bind(this))},onSpace:function(){if(this.shouldAutoQuote()){var e=this.doc.caret.start.clone(),t=e.span,n=t.parent,i=e.offset,o=t.getText(),a=o.slice(0,i),s=/^>$/;if(n.firstChild()==t&&s.test(a)){var l=s.exec(a);return l=l[0],this.doc.moveCaret(new r(t,l.length)),this.doc.saveState(),t.setText(o.slice(l.length)),this.doc.moveCaret(t.first(),null,!0),n.setQuoted(!0),!1}}},shouldAutoQuote:function(){if(!a.options.markdownExtensionsEnabled)return!1;if(this.doc.isDisabledCommand("quote"))return!1;if(!this.doc.caret.isCollapsed())return!1;var e=this.doc.caret.start.span.parent;return!e.isQuoted()&&e instanceof o}})},function(e,t,n){var i=n(9).Extension,o=n(12).CodeSection,r=n(3).PlainSection,a=n(4).Position,s=n(0).config;t.AutoCode=i.extend({install:function(){this.doc.on("command-space",this.onSpace.bind(this))},onSpace:function(){if(this.shouldAutoCode()){var e=this.doc.caret.start.clone(),t=e.span,n=t.parent,i=e.offset,r=t.getText(),s=r.slice(0,i),l=/^```$/;if(n.firstChild()==t&&l.test(s)){var c=l.exec(s);return c=c[0],this.doc.moveCaret(new a(t,c.length)),this.doc.saveState(),t.setText(r.slice(c.length)),this.doc.moveCaret(t.first(),null,!0),this.doc.toggleSectionType(o),!1}}},shouldAutoCode:function(){if(!s.options.markdownExtensionsEnabled)return!1;if(this.doc.isDisabledCommand("code"))return!1;if(!this.doc.caret.isCollapsed())return!1;var e=this.doc.caret.start.span,t=e.parent;return!e.hasModifier("code")&&t instanceof r}})},function(e,t,n){var i=n(19).TypingExtension,o=n(16).Selection,r=n(5).ELLIPSIS;t.Ellipses=i.extend({install:function(){this.doc.on("keypress",this.onKeypress.bind(this))},onKeypress:function(e){if("."==e&&this.isActive()){var t=this.doc.caret.start.prevPositionInSection(2);if(t){var n=new o(t,this.doc.caret.start);if(this.isActive(n)&&".."==n.getText())return n.start.span.parent.deleteText(n.start,n.end),n.start.span.insertText(r,n.start.offset),this.doc.moveCaret(n.start.nextPositionInSection()),this.doc.updateSpellingSuggestions(),this.doc.caret.updateAndroidCaretPosition(),this.doc.saveState(),!1}}}})},function(e,t,n){var i=n(9).Extension,o=n(3).PlainSection,r=n(17).HorizontalRuleSection,a=n(5);t.HR=i.extend({install:function(){this.doc.on("command-return",this.onReturn.bind(this))},onReturn:function(){if(this.isActive()){var e=new RegExp("^([-*+_=]{3,}|["+a.EM_DASH+"-]{2,})$"),t=this.doc.caret.start.clone().span.parent.previousSibling();t&&t instanceof o&&e.test(t.getText().trim())&&!t.isQuoted()&&(this.doc.insertBefore(new r,t),this.doc.removeChild(t))}},isActive:function(){return!this.doc.isDisabledCommand("horizontal-rule")}})},function(e,t,n){var i=n(9).Extension;t.UndoState=i.extend({install:function(){this.doc.on("keypress",this.onKeypress.bind(this))},onKeypress:function(e){"."!=e&&","!=e||this.doc.saveState()}})},function(e,t,n){var i=n(9).Extension;t.Mention=i.extend({install:function(){this.doc.on("keypress",this.onKeypress.bind(this))},onKeypress:function(e){"@"==e&&this.doc.handleCommand("mention",e,{source:"keyboard"})}})},function(e,t,n){var i=n(9).Extension,o=n(6).Section,r=n(0).config,a=n(1).Util,s=n(21),l=n(3).PlainSection,c=n(15).EmbedSection,d=n(14).ImageSection;t.NonEditableCursors=i.extend({install:function(){if(this.doc.on("mousedown",this.onMousedown.bind(this)),this.doc.on("longpress",this.onLongpress.bind(this)),r.clientInfo.isNativeApp){var e=this;this.doc.on("touchstart",(function(t){e._maybeRemoveSectionOnClick(t)||e._maybeRetryImageUpload(t)}))}},onLongpress:function(e){var t=this._sectionFromNode(e.target);t&&(t.isEditable()||(this.doc.moveCaret(t.first(),t.last()),this.doc.updateCaret()))},onMousedown:function(e){var t=this._sectionFromNode(e.target);if(!t){var n=this.doc.lastChild();if(n instanceof d||n instanceof c){var i=new l;return this.doc.insertAfter(i,n),this.doc.moveCaret(i.first()),this.doc.updateCaret(),void e.preventDefault()}}if(t&&!t.isEditable()){if(r.clientInfo.isNativeApp||!this._maybeRemoveSectionOnClick(e)){r.clientInfo.isNativeApp||this._maybeRetryImageUpload(e),t instanceof c&&this._isClickingReactPlaceholder(e)&&t.acceptClipboardSuggestion&&t.acceptClipboardSuggestion();var o=e.target.getBoundingClientRect().left+document.body.scrollLeft,a=e.pageX-o;e.target.width/2>a?this.doc.moveCaret(t.first()):this.doc.moveCaret(t.last()),this.doc.updateCaret(),this._isClickingReactPlaceholder(e)||this.doc.node.focus(),this.doc.caret.scrollIntoViewIfNeeded()}}else if(r.clientInfo.isIOSApp&&!this.doc.contains(document.activeElement)){var u=s.rangeFromPoint(e.clientX,e.clientY),h=this.doc.caret._fromNode(u.startContainer,u.startOffset);e.preventDefault();var f=this;f.doc.openIOSKeyboardAndFocus((function(){f.doc.moveCaret(h),f.doc.updateCaret(),f.doc.node.focus(),f.doc.caret.scrollIntoViewIfNeeded()}))}},_isClickingReactPlaceholder:function(e){return!!r.options.lightWeightContentToolbar&&function t(e){return!!e.classList.contains("react_placeholder")||!e.classList.contains("content")&&!e.classList.contains("doc")&&e.parentElement&&t(e.parentElement)}(e.target)},_isClickingReactRetryButton:function(e){return function t(e){return!!e.classList.contains("react_retry_button_container")||!e.classList.contains("content")&&!e.classList.contains("doc")&&e.parentElement&&t(e.parentElement)}(e.target)},_maybeRemoveSectionOnClick:function(e){if("section_remove_btn"===e.target.className){var t=this._sectionFromNode(e.target);return a.removeSectionFromDoc(this.doc,t)}},_maybeRetryImageUpload:function(e){this._sectionFromNode(e.target)instanceof d&&this._isClickingReactRetryButton(e)&&this.doc.retryUpload()},_sectionFromNode:function(e){for(var t=e;t;){if(o.is(t))return o.get(t);t=t.parentElement}return null}})},function(e,t,n){var i=n(19).TypingExtension,o=n(4).Position,r=n(16).Selection,a=n(0).config,s=n(5);t.SmartQuotes=i.extend({install:function(){!a.clientInfo.isIOS&&a.options.enableSmartQuotes&&(this.initializeConstants(),this.doc.on("keypress",this.onKeypress.bind(this)),this.doc.on("command-space",this.onSpace.bind(this)))},onSpace:function(){if(this.isActive()){var e=this.doc.caret.start.previousWordBoundary(/\s/),t=e.charAfter(),n=this.doc.caret.start;if(null!==t&&e.atSpanEnd()&&(e=e.span.nextSibling().first()),t===s.OPEN_SINGLE_QUOTE){var i=this.doc.caret.previousTextUntil(e).slice(1);if(this.frontApostropheRegex.test(i)){var o=e.span.getText();e.span.setText(o.slice(0,e.offset)+s.CLOSE_SINGLE_QUOTE+o.slice(e.offset+1)),this.doc.moveCaret(n)}}}},onKeypress:function(e){if(this.isActive()){if("'"==e)return this.handleSingleQuote(),!1;if('"'==e)return this.handleDoubleQuote(),!1;if("S"==e.toUpperCase()&&this.doc.caret.start.charBefore()==s.SINGLE_PRIME){var t=this.doc.caret.start.prevPositionInSection();return this.doc.caret.start.span.parent.deleteText(t,this.doc.caret.start),t.span.insertText(s.CLOSE_SINGLE_QUOTE,t.offset),this.doc.moveCaret(t.nextPositionInSection()),void this.doc.updateSpellingSuggestions()}}},handleSingleQuote:function(){var e=this.doc.caret.charBefore(),t=s.CLOSE_SINGLE_QUOTE,n=this.doc.caret,i=n.start.span.parent,o=new r(i.first(),n.start);null===e||s.WORD_START_REGEX.test(e)?t=s.OPEN_SINGLE_QUOTE:this.primeRegex.test(e)&&(this.unclosedSingleQuoteRegex.test(o.getText())||(t=s.SINGLE_PRIME)),this.insertChar(t)},handleDoubleQuote:function(){var e=this.doc.caret.charBefore(),t=s.CLOSE_DOUBLE_QUOTE,n=this.doc.caret,i=n.start.span.parent,o=new r(i.first(),n.start);null===e||/\s|[({[]/.test(e)?t=s.OPEN_DOUBLE_QUOTE:this.primeRegex.test(e)&&(this.unclosedDoubleQuoteRegex.test(o.getText())||(t=s.DOUBLE_PRIME)),this.insertChar(t)},insertChar:function(e){var t=this.doc.caret.start,n=t.span,i=n.getText(),r=t.offset;n.setText(i.slice(0,r)+e+i.slice(r)),this.doc.moveCaret(new o(n,r+1))},initializeConstants:function(){var e=Object.keys(s.FRACTIONS).join("");this.primeRegex=new RegExp("\\d|["+e+"]");for(var t=["bout","cause","course","d","e_ll","em","er","ere","e_s","fraid","fro","kay","lo","m","n","n_","pon","round","sblood","scuse","sfar","sfoot","sup","t","taint","tain_t","til","tis","tisn_t","tshall","twas","twasn_t","tween","twere","tweren_t","twill","twixt","twon_t","twou_d","twou_dn_t","twould","twouldn_t","um","ve"],n="",i=0;i<t.length;++i)n+="|"+t[i].replace(/_/g,"['\u2018\u2019\u2032]");this.frontApostropheRegex=new RegExp("^(\\d\\ds?"+n+")$","i"),this.unclosedSingleQuoteRegex=new RegExp(s.OPEN_SINGLE_QUOTE+"[^"+s.CLOSE_SINGLE_QUOTE+"]*$"),this.unclosedDoubleQuoteRegex=new RegExp(s.OPEN_DOUBLE_QUOTE+"[^"+s.CLOSE_DOUBLE_QUOTE+"]*$")}})},function(e,t,n){var i=n(19).TypingExtension,o=n(16).Selection,r=n(29).Quirks;t.DoubleSpace=i.extend({install:function(){this.doc.on("command-space",this.onSpace.bind(this)),this.MAX_SPACES=2,this.spacesExp=new RegExp("\\s{"+this.MAX_SPACES+"}")},onSpace:function(){if(this.isActive()){var e=this.doc.caret,t=e.start.prevPositionInSection(this.MAX_SPACES)||e.start.span.parent.first(),n=new o(t,e.start),i=e.start.nextPositionInSection(this.MAX_SPACES)||e.start.span.parent.last(),a=new o(e.start,i),s=e.start.nextPositionInSection(),l=n.getText(),c=a.getText(),d=e.charAfter();return/\s/.test(d)&&"\n"!=d&&s&&!s.span.hasModifier("citation")&&this.spacesExp.test(l+c)&&!r.insertsPeriodWithDoubleSpace()?(this.doc.moveCaret(s),this.doc.caret.updateAndroidCaretPosition(),!1):this.spacesExp.test(l)?(this.doc.caret.updateAndroidCaretPosition(),!1):void 0}}})},function(e,t,n){var i=n(19).TypingExtension,o=n(16).Selection,r=n(0).config,a=n(5);t.Dashes=i.extend({install:function(){this.doc.on("keypress",this.onKeypress.bind(this))},onKeypress:function(e){var t=this.doc.caret.start,n=t.span,i=n.parent;if(t.atSpanStart()){if(!(n=n.previousSibling()))return;t=n.last()}var s=t.prevPositionInSection();if(s){var l=Object.keys(a.FRACTIONS).join(""),c=new RegExp("(\\d|["+l+"])[-"+a.EM_DASH+"]");if(/\d/.test(e)){var d=s.prevPositionInSection();if(!d)return;var u=new o(d,this.doc.caret.start);if(!this.isActive(u))return;c.test(u.getText())&&(i.replaceText(s,this.doc.caret.start,a.EN_DASH),this.doc.moveCaret(s.nextPositionInSection()))}else if("-"==e){if(!this.isActive(new o(s,this.doc.caret.start)))return;return"-"==this.doc.caret.charBefore()?(i.replaceText(s,this.doc.caret.start,a.EM_DASH),this.doc.moveCaret(s.nextPositionInSection()),this.doc.caret.updateAndroidCaretPosition(),!1):r.clientInfo.isIOS&&this.doc.caret.charBefore()==a.EM_DASH?(i.replaceText(t,t,"-"),this.doc.moveCaret(t.nextPositionInSection()),!1):void 0}}}})},function(e,t,n){var i=n(19).TypingExtension,o=n(16).Selection,r=n(5);t.Arrows=i.extend({install:function(){this.doc.on("keypress",this.onKeypress.bind(this))},onKeypress:function(e){if(this.isActive()){var t,n=this.doc.caret.start.span.parent,i=this.doc.caret.start.prevPositionInSection();if(i){if(">"==e){if(t=new o(i,this.doc.caret.start),!this.isActive(t))return;return t.getText()==r.EM_DASH?(n.replaceText(i,this.doc.caret.start,r.RIGHT_ARROW),this.doc.moveCaret(i.nextPositionInSection()),this.doc.caret.updateAndroidCaretPosition(),!1):void 0}if("-"==e){var a=i.prevPositionInSection();if(!a)return;if(t=new o(a,this.doc.caret.start),!this.isActive(t))return;var s=t.getText();if(s=="<"+r.EM_DASH||"<-"==s)return n.replaceText(t.start,t.end,r.LEFT_ARROW),this.doc.moveCaret(a.nextPositionInSection()),this.doc.caret.updateAndroidCaretPosition(),!1}}}}})},function(e,t,n){var i=n(9).Extension,o=n(14).ImageSection,r=n(0).config;t.ExternalImageUpload=i.extend({install:function(){this.doc.on("meaningfulChange",this.uploadExternalImages.bind(this))},uploadExternalImages:function(){var e=[],t=this,n=!1;t.doc.children.forEach((function(i){if(i instanceof o){var r=i.firstChild();if(r.hasModifier("external_source")&&!r.hasModifier("uploading")){r.setModifier("uploading",!0);var a=r.getModifier("image"),s=r.getModifier("external_source");i.isPending?(e.push(a),"html_paste"===s&&(n=!0)):t.doc.insertAndUploadImageUrl(a,s,i)}}})),r.options.eagerImageUploading&&e.length>0&&t.doc.uploadPendingImages(e,n)}})}])},"object"===typeof t&&"object"===typeof e?e.exports=i():"function"===typeof define&&define.amd?define([],i):"object"===typeof t?t.qtext2=i():n.qtext2=i()},"ut/Y":function(e,t,n){var i=n("ZCpW"),o=n("GDhZ"),r=n("zZ0H"),a=n("Z0cm"),s=n("+c4W");e.exports=function(e){return"function"==typeof e?e:null==e?r:"object"==typeof e?a(e)?o(e[0],e[1]):i(e):s(e)}},yY6q:function(e,t,n){"use strict";n.r(t),n.d(t,"ModalContainerContext",(function(){return K})),n.d(t,"default",(function(){return J}));var i=n("o0o1"),o=n.n(i),r=n("yXPU"),a=n.n(r),s=n("lwsE"),l=n.n(s),c=n("W8MJ"),d=n.n(c),u=n("7W2i"),h=n.n(u),f=n("a1gu"),p=n.n(f),m=n("Nsbk"),g=n.n(m),v=n("RA+f"),b=n("SKAY"),y=n("nwxp"),x=n("R1F8"),S=n("q1tI"),E=n.n(S),C=n("zaBG"),_=n("gVEo"),T=n("PJYZ"),k=n.n(T),w=n("vOnD"),O=n("KP5v"),I=n("Ftba"),M=n("PyJm"),R=n("7r18");function N(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=g()(e);if(t){var o=g()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return p()(this,n)}}var L="\n  .modal_content_inner > div {\n    display: flex;\n    flex-direction: column;\n    flex: 1;\n    overflow: hidden;\n    height: 100%;\n  }\n",P=Object(w["default"])(v.g).withConfig({displayName:"ModalContainerInternal___StyledCssComponent",componentId:"s8es4q-0"})(["",""],L),D=Object(w["default"])(v.a).withConfig({displayName:"ModalContainerInternal___StyledAbsolute",componentId:"s8es4q-1"})(["",""],(function(e){return e._css})),A=Object(w["default"])(v.j).withConfig({displayName:"ModalContainerInternal___StyledFlex",componentId:"s8es4q-2"})(["",""],(function(e){return e._css2})),j=Object(w["default"])(v.g).withConfig({displayName:"ModalContainerInternal___StyledCssComponent2",componentId:"s8es4q-3"})(["",""],L),B=function(e){h()(n,e);var t=N(n);function n(e){var i;return l()(this,n),(i=t.call(this,e)).handleKeydown=i.handleKeydown.bind(k()(i)),i.state={titleId:null,subtitleId:null},i}return d()(n,[{key:"handleKeydown",value:function(e){"Escape"===e.key&&this.props.dismissModalFlow()}},{key:"componentDidMount",value:function(){this.props.easyDismissEnabled&&Object(y.b)()&&window.addEventListener("keydown",this.handleKeydown)}},{key:"componentWillUnmount",value:function(){this.props.easyDismissEnabled&&Object(y.b)()&&window.removeEventListener("keydown",this.handleKeydown)}},{key:"render",value:function(){var e=this;Object(C.b)(["render","ModalContainerInternal"],"ModalContainerInternal.render");var t=this.props,n=t.easyDismissEnabled,i=void 0===n||n,o=t.mobileHeight,r=void 0===o?"100%":o,a=t.desktopOverlayStyle,s=t.desktopHeight,l=t.desktopWidth,c=t.desktopMinHeight,d=void 0===c?M.c:c,u=t.desktopSize,h=void 0===u?"default":u,f=t.legacy,p=void 0!==f&&f,m=t.dismissModalFlow,g=t.isEntryModal,b=t.isInRootModalFlow,x=t.children,S=!1;Object(y.b)()&&(S=Boolean(Object(O.a)("answer_inline_composer_to_modal")));return Object(y.b)()?E.a.createElement(R.g.Provider,{value:p},E.a.createElement(v.c,{"in":!0,appear:g},(function(t){return E.a.createElement(P,null,E.a.createElement(v.s,{display:"flex",fontSize:"regular",lineHeight:"regular",position:"fixed",overflowX:"auto",top:0,left:0,width:"100%",height:"100%",zIndex:"modal_desktop",alignItems:"center"},E.a.createElement(v.i,{full:!0,display:"flex",justifyContent:"center",alignItems:"flex-start"},E.a.createElement(D,{id:"modal-click-away",full:!0,bg:a?null:"black_transparent_dark",transition:b&&Object(I.g)()&&"opacity",onClick:function(){i&&m()},style:a,_css:b&&Object(I.g)()?"\n                        opacity: ".concat("entered"===t.state?1:0,";\n                      "):undefined}),E.a.createElement(A,{className:"modal_content_inner",position:"relative",flexDirection:"column",bg:"white",overflowY:"auto",minHeight:d,maxHeight:M.d,maxWidth:M.b,height:s,width:l||("narrow"===h?M.f:S?730:M.e),borderRadius:M.a,borderAll:!0,alignSelf:"center",transition:Object(I.g)()&&"opacity, transform",role:"dialog","aria-modal":!0,"aria-labelledby":e.state.titleId||undefined,"aria-describedby":e.state.subtitleId||undefined,_css2:Object(I.g)()?"\n                        opacity: ".concat("entered"===t.state?1:0,";\n                        transform: scale(\n                          ").concat("entered"===t.state?1:.95,"\n                        );\n                      "):undefined},E.a.createElement(R.a.Provider,{value:!0},E.a.createElement(R.c.Provider,{value:{setTitleId:function(t){!function(t){e.setState({titleId:t})}(t)},setSubtitleId:function(t){!function(t){e.setState({subtitleId:t})}(t)}}},x))))))}))):E.a.createElement(R.g.Provider,{value:p},E.a.createElement(j,null,E.a.createElement(C.a.Consumer,null,(function(e){var t=e.index;return E.a.createElement(v.i,{top:0,left:0,right:0,zIndex:398+t},E.a.createElement(v.i,{full:!0,display:"flex",flexDirection:"column",justifyContent:"flex-end",alignItems:"stretch"},Object(y.f)()&&E.a.createElement(v.a,{full:!0,bg:"black_transparent_dark",onClick:function(){i&&m()}}),E.a.createElement(v.j,{className:"modal_content_inner",flexDirection:"column",bg:"white",overflow:"hidden",position:"absolute",bottom:0,height:Object(y.f)()?r:"100%",borderTopLeftRadius:p?0:M.a,borderTopRightRadius:p?0:M.a,width:"100%"},E.a.createElement(R.a.Provider,{value:!0},x))))}))))}}]),n}(E.a.Component);B.displayName="ModalContainerInternal";var F=n("D5Zh"),U=n("8lmh"),q=n("AaDK"),H=n("yju1");function Q(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=g()(e);if(t){var o=g()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return p()(this,n)}}var z=function(e){var t=e.modalName,n=e.openTime,i=e.children;return Object(S.useEffect)((function(){Object(q.a)("modal_flow_perf",{modal_name:t,open_time:n,interactive_time:Object(x.n)()})}),[t,n]),i},V=function(e){h()(n,e);var t=Q(n);function n(e){var i;return l()(this,n),(i=t.call(this,e)).showingNativeLoadingIndicator=void 0,i.showingNativeLoadingIndicator=!1,i}return d()(n,[{key:"renderModalClass",value:function(e){var t=this.props,n=t.ModalCls,i=t.extraProps,o=t.flowData,r=t.prefetchModal,a=t.dismissModalFlow,s=t.triggerTransition,l=t.goBack;return E.a.createElement(n,{extraProps:i,flowData:o,prefetchModal:r,dismissModalFlow:a,dismissModal:a,triggerTransition:s,goBack:l,queryResult:e})}},{key:"render",value:function(){var e,t=this;Object(C.b)(["render","ModalInternal"],"ModalInternal.render");var n=this.props,i=n.name,o=n.ModalCls,r=n.queryVariables,a=n.fetchPolicy,s=void 0===a?"store-or-network":a,l=n.dismissModalFlow,c=n.modalOpenTime;return null!==(e=o.queries)&&void 0!==e&&e.onLoad?E.a.createElement(F.a,{query:o.queries.onLoad,variables:r,fetchPolicy:s,errorChildren:function(e,t){return Object(R.k)(l,t)}},(function(e){var n=e.data,o=e.loading,r=e.error,a=e.refetch;return o&&Object(y.c)()?(t.showingNativeLoadingIndicator||(Object(H.a)("showLoadingView"),t.showingNativeLoadingIndicator=!0),null):o?E.a.createElement(R.h,null):(t.showingNativeLoadingIndicator&&(Object(H.a)("hideLoadingView"),t.showingNativeLoadingIndicator=!1),r?Object(U.isConnectionError)(r)?Object(R.e)(l,a):Object(R.k)(l,a):E.a.createElement(z,{modalName:i,openTime:c},t.renderModalClass(n)))})):E.a.createElement(z,{modalName:i,openTime:c},this.renderModalClass())}}]),n}(E.a.Component);function W(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=g()(e);if(t){var o=g()(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return p()(this,n)}}V.displayName="ModalInternal";var K=E.a.createContext(undefined);K.displayName="ModalContainerContext";var J=function(e){h()(n,e);var t=W(n);function n(e){var i;return l()(this,n),(i=t.call(this,e)).flowData=void 0,i.componentDidMount=function(){Object(y.a)()&&i.registerAndroidBackButtonCallback()},i.registerAndroidBackButtonCallback=function(){var e=i.props.dismissableBack;Object(b.registerMessageHandler)("closeNavigationButtonPressed",(function(){(e||i.state.modals.length>1)&&i.showPreviousModal()}))},i.prefetchModal=function(e){var t=e.name,n=e.queryVariables;Object(C.c)({modalName:t,queryVariables:n})},i.showNextModal=function(){var e=a()(o.a.mark((function t(e){var n,r,a,s,l,c;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.modalProps,r=e.replaceActiveModal,a=void 0!==r&&r,s=Object(x.n)(),Object(C.b)(["callback","ModalFlowInternal"],"ModalFlowInternal.showNextModal"),t.next=5,Object(_.a)();case 5:return l=t.sent,t.next=8,l[n.name].loader();case 8:c=t.sent["default"],i.setState((function(e){var t=e.modals,o=t[t.length-1].key+1;return a&&t.pop(),t.push({modalProps:n,element:E.a.createElement(V,Object.assign({},n,{ModalCls:c,prefetchModal:i.prefetchModal,dismissModalFlow:i.props.dismissModalFlow,goBack:i.showPreviousModal,triggerTransition:i.transition,flowData:i.flowData,modalOpenTime:s})),key:o}),{modals:t}}));case 10:case"end":return t.stop()}}),t)})));return function(t){return e.apply(this,arguments)}}(),i.showPreviousModal=function(){Object(C.b)(["callback","ModalFlowInternal"],"ModalFlowInternal.showPreviousModal"),1===i.state.modals.length?i.props.dismissModalFlow():i.setState((function(e){var t=e.modals;return t.pop(),{modals:t}}))},i.transition=a()(o.a.mark((function r(){var e;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Object(C.b)(["callback","ModalFlowInternal"],"ModalFlowInternal.transition"),t.next=3,Object(_.b)();case 3:return e=t.sent,t.next=6,e[i.props.transitionName]();case 6:t.t0=t.sent,(0,t.t0)({activeModalProps:i.state.modals[i.state.modals.length-1].modalProps,flowData:i.flowData,prefetchModal:i.prefetchModal,showNextModal:i.showNextModal,showPreviousModal:i.showPreviousModal,dismissModalFlow:i.props.dismissModalFlow});case 8:case"end":return t.stop()}}),r)}))),Object(C.b)(["constructor","ModalFlowInternal"],"ModalFlowInternal.constructor"),i.flowData=Object.assign({},i.props.initialFlowData),i.state={modals:[{modalProps:e.initialModalProps,element:E.a.createElement(V,Object.assign({},e.initialModalProps,{ModalCls:e.InitialModalCls,prefetchModal:i.prefetchModal,dismissModalFlow:i.props.dismissModalFlow,goBack:i.showPreviousModal,triggerTransition:i.transition,flowData:i.flowData,modalOpenTime:e.modalOpenTime})),key:0}]},i}return d()(n,[{key:"render",value:function(){Object(C.b)(["render","ModalFlowInternal"],"ModalFlowInternal.render: props=".concat(this.props));var e=this.props,t=e.containerProps,n=void 0===t?{}:t,i=e.dismissModalFlow,o=e.isRootModalFlow,r=this.state.modals;return E.a.createElement(E.a.Fragment,null,r.map((function(e,t,r){var a=e.modalProps,s=e.element,l=e.key;return E.a.createElement(v.e,{key:l,display:t===r.length-1?"initial":"none"},E.a.createElement(K.Provider,{value:{isTopModal:t===r.length-1}},E.a.createElement(B,Object.assign({},n,{isEntryModal:0===t,isInRootModalFlow:o,desktopOverlayStyle:a.desktopOverlayStyle,desktopHeight:a.desktopHeight,desktopWidth:a.desktopWidth,dismissModalFlow:i}),s)))})))}}]),n}(E.a.Component);J.displayName="ModalFlowInternal"}}]);