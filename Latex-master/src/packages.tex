\usepackage{graphicx}
\usepackage{subfig}
\usepackage{wrapfig}

\usepackage{sidecap}
\usepackage{tikz}
\usetikzlibrary{calc}
\usepackage{environ}
\usepackage{tikz-3dplot}
\usepackage{import}
\usepackage{calc}
\usepackage{pgfmath}
\usepackage{ifthen}
\usepackage{pgfplots}
\usepgfplotslibrary{fillbetween}
\usepackage{amsmath}

\usepackage{xr}

\NewEnviron{scaletikzpicturetowidth}[1]{%
  \def\tikz@width{#1}%
  \def\tikzscale{1}\begin{lrbox}{\measure@tikzpicture}%
  \BODY
  \end{lrbox}%
  \pgfmathparse{#1/\wd\measure@tikzpicture}%
  \edef\tikzscale{\pgfmathresult}%
  \BODY
}